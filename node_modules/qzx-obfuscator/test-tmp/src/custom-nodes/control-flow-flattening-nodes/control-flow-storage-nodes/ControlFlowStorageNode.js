"use strict";

var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; })();

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var inversify_1 = require("inversify");
var ServiceIdentifiers_1 = require("../../../container/ServiceIdentifiers");
var Initializable_1 = require("../../../decorators/Initializable");
var AbstractCustomNode_1 = require("../../AbstractCustomNode");
var Nodes_1 = require("../../../node/Nodes");
var NodeUtils_1 = require("../../../node/NodeUtils");
var ControlFlowStorageNode = function (_AbstractCustomNode_) {
    _inherits(ControlFlowStorageNode, _AbstractCustomNode_);

    function ControlFlowStorageNode(randomGenerator, options) {
        _classCallCheck(this, ControlFlowStorageNode);

        var _this = _possibleConstructorReturn(this, (ControlFlowStorageNode.__proto__ || Object.getPrototypeOf(ControlFlowStorageNode)).call(this, options));

        _this.randomGenerator = randomGenerator;
        return _this;
    }

    _createClass(ControlFlowStorageNode, [{
        key: "initialize",
        value: function initialize(controlFlowStorage) {
            this.controlFlowStorage = controlFlowStorage;
        }
    }, {
        key: "getNodeStructure",
        value: function getNodeStructure() {
            var structure = Nodes_1.Nodes.getVariableDeclarationNode([Nodes_1.Nodes.getVariableDeclaratorNode(Nodes_1.Nodes.getIdentifierNode(this.controlFlowStorage.getStorageId()), Nodes_1.Nodes.getObjectExpressionNode(Array.from(this.controlFlowStorage.getStorage()).map(function (_ref) {
                var _ref2 = _slicedToArray(_ref, 2),
                    key = _ref2[0],
                    value = _ref2[1];

                return Nodes_1.Nodes.getPropertyNode(Nodes_1.Nodes.getIdentifierNode(key), value.getNode()[0]);
            })))]);
            structure = NodeUtils_1.NodeUtils.parentize(structure);
            return [structure];
        }
    }]);

    return ControlFlowStorageNode;
}(AbstractCustomNode_1.AbstractCustomNode);
tslib_1.__decorate([Initializable_1.initializable(), tslib_1.__metadata("design:type", Object)], ControlFlowStorageNode.prototype, "controlFlowStorage", void 0);
ControlFlowStorageNode = tslib_1.__decorate([inversify_1.injectable(), tslib_1.__param(0, inversify_1.inject(ServiceIdentifiers_1.ServiceIdentifiers.IRandomGenerator)), tslib_1.__param(1, inversify_1.inject(ServiceIdentifiers_1.ServiceIdentifiers.IOptions)), tslib_1.__metadata("design:paramtypes", [Object, Object])], ControlFlowStorageNode);
exports.ControlFlowStorageNode = ControlFlowStorageNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udHJvbEZsb3dTdG9yYWdlTm9kZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9jdXN0b20tbm9kZXMvY29udHJvbC1mbG93LWZsYXR0ZW5pbmctbm9kZXMvY29udHJvbC1mbG93LXN0b3JhZ2Utbm9kZXMvQ29udHJvbEZsb3dTdG9yYWdlTm9kZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLDBCQUErQztBQUMvQyxtQ0FBMkU7QUFXM0UsOEJBQWtFO0FBRWxFLG1DQUE4RDtBQUM5RCxzQkFBNEM7QUFDNUMsMEJBQW9EO0FBR3BEO0FBQUEsQUFBYSxBQUFzQixBQUFDOztBQWdCaEMsb0NBQ2lELEFBQWlDLGlCQUN6QyxBQUFpQjtBQUV0RCxBQUFLOztvSkFBQyxBQUFPLEFBQUMsQUFBQzs7QUFFZixBQUFJLGNBQUMsQUFBZSxrQkFBRyxBQUFlLEFBQUMsQUFDM0M7O0FBQUMsQUFLTSxBQUFVOzs7O21DQUFFLEFBQTBDO0FBQ3pELEFBQUksaUJBQUMsQUFBa0IscUJBQUcsQUFBa0IsQUFBQyxBQUNqRDtBQUFDLEFBS1MsQUFBZ0I7Ozs7QUFDdEIsZ0JBQUksQUFBUyxvQkFBcUIsTUFBQyxBQUEwQixvQ0FDcEQsTUFBQyxBQUF5QiwwQkFDM0IsUUFBSyxNQUFDLEFBQWlCLGtCQUFDLEFBQUksS0FBQyxBQUFrQixtQkFBQyxBQUFZLEFBQUUsQUFBQyx5QkFDMUQsTUFBQyxBQUF1Qiw4QkFFcEIsQUFBSSxLQUFDLEFBQUksS0FBQyxBQUFrQixtQkFBQyxBQUFVLEFBQUUsQUFBQyxjQUMxQyxBQUFHLElBQUMsQUFBQzs7b0JBQUMsQUFBRztvQkFBRSxBQUFLLEFBQXdCOztBQUNyQyxBQUFNLHVCQUFDLFFBQUssTUFBQyxBQUFlLGdCQUN4QixRQUFLLE1BQUMsQUFBaUIsa0JBQUMsQUFBRyxBQUFDLE1BQ3ZCLEFBQUssTUFBQyxBQUFPLEFBQUUsVUFBQyxBQUFDLEFBQUMsQUFDMUIsQUFBQyxBQUNOO0FBQUMsQUFBQyxBQUNULEFBQ0osQUFDSixBQUFDLEFBQUMsYUFWUyxBQUFLLENBRFQsQ0FGSixDQUQwRCxDQUFqQztBQWdCN0IsQUFBUyx3QkFBRyxZQUFTLFVBQUMsQUFBUyxVQUFDLEFBQVMsQUFBQyxBQUFDO0FBRTNDLEFBQU0sbUJBQUMsQ0FBQyxBQUFTLEFBQUMsQUFBQyxBQUN2QjtBQUFDLEFBQ0o7Ozs7RUF4RDJDLHFCQUFrQjtBQUsxRCxvQkFEQyxnQkFBYSxBQUFFLDBIQUNtQztBQUwxQyxBQUFzQiw2Q0FEbEMsWUFBVSxBQUFFLGNBa0JKLG1CQUFBLFlBQU0sT0FBQyxxQkFBa0IsbUJBQUMsQUFBZ0IsQUFBQyxvQkFDM0MsbUJBQUEsWUFBTSxPQUFDLHFCQUFrQixtQkFBQyxBQUFRLEFBQUMsd0VBbEIvQixBQUFzQixBQXdEbEM7QUF4RFksaUNBQXNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5qZWN0YWJsZSwgaW5qZWN0IH0gZnJvbSAnaW52ZXJzaWZ5JztcbmltcG9ydCB7IFNlcnZpY2VJZGVudGlmaWVycyB9IGZyb20gJy4uLy4uLy4uL2NvbnRhaW5lci9TZXJ2aWNlSWRlbnRpZmllcnMnO1xuXG5pbXBvcnQgKiBhcyBFU1RyZWUgZnJvbSAnZXN0cmVlJztcblxuaW1wb3J0IHsgVFN0YXRlbWVudCB9IGZyb20gJy4uLy4uLy4uL3R5cGVzL25vZGUvVFN0YXRlbWVudCc7XG5cbmltcG9ydCB7IElDdXN0b21Ob2RlIH0gZnJvbSAnLi4vLi4vLi4vaW50ZXJmYWNlcy9jdXN0b20tbm9kZXMvSUN1c3RvbU5vZGUnO1xuaW1wb3J0IHsgSU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9pbnRlcmZhY2VzL29wdGlvbnMvSU9wdGlvbnMnO1xuaW1wb3J0IHsgSVJhbmRvbUdlbmVyYXRvciB9IGZyb20gJy4uLy4uLy4uL2ludGVyZmFjZXMvdXRpbHMvSVJhbmRvbUdlbmVyYXRvcic7XG5pbXBvcnQgeyBJU3RvcmFnZSB9IGZyb20gJy4uLy4uLy4uL2ludGVyZmFjZXMvc3RvcmFnZXMvSVN0b3JhZ2UnO1xuXG5pbXBvcnQgeyBpbml0aWFsaXphYmxlIH0gZnJvbSAnLi4vLi4vLi4vZGVjb3JhdG9ycy9Jbml0aWFsaXphYmxlJztcblxuaW1wb3J0IHsgQWJzdHJhY3RDdXN0b21Ob2RlIH0gZnJvbSAnLi4vLi4vQWJzdHJhY3RDdXN0b21Ob2RlJztcbmltcG9ydCB7IE5vZGVzIH0gZnJvbSAnLi4vLi4vLi4vbm9kZS9Ob2Rlcyc7XG5pbXBvcnQgeyBOb2RlVXRpbHMgfSBmcm9tICcuLi8uLi8uLi9ub2RlL05vZGVVdGlscyc7XG5cbkBpbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBDb250cm9sRmxvd1N0b3JhZ2VOb2RlIGV4dGVuZHMgQWJzdHJhY3RDdXN0b21Ob2RlIHtcbiAgICAvKipcbiAgICAgKiBAdHlwZSB7SVN0b3JhZ2UgPElDdXN0b21Ob2RlPn1cbiAgICAgKi9cbiAgICBAaW5pdGlhbGl6YWJsZSgpXG4gICAgcHJpdmF0ZSBjb250cm9sRmxvd1N0b3JhZ2U6IElTdG9yYWdlIDxJQ3VzdG9tTm9kZT47XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7SVJhbmRvbUdlbmVyYXRvcn1cbiAgICAgKi9cbiAgICBwcml2YXRlIHJlYWRvbmx5IHJhbmRvbUdlbmVyYXRvcjogSVJhbmRvbUdlbmVyYXRvcjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7SVJhbmRvbUdlbmVyYXRvcn0gcmFuZG9tR2VuZXJhdG9yXG4gICAgICogQHBhcmFtIHtJT3B0aW9uc30gb3B0aW9uc1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yIChcbiAgICAgICAgQGluamVjdChTZXJ2aWNlSWRlbnRpZmllcnMuSVJhbmRvbUdlbmVyYXRvcikgcmFuZG9tR2VuZXJhdG9yOiBJUmFuZG9tR2VuZXJhdG9yLFxuICAgICAgICBAaW5qZWN0KFNlcnZpY2VJZGVudGlmaWVycy5JT3B0aW9ucykgb3B0aW9uczogSU9wdGlvbnNcbiAgICApIHtcbiAgICAgICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICAgICAgdGhpcy5yYW5kb21HZW5lcmF0b3IgPSByYW5kb21HZW5lcmF0b3I7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtJU3RvcmFnZTxJQ3VzdG9tTm9kZT59IGNvbnRyb2xGbG93U3RvcmFnZVxuICAgICAqL1xuICAgIHB1YmxpYyBpbml0aWFsaXplIChjb250cm9sRmxvd1N0b3JhZ2U6IElTdG9yYWdlIDxJQ3VzdG9tTm9kZT4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jb250cm9sRmxvd1N0b3JhZ2UgPSBjb250cm9sRmxvd1N0b3JhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge1RTdGF0ZW1lbnRbXX1cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZ2V0Tm9kZVN0cnVjdHVyZSAoKTogVFN0YXRlbWVudFtdIHtcbiAgICAgICAgbGV0IHN0cnVjdHVyZTogRVNUcmVlLk5vZGUgPSBOb2Rlcy5nZXRWYXJpYWJsZURlY2xhcmF0aW9uTm9kZShbXG4gICAgICAgICAgICBOb2Rlcy5nZXRWYXJpYWJsZURlY2xhcmF0b3JOb2RlKFxuICAgICAgICAgICAgICAgIE5vZGVzLmdldElkZW50aWZpZXJOb2RlKHRoaXMuY29udHJvbEZsb3dTdG9yYWdlLmdldFN0b3JhZ2VJZCgpKSxcbiAgICAgICAgICAgICAgICBOb2Rlcy5nZXRPYmplY3RFeHByZXNzaW9uTm9kZShcbiAgICAgICAgICAgICAgICAgICAgQXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5mcm9tKHRoaXMuY29udHJvbEZsb3dTdG9yYWdlLmdldFN0b3JhZ2UoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKFtrZXksIHZhbHVlXTogW3N0cmluZywgSUN1c3RvbU5vZGVdKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vZGVzLmdldFByb3BlcnR5Tm9kZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTm9kZXMuZ2V0SWRlbnRpZmllck5vZGUoa2V5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGFueT52YWx1ZS5nZXROb2RlKClbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgIF0pO1xuXG4gICAgICAgIHN0cnVjdHVyZSA9IE5vZGVVdGlscy5wYXJlbnRpemUoc3RydWN0dXJlKTtcblxuICAgICAgICByZXR1cm4gW3N0cnVjdHVyZV07XG4gICAgfVxufVxuIl19