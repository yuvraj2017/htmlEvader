"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var inversify_1 = require("inversify");
var class_validator_1 = require("class-validator");
var Default_1 = require("./presets/Default");
var OptionsNormalizer_1 = require("./OptionsNormalizer");
var ValidationErrorsFormatter_1 = require("./ValidationErrorsFormatter");
var Options = Options_1 = function Options(inputOptions) {
    _classCallCheck(this, Options);

    Object.assign(this, Default_1.DEFAULT_PRESET, inputOptions);
    var errors = class_validator_1.validateSync(this, Options_1.validatorOptions);
    if (errors.length) {
        throw new ReferenceError("Validation failed. errors:\n" + ValidationErrorsFormatter_1.ValidationErrorsFormatter.format(errors));
    }
    Object.assign(this, OptionsNormalizer_1.OptionsNormalizer.normalizeOptions(this));
};
Options.validatorOptions = {
    validationError: {
        target: false
    }
};
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "compact", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "controlFlowFlattening", void 0);
tslib_1.__decorate([class_validator_1.IsNumber(), class_validator_1.Min(0), class_validator_1.Max(1), tslib_1.__metadata("design:type", Number)], Options.prototype, "controlFlowFlatteningThreshold", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "deadCodeInjection", void 0);
tslib_1.__decorate([class_validator_1.IsNumber(), tslib_1.__metadata("design:type", Number)], Options.prototype, "deadCodeInjectionThreshold", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "debugProtection", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "debugProtectionInterval", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "disableConsoleOutput", void 0);
tslib_1.__decorate([class_validator_1.IsArray(), class_validator_1.ArrayUnique(), class_validator_1.IsString({
    each: true
}), tslib_1.__metadata("design:type", Array)], Options.prototype, "domainLock", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "mangle", void 0);
tslib_1.__decorate([class_validator_1.IsArray(), class_validator_1.ArrayUnique(), class_validator_1.IsString({
    each: true
}), tslib_1.__metadata("design:type", Array)], Options.prototype, "reservedNames", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "rotateStringArray", void 0);
tslib_1.__decorate([class_validator_1.IsNumber(), tslib_1.__metadata("design:type", Number)], Options.prototype, "seed", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "selfDefending", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "sourceMap", void 0);
tslib_1.__decorate([class_validator_1.IsString(), class_validator_1.ValidateIf(function (options) {
    return Boolean(options.sourceMapBaseUrl);
}), class_validator_1.IsUrl({
    require_protocol: true,
    require_valid_protocol: true
}), tslib_1.__metadata("design:type", String)], Options.prototype, "sourceMapBaseUrl", void 0);
tslib_1.__decorate([class_validator_1.IsString(), tslib_1.__metadata("design:type", String)], Options.prototype, "sourceMapFileName", void 0);
tslib_1.__decorate([class_validator_1.IsIn(['inline', 'separate']), tslib_1.__metadata("design:type", String)], Options.prototype, "sourceMapMode", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "stringArray", void 0);
tslib_1.__decorate([class_validator_1.IsIn([true, false, 'base64', 'rc4']), tslib_1.__metadata("design:type", Object)], Options.prototype, "stringArrayEncoding", void 0);
tslib_1.__decorate([class_validator_1.IsNumber(), class_validator_1.Min(0), class_validator_1.Max(1), tslib_1.__metadata("design:type", Number)], Options.prototype, "stringArrayThreshold", void 0);
tslib_1.__decorate([class_validator_1.IsBoolean(), tslib_1.__metadata("design:type", Boolean)], Options.prototype, "unicodeEscapeSequence", void 0);
Options = Options_1 = tslib_1.__decorate([inversify_1.injectable(), tslib_1.__metadata("design:paramtypes", [Object])], Options);
exports.Options = Options;
var Options_1;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT3B0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9vcHRpb25zL09wdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsMEJBQXVDO0FBRXZDLGdDQWN5QjtBQVN6Qix3QkFBbUQ7QUFFbkQsa0NBQXdEO0FBQ3hELDBDQUF3RTtBQUd4RSxJQUFhLEFBQU8sVUFBcEIsWUFrS0ksaUJBQWEsQUFBMkI7OztBQUNwQyxBQUFNLFdBQUMsQUFBTSxPQUFDLEFBQUksTUFBRSxVQUFjLGdCQUFFLEFBQVksQUFBQyxBQUFDO0FBRWxELFFBQU0sQUFBTSxTQUFzQixrQkFBWSxhQUFDLEFBQUksTUFBRSxBQUFPLFVBQUMsQUFBZ0IsQUFBQyxBQUFDO0FBRS9FLEFBQUUsQUFBQyxRQUFDLEFBQU0sT0FBQyxBQUFNLEFBQUMsUUFBQyxBQUFDO0FBQ2hCLGNBQU0sSUFBSSxBQUFjLEFBQUMsZ0RBQStCLDRCQUF5QiwwQkFBQyxBQUFNLE9BQUMsQUFBTSxBQUFDLEFBQUUsQUFBQyxBQUFDLEFBQ3hHO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBTSxPQUFDLEFBQUksTUFBRSxvQkFBaUIsa0JBQUMsQUFBZ0IsaUJBQUMsQUFBSSxBQUFDLEFBQUMsQUFBQyxBQUNsRTtBQUFDLEFBQ0o7QUF6S2tCLFFBQWdCO0FBQzNCLEFBQWU7QUFDWCxBQUFNLGdCQUFFLEFBQUssQUFDaEIsQUFDSixBQUFDO0FBSG1CO0FBRCtCO0FBVXBELG9CQURDLGtCQUFTLEFBQUUsNkZBQ3FCO0FBTWpDLG9CQURDLGtCQUFTLEFBQUUsMkdBQ21DO0FBUS9DLG9CQUhDLGtCQUFRLEFBQUUsWUFDVixrQkFBRyxJQUFDLEFBQUMsQUFBQyxJQUNOLGtCQUFHLElBQUMsQUFBQyxBQUFDLDBHQUNnRDtBQU12RCxvQkFEQyxrQkFBUyxBQUFFLHVHQUMrQjtBQU0zQyxvQkFEQyxrQkFBUSxBQUFFLDhHQUN3QztBQU1uRCxvQkFEQyxrQkFBUyxBQUFFLHFHQUM2QjtBQU16QyxvQkFEQyxrQkFBUyxBQUFFLDZHQUNxQztBQU1qRCxvQkFEQyxrQkFBUyxBQUFFLDBHQUNrQztBQVU5QyxvQkFMQyxrQkFBTyxBQUFFLFdBQ1Qsa0JBQVcsQUFBRSxpQ0FDTDtBQUNMLEFBQUksVUFBRSxBQUFJLEFBQ2IsQUFBQztBQUZRLENBQVQsb0ZBR29DO0FBTXJDLG9CQURDLGtCQUFTLEFBQUUsNEZBQ29CO0FBVWhDLG9CQUxDLGtCQUFPLEFBQUUsV0FDVCxrQkFBVyxBQUFFLGlDQUNMO0FBQ0wsQUFBSSxVQUFFLEFBQUksQUFDYixBQUFDO0FBRlEsQ0FBVCx1RkFHdUM7QUFNeEMsb0JBREMsa0JBQVMsQUFBRSx1R0FDK0I7QUFNM0Msb0JBREMsa0JBQVEsQUFBRSx3RkFDa0I7QUFNN0Isb0JBREMsa0JBQVMsQUFBRSxtR0FDMkI7QUFNdkMsb0JBREMsa0JBQVMsQUFBRSwrRkFDdUI7QUFXbkMsb0JBTkMsa0JBQVEsQUFBRSw4QkFDQSxxQkFBRSxBQUFpQjtBQUFsQixXQUF1QixBQUFPLFFBQUMsQUFBTyxRQUFDLEFBQWdCLEFBQUMsQUFBQztDQUFwRSxxQkFDSztBQUNGLEFBQWdCLHNCQUFFLEFBQUk7QUFDdEIsQUFBc0IsNEJBQUUsQUFBSSxBQUMvQixBQUFDO0FBSEssQ0FBTiwyRkFJd0M7QUFNekMsb0JBREMsa0JBQVEsQUFBRSxxR0FDK0I7QUFNMUMsb0JBREMsa0JBQUksS0FBQyxDQUFDLEFBQVEsVUFBRSxBQUFVLEFBQUMsQUFBQyxtR0FDaUI7QUFNOUMsb0JBREMsa0JBQVMsQUFBRSxpR0FDeUI7QUFNckMsb0JBREMsa0JBQUksS0FBQyxDQUFDLEFBQUksTUFBRSxBQUFLLE9BQUUsQUFBUSxVQUFFLEFBQUssQUFBQyxBQUFDLG9HQUNxQjtBQVExRCxvQkFIQyxrQkFBUSxBQUFFLFlBQ1Ysa0JBQUcsSUFBQyxBQUFDLEFBQUMsSUFDTixrQkFBRyxJQUFDLEFBQUMsQUFBQyxnR0FDc0M7QUFNN0Msb0JBREMsa0JBQVMsQUFBRSwyR0FDbUM7QUE3SnRDLEFBQU8sMENBRG5CLFlBQVUsQUFBRSxrRUFDQSxBQUFPLEFBNktuQjtBQTdLWSxrQkFBTyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluamVjdGFibGUgfSBmcm9tICdpbnZlcnNpZnknO1xuXG5pbXBvcnQge1xuICAgIEFycmF5VW5pcXVlLFxuICAgIElzQm9vbGVhbixcbiAgICBJc0FycmF5LFxuICAgIElzSW4sXG4gICAgSXNOdW1iZXIsXG4gICAgSXNTdHJpbmcsXG4gICAgSXNVcmwsXG4gICAgTWluLFxuICAgIE1heCxcbiAgICBWYWxpZGF0ZUlmLFxuICAgIHZhbGlkYXRlU3luYyxcbiAgICBWYWxpZGF0aW9uRXJyb3IsXG4gICAgVmFsaWRhdG9yT3B0aW9uc1xufSBmcm9tICdjbGFzcy12YWxpZGF0b3InO1xuXG5pbXBvcnQgeyBUSW5wdXRPcHRpb25zIH0gZnJvbSAnLi4vdHlwZXMvb3B0aW9ucy9USW5wdXRPcHRpb25zJztcblxuaW1wb3J0IHsgSU9wdGlvbnMgfSBmcm9tICcuLi9pbnRlcmZhY2VzL29wdGlvbnMvSU9wdGlvbnMnO1xuXG5pbXBvcnQgeyBUU291cmNlTWFwTW9kZSB9IGZyb20gJy4uL3R5cGVzL1RTb3VyY2VNYXBNb2RlJztcbmltcG9ydCB7IFRTdHJpbmdBcnJheUVuY29kaW5nIH0gZnJvbSAnLi4vdHlwZXMvb3B0aW9ucy9UU3RyaW5nQXJyYXlFbmNvZGluZyc7XG5cbmltcG9ydCB7IERFRkFVTFRfUFJFU0VUIH0gZnJvbSAnLi9wcmVzZXRzL0RlZmF1bHQnO1xuXG5pbXBvcnQgeyBPcHRpb25zTm9ybWFsaXplciB9IGZyb20gJy4vT3B0aW9uc05vcm1hbGl6ZXInO1xuaW1wb3J0IHsgVmFsaWRhdGlvbkVycm9yc0Zvcm1hdHRlciB9IGZyb20gJy4vVmFsaWRhdGlvbkVycm9yc0Zvcm1hdHRlcic7XG5cbkBpbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBPcHRpb25zIGltcGxlbWVudHMgSU9wdGlvbnMge1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHtWYWxpZGF0b3JPcHRpb25zfVxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhdGljIHZhbGlkYXRvck9wdGlvbnM6IFZhbGlkYXRvck9wdGlvbnMgPSB7XG4gICAgICAgIHZhbGlkYXRpb25FcnJvcjoge1xuICAgICAgICAgICAgdGFyZ2V0OiBmYWxzZVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIEBJc0Jvb2xlYW4oKVxuICAgIHB1YmxpYyByZWFkb25seSBjb21wYWN0OiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgQElzQm9vbGVhbigpXG4gICAgcHVibGljIHJlYWRvbmx5IGNvbnRyb2xGbG93RmxhdHRlbmluZzogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIEBJc051bWJlcigpXG4gICAgQE1pbigwKVxuICAgIEBNYXgoMSlcbiAgICBwdWJsaWMgcmVhZG9ubHkgY29udHJvbEZsb3dGbGF0dGVuaW5nVGhyZXNob2xkOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASXNCb29sZWFuKClcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGVhZENvZGVJbmplY3Rpb246IGJvb2xlYW47XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIEBJc051bWJlcigpXG4gICAgcHVibGljIHJlYWRvbmx5IGRlYWRDb2RlSW5qZWN0aW9uVGhyZXNob2xkOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASXNCb29sZWFuKClcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGVidWdQcm90ZWN0aW9uOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgQElzQm9vbGVhbigpXG4gICAgcHVibGljIHJlYWRvbmx5IGRlYnVnUHJvdGVjdGlvbkludGVydmFsOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgQElzQm9vbGVhbigpXG4gICAgcHVibGljIHJlYWRvbmx5IGRpc2FibGVDb25zb2xlT3V0cHV0OiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIEBJc0FycmF5KClcbiAgICBAQXJyYXlVbmlxdWUoKVxuICAgIEBJc1N0cmluZyh7XG4gICAgICAgIGVhY2g6IHRydWVcbiAgICB9KVxuICAgIHB1YmxpYyByZWFkb25seSBkb21haW5Mb2NrOiBzdHJpbmdbXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIEBJc0Jvb2xlYW4oKVxuICAgIHB1YmxpYyByZWFkb25seSBtYW5nbGU6IGJvb2xlYW47XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgQElzQXJyYXkoKVxuICAgIEBBcnJheVVuaXF1ZSgpXG4gICAgQElzU3RyaW5nKHtcbiAgICAgICAgZWFjaDogdHJ1ZVxuICAgIH0pXG4gICAgcHVibGljIHJlYWRvbmx5IHJlc2VydmVkTmFtZXM6IHN0cmluZ1tdO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgQElzQm9vbGVhbigpXG4gICAgcHVibGljIHJlYWRvbmx5IHJvdGF0ZVN0cmluZ0FycmF5OiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBASXNOdW1iZXIoKVxuICAgIHB1YmxpYyByZWFkb25seSBzZWVkOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASXNCb29sZWFuKClcbiAgICBwdWJsaWMgcmVhZG9ubHkgc2VsZkRlZmVuZGluZzogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIEBJc0Jvb2xlYW4oKVxuICAgIHB1YmxpYyByZWFkb25seSBzb3VyY2VNYXA6IGJvb2xlYW47XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIEBJc1N0cmluZygpXG4gICAgQFZhbGlkYXRlSWYoKG9wdGlvbnM6IElPcHRpb25zKSA9PiBCb29sZWFuKG9wdGlvbnMuc291cmNlTWFwQmFzZVVybCkpXG4gICAgQElzVXJsKHtcbiAgICAgICAgcmVxdWlyZV9wcm90b2NvbDogdHJ1ZSxcbiAgICAgICAgcmVxdWlyZV92YWxpZF9wcm90b2NvbDogdHJ1ZVxuICAgIH0pXG4gICAgcHVibGljIHJlYWRvbmx5IHNvdXJjZU1hcEJhc2VVcmw6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgQElzU3RyaW5nKClcbiAgICBwdWJsaWMgcmVhZG9ubHkgc291cmNlTWFwRmlsZU5hbWU6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtUU291cmNlTWFwTW9kZX1cbiAgICAgKi9cbiAgICBASXNJbihbJ2lubGluZScsICdzZXBhcmF0ZSddKVxuICAgIHB1YmxpYyByZWFkb25seSBzb3VyY2VNYXBNb2RlOiBUU291cmNlTWFwTW9kZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIEBJc0Jvb2xlYW4oKVxuICAgIHB1YmxpYyByZWFkb25seSBzdHJpbmdBcnJheTogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtUU3RyaW5nQXJyYXlFbmNvZGluZ31cbiAgICAgKi9cbiAgICBASXNJbihbdHJ1ZSwgZmFsc2UsICdiYXNlNjQnLCAncmM0J10pXG4gICAgcHVibGljIHJlYWRvbmx5IHN0cmluZ0FycmF5RW5jb2Rpbmc6IFRTdHJpbmdBcnJheUVuY29kaW5nO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBASXNOdW1iZXIoKVxuICAgIEBNaW4oMClcbiAgICBATWF4KDEpXG4gICAgcHVibGljIHJlYWRvbmx5IHN0cmluZ0FycmF5VGhyZXNob2xkOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBASXNCb29sZWFuKClcbiAgICBwdWJsaWMgcmVhZG9ubHkgdW5pY29kZUVzY2FwZVNlcXVlbmNlOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtUSW5wdXRPcHRpb25zfSBpbnB1dE9wdGlvbnNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvciAoaW5wdXRPcHRpb25zOiBUSW5wdXRPcHRpb25zKSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgREVGQVVMVF9QUkVTRVQsIGlucHV0T3B0aW9ucyk7XG5cbiAgICAgICAgY29uc3QgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSA9IHZhbGlkYXRlU3luYyh0aGlzLCBPcHRpb25zLnZhbGlkYXRvck9wdGlvbnMpO1xuXG4gICAgICAgIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoYFZhbGlkYXRpb24gZmFpbGVkLiBlcnJvcnM6XFxuJHtWYWxpZGF0aW9uRXJyb3JzRm9ybWF0dGVyLmZvcm1hdChlcnJvcnMpfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBPcHRpb25zTm9ybWFsaXplci5ub3JtYWxpemVPcHRpb25zKHRoaXMpKTtcbiAgICB9XG59XG4iXX0=