"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var fs = require("fs");
var mkdirp = require("mkdirp");
var chai_1 = require("chai");
var CLIUtils_1 = require("../../../../src/cli/utils/CLIUtils");
describe('CLIUtils', function () {
    var fileContent = 'test';
    var tmpDir = 'test/tmp';
    before(function () {
        mkdirp.sync(tmpDir);
    });
    describe('getOutputCodePath (outputPath: string, inputPath: string): string', function () {
        var expectedInputPath = 'test/input/test-obfuscated.js',
            inputPath = 'test/input/test.js',
            outputPath = 'test/output/test.js';
        it('should return `outputPath` if this path is set', function () {
            chai_1.assert.equal(CLIUtils_1.CLIUtils.getOutputCodePath(outputPath, inputPath), outputPath);
        });
        it('should output path based on `inputPath` if `outputPath` is not set', function () {
            chai_1.assert.equal(CLIUtils_1.CLIUtils.getOutputCodePath('', inputPath), expectedInputPath);
        });
    });
    describe('getOutputSourceMapPath (outputCodePath: string): string', function () {
        var expectedOutputSourceMapPath = 'test/output/test.js.map',
            outputCodePath = 'test/output/test.js';
        it('should return output path for source map', function () {
            chai_1.assert.equal(CLIUtils_1.CLIUtils.getOutputSourceMapPath(outputCodePath), expectedOutputSourceMapPath);
        });
    });
    describe('getPackageConfig (): IPackageConfig', function () {
        it('should return `package.json` `name` field for current CLI program as object', function () {
            chai_1.assert.property(CLIUtils_1.CLIUtils.getPackageConfig(), 'name');
        });
        it('should return `package.json` `version` field for current CLI program as object', function () {
            chai_1.assert.property(CLIUtils_1.CLIUtils.getPackageConfig(), 'version');
        });
    });
    describe('validateInputPath (inputPath: string): void', function () {
        describe('`inputPath` is a valid path', function () {
            var tmpFileName = 'test.js';
            var inputPath = tmpDir + "/" + tmpFileName;
            before(function () {
                fs.writeFileSync(inputPath, fileContent);
            });
            it('shouldn\'t throw an error if `inputPath` is a valid path', function () {
                chai_1.assert.doesNotThrow(function () {
                    return CLIUtils_1.CLIUtils.validateInputPath(inputPath);
                }, ReferenceError);
            });
            after(function () {
                fs.unlinkSync(inputPath);
            });
        });
        describe('`inputPath` is not a valid path', function () {
            var tmpFileName = 'test.js';
            var inputPath = tmpDir + "/" + tmpFileName;
            it('should throw an error if `inputPath` is not a valid path', function () {
                chai_1.assert.throws(function () {
                    return CLIUtils_1.CLIUtils.validateInputPath(inputPath);
                }, ReferenceError);
            });
        });
        describe('`inputPath` is a file name has invalid extension', function () {
            var tmpFileName = 'test.ts';
            var inputPath = tmpDir + "/" + tmpFileName;
            before(function () {
                fs.writeFileSync(inputPath, fileContent);
            });
            it('should throw an error if `inputPath` is a file name has invalid extension', function () {
                chai_1.assert.throws(function () {
                    return CLIUtils_1.CLIUtils.validateInputPath(inputPath);
                }, ReferenceError);
            });
            after(function () {
                fs.unlinkSync(inputPath);
            });
        });
    });
    after(function () {
        fs.rmdirSync(tmpDir);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ0xJVXRpbHMuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Rlc3QvdW5pdC10ZXN0cy9jbGkvY2xpLXV0aWxzL0NMSVV0aWxzLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsaUJBQXlCO0FBQ3pCLHFCQUFpQztBQUVqQyxxQkFBOEI7QUFFOUIseUJBQThEO0FBRTlELEFBQVEsU0FBQyxBQUFVLFlBQUU7QUFDakIsUUFBTSxBQUFXLGNBQVcsQUFBTSxBQUFDO0FBQ25DLFFBQU0sQUFBTSxTQUFXLEFBQVUsQUFBQztBQUVsQyxBQUFNLFdBQUM7QUFDSCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sQUFBQyxBQUFDLEFBQ3hCO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBUSxhQUFDLEFBQW1FLHFFQUFFO0FBQzFFLFlBQUksQUFBaUIsb0JBQVcsQUFBK0I7WUFDM0QsQUFBUyxZQUFXLEFBQW9CO1lBQ3hDLEFBQVUsYUFBVyxBQUFxQixBQUFDO0FBRS9DLEFBQUUsV0FBQyxBQUFnRCxrREFBRTtBQUNqRCxtQkFBTSxPQUFDLEFBQUssTUFBQyxXQUFRLFNBQUMsQUFBaUIsa0JBQUMsQUFBVSxZQUFFLEFBQVMsQUFBQyxZQUFFLEFBQVUsQUFBQyxBQUFDLEFBQ2hGO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxXQUFDLEFBQW9FLHNFQUFFO0FBQ3JFLG1CQUFNLE9BQUMsQUFBSyxNQUFDLFdBQVEsU0FBQyxBQUFpQixrQkFBQyxBQUFFLElBQUUsQUFBUyxBQUFDLFlBQUUsQUFBaUIsQUFBQyxBQUFDLEFBQy9FO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFRLGFBQUMsQUFBeUQsMkRBQUU7QUFDaEUsWUFBSSxBQUEyQiw4QkFBVyxBQUF5QjtZQUMvRCxBQUFjLGlCQUFXLEFBQXFCLEFBQUM7QUFFbkQsQUFBRSxXQUFDLEFBQTBDLDRDQUFFO0FBQzNDLG1CQUFNLE9BQUMsQUFBSyxNQUFDLFdBQVEsU0FBQyxBQUFzQix1QkFBQyxBQUFjLEFBQUMsaUJBQUUsQUFBMkIsQUFBQyxBQUFDLEFBQy9GO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFRLGFBQUMsQUFBcUMsdUNBQUU7QUFDNUMsQUFBRSxXQUFDLEFBQTZFLCtFQUFFO0FBQzlFLG1CQUFNLE9BQUMsQUFBUSxTQUFDLFdBQVEsU0FBQyxBQUFnQixBQUFFLG9CQUFFLEFBQU0sQUFBQyxBQUFDLEFBQ3pEO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxXQUFDLEFBQWdGLGtGQUFFO0FBQ2pGLG1CQUFNLE9BQUMsQUFBUSxTQUFDLFdBQVEsU0FBQyxBQUFnQixBQUFFLG9CQUFFLEFBQVMsQUFBQyxBQUFDLEFBQzVEO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFRLGFBQUMsQUFBNkMsK0NBQUU7QUFDcEQsQUFBUSxpQkFBQyxBQUE2QiwrQkFBRTtBQUNwQyxnQkFBTSxBQUFXLGNBQVcsQUFBUyxBQUFDO0FBQ3RDLGdCQUFNLEFBQVMsQUFBVyxZQUFHLEFBQU0sZUFBSSxBQUFXLEFBQUUsQUFBQztBQUVyRCxBQUFNLG1CQUFDO0FBQ0gsQUFBRSxtQkFBQyxBQUFhLGNBQUMsQUFBUyxXQUFFLEFBQVcsQUFBQyxBQUFDLEFBQzdDO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxlQUFDLEFBQTBELDREQUFFO0FBQzNELHVCQUFNLE9BQUMsQUFBWTtBQUFDLDJCQUFNLFdBQVEsU0FBQyxBQUFpQixrQkFBQyxBQUFTLEFBQUM7bUJBQUUsQUFBYyxBQUFDLEFBQUMsQUFDckY7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFLLGtCQUFDO0FBQ0YsQUFBRSxtQkFBQyxBQUFVLFdBQUMsQUFBUyxBQUFDLEFBQUMsQUFDN0I7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsaUJBQUMsQUFBaUMsbUNBQUU7QUFDeEMsZ0JBQU0sQUFBVyxjQUFXLEFBQVMsQUFBQztBQUN0QyxnQkFBTSxBQUFTLEFBQVcsWUFBRyxBQUFNLGVBQUksQUFBVyxBQUFFLEFBQUM7QUFFckQsQUFBRSxlQUFDLEFBQTBELDREQUFFO0FBQzNELHVCQUFNLE9BQUMsQUFBTTtBQUFDLDJCQUFNLFdBQVEsU0FBQyxBQUFpQixrQkFBQyxBQUFTLEFBQUM7bUJBQUUsQUFBYyxBQUFDLEFBQUMsQUFDL0U7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsaUJBQUMsQUFBa0Qsb0RBQUU7QUFDekQsZ0JBQU0sQUFBVyxjQUFXLEFBQVMsQUFBQztBQUN0QyxnQkFBTSxBQUFTLEFBQVcsWUFBRyxBQUFNLGVBQUksQUFBVyxBQUFFLEFBQUM7QUFFckQsQUFBTSxtQkFBQztBQUNILEFBQUUsbUJBQUMsQUFBYSxjQUFDLEFBQVMsV0FBRSxBQUFXLEFBQUMsQUFBQyxBQUM3QztBQUFDLEFBQUMsQUFBQztBQUVILEFBQUUsZUFBQyxBQUEyRSw2RUFBRTtBQUM1RSx1QkFBTSxPQUFDLEFBQU07QUFBQywyQkFBTSxXQUFRLFNBQUMsQUFBaUIsa0JBQUMsQUFBUyxBQUFDO21CQUFFLEFBQWMsQUFBQyxBQUFDLEFBQy9FO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBSyxrQkFBQztBQUNGLEFBQUUsbUJBQUMsQUFBVSxXQUFDLEFBQVMsQUFBQyxBQUFDLEFBQzdCO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQUssVUFBQztBQUNGLEFBQUUsV0FBQyxBQUFTLFVBQUMsQUFBTSxBQUFDLEFBQUMsQUFDekI7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIG1rZGlycCBmcm9tICdta2RpcnAnO1xuXG5pbXBvcnQgeyBhc3NlcnQgfSBmcm9tICdjaGFpJztcblxuaW1wb3J0IHsgQ0xJVXRpbHMgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvY2xpL3V0aWxzL0NMSVV0aWxzJztcblxuZGVzY3JpYmUoJ0NMSVV0aWxzJywgKCkgPT4ge1xuICAgIGNvbnN0IGZpbGVDb250ZW50OiBzdHJpbmcgPSAndGVzdCc7XG4gICAgY29uc3QgdG1wRGlyOiBzdHJpbmcgPSAndGVzdC90bXAnO1xuXG4gICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgbWtkaXJwLnN5bmModG1wRGlyKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdnZXRPdXRwdXRDb2RlUGF0aCAob3V0cHV0UGF0aDogc3RyaW5nLCBpbnB1dFBhdGg6IHN0cmluZyk6IHN0cmluZycsICgpID0+IHtcbiAgICAgICAgbGV0IGV4cGVjdGVkSW5wdXRQYXRoOiBzdHJpbmcgPSAndGVzdC9pbnB1dC90ZXN0LW9iZnVzY2F0ZWQuanMnLFxuICAgICAgICAgICAgaW5wdXRQYXRoOiBzdHJpbmcgPSAndGVzdC9pbnB1dC90ZXN0LmpzJyxcbiAgICAgICAgICAgIG91dHB1dFBhdGg6IHN0cmluZyA9ICd0ZXN0L291dHB1dC90ZXN0LmpzJztcblxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBgb3V0cHV0UGF0aGAgaWYgdGhpcyBwYXRoIGlzIHNldCcsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChDTElVdGlscy5nZXRPdXRwdXRDb2RlUGF0aChvdXRwdXRQYXRoLCBpbnB1dFBhdGgpLCBvdXRwdXRQYXRoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBvdXRwdXQgcGF0aCBiYXNlZCBvbiBgaW5wdXRQYXRoYCBpZiBgb3V0cHV0UGF0aGAgaXMgbm90IHNldCcsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChDTElVdGlscy5nZXRPdXRwdXRDb2RlUGF0aCgnJywgaW5wdXRQYXRoKSwgZXhwZWN0ZWRJbnB1dFBhdGgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdnZXRPdXRwdXRTb3VyY2VNYXBQYXRoIChvdXRwdXRDb2RlUGF0aDogc3RyaW5nKTogc3RyaW5nJywgKCkgPT4ge1xuICAgICAgICBsZXQgZXhwZWN0ZWRPdXRwdXRTb3VyY2VNYXBQYXRoOiBzdHJpbmcgPSAndGVzdC9vdXRwdXQvdGVzdC5qcy5tYXAnLFxuICAgICAgICAgICAgb3V0cHV0Q29kZVBhdGg6IHN0cmluZyA9ICd0ZXN0L291dHB1dC90ZXN0LmpzJztcblxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBvdXRwdXQgcGF0aCBmb3Igc291cmNlIG1hcCcsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChDTElVdGlscy5nZXRPdXRwdXRTb3VyY2VNYXBQYXRoKG91dHB1dENvZGVQYXRoKSwgZXhwZWN0ZWRPdXRwdXRTb3VyY2VNYXBQYXRoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZ2V0UGFja2FnZUNvbmZpZyAoKTogSVBhY2thZ2VDb25maWcnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGBwYWNrYWdlLmpzb25gIGBuYW1lYCBmaWVsZCBmb3IgY3VycmVudCBDTEkgcHJvZ3JhbSBhcyBvYmplY3QnLCAoKSA9PiB7XG4gICAgICAgICAgICBhc3NlcnQucHJvcGVydHkoQ0xJVXRpbHMuZ2V0UGFja2FnZUNvbmZpZygpLCAnbmFtZScpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBgcGFja2FnZS5qc29uYCBgdmVyc2lvbmAgZmllbGQgZm9yIGN1cnJlbnQgQ0xJIHByb2dyYW0gYXMgb2JqZWN0JywgKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0LnByb3BlcnR5KENMSVV0aWxzLmdldFBhY2thZ2VDb25maWcoKSwgJ3ZlcnNpb24nKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndmFsaWRhdGVJbnB1dFBhdGggKGlucHV0UGF0aDogc3RyaW5nKTogdm9pZCcsICgpID0+IHtcbiAgICAgICAgZGVzY3JpYmUoJ2BpbnB1dFBhdGhgIGlzIGEgdmFsaWQgcGF0aCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRtcEZpbGVOYW1lOiBzdHJpbmcgPSAndGVzdC5qcyc7XG4gICAgICAgICAgICBjb25zdCBpbnB1dFBhdGg6IHN0cmluZyA9IGAke3RtcERpcn0vJHt0bXBGaWxlTmFtZX1gO1xuXG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoaW5wdXRQYXRoLCBmaWxlQ29udGVudCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZG5cXCd0IHRocm93IGFuIGVycm9yIGlmIGBpbnB1dFBhdGhgIGlzIGEgdmFsaWQgcGF0aCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQuZG9lc05vdFRocm93KCgpID0+IENMSVV0aWxzLnZhbGlkYXRlSW5wdXRQYXRoKGlucHV0UGF0aCksIFJlZmVyZW5jZUVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhZnRlcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhpbnB1dFBhdGgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCdgaW5wdXRQYXRoYCBpcyBub3QgYSB2YWxpZCBwYXRoJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdG1wRmlsZU5hbWU6IHN0cmluZyA9ICd0ZXN0LmpzJztcbiAgICAgICAgICAgIGNvbnN0IGlucHV0UGF0aDogc3RyaW5nID0gYCR7dG1wRGlyfS8ke3RtcEZpbGVOYW1lfWA7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3IgaWYgYGlucHV0UGF0aGAgaXMgbm90IGEgdmFsaWQgcGF0aCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQudGhyb3dzKCgpID0+IENMSVV0aWxzLnZhbGlkYXRlSW5wdXRQYXRoKGlucHV0UGF0aCksIFJlZmVyZW5jZUVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgnYGlucHV0UGF0aGAgaXMgYSBmaWxlIG5hbWUgaGFzIGludmFsaWQgZXh0ZW5zaW9uJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdG1wRmlsZU5hbWU6IHN0cmluZyA9ICd0ZXN0LnRzJztcbiAgICAgICAgICAgIGNvbnN0IGlucHV0UGF0aDogc3RyaW5nID0gYCR7dG1wRGlyfS8ke3RtcEZpbGVOYW1lfWA7XG5cbiAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgZnMud3JpdGVGaWxlU3luYyhpbnB1dFBhdGgsIGZpbGVDb250ZW50KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIGBpbnB1dFBhdGhgIGlzIGEgZmlsZSBuYW1lIGhhcyBpbnZhbGlkIGV4dGVuc2lvbicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQudGhyb3dzKCgpID0+IENMSVV0aWxzLnZhbGlkYXRlSW5wdXRQYXRoKGlucHV0UGF0aCksIFJlZmVyZW5jZUVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhZnRlcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhpbnB1dFBhdGgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgYWZ0ZXIoKCkgPT4ge1xuICAgICAgICBmcy5ybWRpclN5bmModG1wRGlyKTtcbiAgICB9KTtcbn0pO1xuIl19