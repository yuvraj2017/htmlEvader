"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ServiceIdentifiers_1 = require("../../../../src/container/ServiceIdentifiers");
var estraverse = require("estraverse");
var chai_1 = require("chai");
var readFileAsString_1 = require("../../../helpers/readFileAsString");
var InversifyContainerFacade_1 = require("../../../../src/container/InversifyContainerFacade");
var Node_1 = require("../../../../src/node/Node");
var Nodes_1 = require("../../../../src/node/Nodes");
var NodeUtils_1 = require("../../../../src/node/NodeUtils");
function getFunctionDeclarationByName(astTree, name) {
    var functionDeclarationNode = null;
    estraverse.traverse(astTree, {
        enter: function enter(node) {
            if (Node_1.Node.isFunctionDeclarationNode(node) && Node_1.Node.isIdentifierNode(node.id) && node.id.name === name) {
                functionDeclarationNode = node;
                return estraverse.VisitorOption.Break;
            }
        }
    });
    return functionDeclarationNode;
}
function getFunctionExpressionByName(astTree, name) {
    var functionExpressionNode = null;
    estraverse.traverse(astTree, {
        enter: function enter(node) {
            if (Node_1.Node.isVariableDeclaratorNode(node) && node.init && Node_1.Node.isFunctionExpressionNode(node.init) && Node_1.Node.isIdentifierNode(node.id) && node.id.name === name) {
                functionExpressionNode = node.init;
                return estraverse.VisitorOption.Break;
            }
        }
    });
    return functionExpressionNode;
}
function getFunctionExpressionById(astTree, id) {
    var functionExpressionNode = null;
    estraverse.traverse(astTree, {
        enter: function enter(node) {
            if (Node_1.Node.isFunctionExpressionNode(node) && node.id && Node_1.Node.isIdentifierNode(node.id) && node.id.name === id) {
                functionExpressionNode = node;
                return estraverse.VisitorOption.Break;
            }
        }
    });
    return functionExpressionNode;
}
function getObjectFunctionExpressionByName(astTree, objectName, name) {
    var functionExpressionNode = null,
        targetObjectExpressionNode = null;
    estraverse.traverse(astTree, {
        enter: function enter(node) {
            if (Node_1.Node.isVariableDeclaratorNode(node) && Node_1.Node.isIdentifierNode(node.id) && node.init && Node_1.Node.isObjectExpressionNode(node.init) && node.id.name === objectName) {
                targetObjectExpressionNode = node.init;
                return estraverse.VisitorOption.Break;
            }
        }
    });
    if (!targetObjectExpressionNode) {
        return null;
    }
    estraverse.traverse(targetObjectExpressionNode, {
        enter: function enter(node) {
            if (Node_1.Node.isPropertyNode(node) && Node_1.Node.isFunctionExpressionNode(node.value) && (Node_1.Node.isIdentifierNode(node.key) && node.key.name === name || Node_1.Node.isLiteralNode(node.key) && node.key.value === name)) {
                functionExpressionNode = node.value;
                return estraverse.VisitorOption.Break;
            }
        }
    });
    return functionExpressionNode;
}
describe('StackTraceAnalyzer', function () {
    describe('extract (): IStackTraceData[]', function () {
        var stackTraceAnalyzer = void 0,
            expectedStackTraceData = void 0,
            stackTraceData = void 0;
        before(function () {
            var inversifyContainerFacade = new InversifyContainerFacade_1.InversifyContainerFacade();
            inversifyContainerFacade.load('', {});
            stackTraceAnalyzer = inversifyContainerFacade.get(ServiceIdentifiers_1.ServiceIdentifiers.IStackTraceAnalyzer);
        });
        describe('variant #1: basic-1', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/basic-1.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: 'baz',
                    callee: getFunctionDeclarationByName(astTree, 'baz').body,
                    stackTrace: []
                }, {
                    name: 'foo',
                    callee: getFunctionDeclarationByName(astTree, 'foo').body,
                    stackTrace: []
                }, {
                    name: 'bar',
                    callee: getFunctionDeclarationByName(astTree, 'bar').body,
                    stackTrace: [{
                        name: 'inner2',
                        callee: getFunctionDeclarationByName(astTree, 'inner2').body,
                        stackTrace: [{
                            name: 'inner3',
                            callee: getFunctionExpressionByName(astTree, 'inner3').body,
                            stackTrace: []
                        }]
                    }, {
                        name: 'inner1',
                        callee: getFunctionDeclarationByName(astTree, 'inner1').body,
                        stackTrace: []
                    }]
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #2: basic-2', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/basic-2.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: 'bar',
                    callee: getFunctionDeclarationByName(astTree, 'bar').body,
                    stackTrace: []
                }, {
                    name: 'baz',
                    callee: getFunctionDeclarationByName(astTree, 'baz').body,
                    stackTrace: [{
                        name: 'inner1',
                        callee: getFunctionDeclarationByName(astTree, 'inner1').body,
                        stackTrace: []
                    }]
                }, {
                    name: 'foo',
                    callee: getFunctionDeclarationByName(astTree, 'foo').body,
                    stackTrace: []
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #3: deep conditions nesting', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/deep-conditions-nesting.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: 'bar',
                    callee: getFunctionDeclarationByName(astTree, 'bar').body,
                    stackTrace: []
                }, {
                    name: 'baz',
                    callee: getFunctionDeclarationByName(astTree, 'baz').body,
                    stackTrace: [{
                        name: 'inner1',
                        callee: getFunctionDeclarationByName(astTree, 'inner1').body,
                        stackTrace: []
                    }]
                }, {
                    name: 'foo',
                    callee: getFunctionDeclarationByName(astTree, 'foo').body,
                    stackTrace: []
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #4: call before declaration', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/call-before-declaration.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: 'bar',
                    callee: getFunctionDeclarationByName(astTree, 'bar').body,
                    stackTrace: []
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #5: call expression of object member #1', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/call-expression-of-object-member-1.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: 'baz',
                    callee: getObjectFunctionExpressionByName(astTree, 'object1', 'baz').body,
                    stackTrace: []
                }, {
                    name: 'baz',
                    callee: getObjectFunctionExpressionByName(astTree, 'object1', 'baz').body,
                    stackTrace: []
                }, {
                    name: 'func',
                    callee: getObjectFunctionExpressionByName(astTree, 'object1', 'func').body,
                    stackTrace: []
                }, {
                    name: 'bar',
                    callee: getObjectFunctionExpressionByName(astTree, 'object1', 'bar').body,
                    stackTrace: [{
                        name: 'inner1',
                        callee: getFunctionDeclarationByName(astTree, 'inner1').body,
                        stackTrace: []
                    }]
                }, {
                    name: 'bar',
                    callee: getObjectFunctionExpressionByName(astTree, 'object', 'bar').body,
                    stackTrace: [{
                        name: 'inner',
                        callee: getFunctionDeclarationByName(astTree, 'inner').body,
                        stackTrace: []
                    }]
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #5: call expression of object member #2', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/call-expression-of-object-member-2.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: 'baz',
                    callee: getObjectFunctionExpressionByName(astTree, 'object', 'baz').body,
                    stackTrace: []
                }, {
                    name: 1,
                    callee: getObjectFunctionExpressionByName(astTree, 'object1', 1).body,
                    stackTrace: []
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #6: no call expressions', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/no-call-expressions.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #7: only call expression', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/only-call-expression.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #8: self-invoking functions', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/self-invoking-functions.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: null,
                    callee: getFunctionExpressionById(astTree, 'foo').body,
                    stackTrace: [{
                        name: null,
                        callee: getFunctionExpressionById(astTree, 'bar').body,
                        stackTrace: [{
                            name: null,
                            callee: getFunctionExpressionById(astTree, 'baz').body,
                            stackTrace: [{
                                name: 'inner',
                                callee: getFunctionDeclarationByName(astTree, 'inner').body,
                                stackTrace: []
                            }]
                        }]
                    }]
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
        describe('variant #9: no recursion', function () {
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/no-recursion.js');
                var astTree = Nodes_1.Nodes.getProgramNode(NodeUtils_1.NodeUtils.convertCodeToStructure(code));
                expectedStackTraceData = [{
                    name: 'bar',
                    callee: getFunctionExpressionByName(astTree, 'bar').body,
                    stackTrace: []
                }];
                stackTraceData = stackTraceAnalyzer.analyze(astTree.body);
            });
            it('should return correct stack trace data', function () {
                chai_1.assert.deepEqual(stackTraceData, expectedStackTraceData);
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RhY2tUcmFjZUFuYWx5emVyLnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi90ZXN0L2Z1bmN0aW9uYWwtdGVzdHMvc3RhY2stdHJhY2UtYW5hbHl6ZXIvc3RhY2stdHJhY2UtYW5hbHl6ZXIvU3RhY2tUcmFjZUFuYWx5emVyLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsbUNBQWtGO0FBRWxGLHlCQUF5QztBQUd6QyxxQkFBOEI7QUFROUIsaUNBQXFFO0FBRXJFLHlDQUE4RjtBQUM5RixxQkFBaUQ7QUFDakQsc0JBQW1EO0FBQ25ELDBCQUEyRDtBQU8zRCxzQ0FBdUMsQUFBb0IsU0FBRSxBQUFZO0FBQ3JFLFFBQUksQUFBdUIsMEJBQW9DLEFBQUksQUFBQztBQUVwRSxBQUFVLGVBQUMsQUFBUSxTQUFDLEFBQU87QUFDdkIsQUFBSyxlQUFFLGVBQUMsQUFBaUI7QUFDckIsQUFBRSxBQUFDLGdCQUNDLE9BQUksS0FBQyxBQUF5QiwwQkFBQyxBQUFJLEFBQUMsU0FDcEMsT0FBSSxLQUFDLEFBQWdCLGlCQUFDLEFBQUksS0FBQyxBQUFFLEFBQUMsT0FDOUIsQUFBSSxLQUFDLEFBQUUsR0FBQyxBQUFJLFNBQUssQUFDckIsQUFBQyxNQUFDLEFBQUM7QUFDQyxBQUF1QiwwQ0FBRyxBQUFJLEFBQUM7QUFFL0IsQUFBTSx1QkFBQyxBQUFVLFdBQUMsQUFBYSxjQUFDLEFBQUssQUFBQyxBQUMxQztBQUFDLEFBQ0w7QUFBQyxBQUNKLEFBQUMsQUFBQztBQVowQjtBQWM3QixBQUFNLFdBQUMsQUFBdUIsQUFBQyxBQUNuQztBQUFDO0FBT0QscUNBQXNDLEFBQW9CLFNBQUUsQUFBWTtBQUNwRSxRQUFJLEFBQXNCLHlCQUFtQyxBQUFJLEFBQUM7QUFFbEUsQUFBVSxlQUFDLEFBQVEsU0FBQyxBQUFPO0FBQ3ZCLEFBQUssZUFBRSxlQUFDLEFBQWlCO0FBQ3JCLEFBQUUsQUFBQyxnQkFDQyxPQUFJLEtBQUMs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QyxBQUFDLEFBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTZXJ2aWNlSWRlbnRpZmllcnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvY29udGFpbmVyL1NlcnZpY2VJZGVudGlmaWVycyc7XG5cbmltcG9ydCAqIGFzIGVzdHJhdmVyc2UgZnJvbSAnZXN0cmF2ZXJzZSc7XG5pbXBvcnQgKiBhcyBFU1RyZWUgZnJvbSAnZXN0cmVlJztcblxuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSAnY2hhaSc7XG5cbmltcG9ydCB7IFROb2RlV2l0aEJsb2NrU3RhdGVtZW50IH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL3R5cGVzL25vZGUvVE5vZGVXaXRoQmxvY2tTdGF0ZW1lbnQnO1xuXG5pbXBvcnQgeyBJSW52ZXJzaWZ5Q29udGFpbmVyRmFjYWRlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL2ludGVyZmFjZXMvY29udGFpbmVyL0lJbnZlcnNpZnlDb250YWluZXJGYWNhZGUnO1xuaW1wb3J0IHsgSVN0YWNrVHJhY2VBbmFseXplciB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9pbnRlcmZhY2VzL3N0YWNrLXRyYWNlLWFuYWx5emVyL0lTdGFja1RyYWNlQW5hbHl6ZXInO1xuaW1wb3J0IHsgSVN0YWNrVHJhY2VEYXRhIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL2ludGVyZmFjZXMvc3RhY2stdHJhY2UtYW5hbHl6ZXIvSVN0YWNrVHJhY2VEYXRhJztcblxuaW1wb3J0IHsgcmVhZEZpbGVBc1N0cmluZyB9IGZyb20gJy4uLy4uLy4uL2hlbHBlcnMvcmVhZEZpbGVBc1N0cmluZyc7XG5cbmltcG9ydCB7IEludmVyc2lmeUNvbnRhaW5lckZhY2FkZSB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9jb250YWluZXIvSW52ZXJzaWZ5Q29udGFpbmVyRmFjYWRlJztcbmltcG9ydCB7IE5vZGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvbm9kZS9Ob2RlJztcbmltcG9ydCB7IE5vZGVzIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL25vZGUvTm9kZXMnO1xuaW1wb3J0IHsgTm9kZVV0aWxzIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL25vZGUvTm9kZVV0aWxzJztcblxuLyoqXG4gKiBAcGFyYW0gYXN0VHJlZVxuICogQHBhcmFtIG5hbWVcbiAqIEByZXR1cm5zIHtFU1RyZWUuRnVuY3Rpb25EZWNsYXJhdGlvbnxudWxsfVxuICovXG5mdW5jdGlvbiBnZXRGdW5jdGlvbkRlY2xhcmF0aW9uQnlOYW1lIChhc3RUcmVlOiBFU1RyZWUuTm9kZSwgbmFtZTogc3RyaW5nKTogRVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb258bnVsbCB7XG4gICAgbGV0IGZ1bmN0aW9uRGVjbGFyYXRpb25Ob2RlOiBFU1RyZWUuRnVuY3Rpb25EZWNsYXJhdGlvbnxudWxsID0gbnVsbDtcblxuICAgIGVzdHJhdmVyc2UudHJhdmVyc2UoYXN0VHJlZSwge1xuICAgICAgICBlbnRlcjogKG5vZGU6IEVTVHJlZS5Ob2RlKTogYW55ID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBOb2RlLmlzRnVuY3Rpb25EZWNsYXJhdGlvbk5vZGUobm9kZSkgJiZcbiAgICAgICAgICAgICAgICBOb2RlLmlzSWRlbnRpZmllck5vZGUobm9kZS5pZCkgJiZcbiAgICAgICAgICAgICAgICBub2RlLmlkLm5hbWUgPT09IG5hbWVcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uRGVjbGFyYXRpb25Ob2RlID0gbm9kZTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBlc3RyYXZlcnNlLlZpc2l0b3JPcHRpb24uQnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBmdW5jdGlvbkRlY2xhcmF0aW9uTm9kZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gYXN0VHJlZVxuICogQHBhcmFtIG5hbWVcbiAqIEByZXR1cm5zIHtFU1RyZWUuRnVuY3Rpb25FeHByZXNzaW9ufG51bGx9XG4gKi9cbmZ1bmN0aW9uIGdldEZ1bmN0aW9uRXhwcmVzc2lvbkJ5TmFtZSAoYXN0VHJlZTogRVNUcmVlLk5vZGUsIG5hbWU6IHN0cmluZyk6IEVTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb258bnVsbCB7XG4gICAgbGV0IGZ1bmN0aW9uRXhwcmVzc2lvbk5vZGU6IEVTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb258bnVsbCA9IG51bGw7XG5cbiAgICBlc3RyYXZlcnNlLnRyYXZlcnNlKGFzdFRyZWUsIHtcbiAgICAgICAgZW50ZXI6IChub2RlOiBFU1RyZWUuTm9kZSk6IGFueSA9PiB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgTm9kZS5pc1ZhcmlhYmxlRGVjbGFyYXRvck5vZGUobm9kZSkgJiZcbiAgICAgICAgICAgICAgICBub2RlLmluaXQgJiZcbiAgICAgICAgICAgICAgICBOb2RlLmlzRnVuY3Rpb25FeHByZXNzaW9uTm9kZShub2RlLmluaXQpICYmXG4gICAgICAgICAgICAgICAgTm9kZS5pc0lkZW50aWZpZXJOb2RlKG5vZGUuaWQpICYmXG4gICAgICAgICAgICAgICAgbm9kZS5pZC5uYW1lID09PSBuYW1lXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbkV4cHJlc3Npb25Ob2RlID0gbm9kZS5pbml0O1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVzdHJhdmVyc2UuVmlzaXRvck9wdGlvbi5CcmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uRXhwcmVzc2lvbk5vZGU7XG59XG5cbi8qKlxuICogQHBhcmFtIGFzdFRyZWVcbiAqIEBwYXJhbSBpZFxuICogQHJldHVybnMge0VTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb258bnVsbH1cbiAqL1xuZnVuY3Rpb24gZ2V0RnVuY3Rpb25FeHByZXNzaW9uQnlJZCAoYXN0VHJlZTogRVNUcmVlLk5vZGUsIGlkOiBzdHJpbmcpOiBFU1RyZWUuRnVuY3Rpb25FeHByZXNzaW9ufG51bGwge1xuICAgIGxldCBmdW5jdGlvbkV4cHJlc3Npb25Ob2RlOiBFU1RyZWUuRnVuY3Rpb25FeHByZXNzaW9ufG51bGwgPSBudWxsO1xuXG4gICAgZXN0cmF2ZXJzZS50cmF2ZXJzZShhc3RUcmVlLCB7XG4gICAgICAgIGVudGVyOiAobm9kZTogRVNUcmVlLk5vZGUpOiBhbnkgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIE5vZGUuaXNGdW5jdGlvbkV4cHJlc3Npb25Ob2RlKG5vZGUpICYmXG4gICAgICAgICAgICAgICAgbm9kZS5pZCAmJlxuICAgICAgICAgICAgICAgIE5vZGUuaXNJZGVudGlmaWVyTm9kZShub2RlLmlkKSAmJlxuICAgICAgICAgICAgICAgIG5vZGUuaWQubmFtZSA9PT0gaWRcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uRXhwcmVzc2lvbk5vZGUgPSBub2RlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVzdHJhdmVyc2UuVmlzaXRvck9wdGlvbi5CcmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uRXhwcmVzc2lvbk5vZGU7XG59XG5cbi8qKlxuICogQHBhcmFtIGFzdFRyZWVcbiAqIEBwYXJhbSBvYmplY3ROYW1lXG4gKiBAcGFyYW0gbmFtZVxuICogQHJldHVybnMge0VTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb258bnVsbH1cbiAqL1xuZnVuY3Rpb24gZ2V0T2JqZWN0RnVuY3Rpb25FeHByZXNzaW9uQnlOYW1lIChhc3RUcmVlOiBFU1RyZWUuTm9kZSwgb2JqZWN0TmFtZTogc3RyaW5nLCBuYW1lOiBzdHJpbmd8bnVtYmVyKTogRVNUcmVlLkZ1bmN0aW9uRXhwcmVzc2lvbnxudWxsIHtcbiAgICBsZXQgZnVuY3Rpb25FeHByZXNzaW9uTm9kZTogRVNUcmVlLkZ1bmN0aW9uRXhwcmVzc2lvbnxudWxsID0gbnVsbCxcbiAgICAgICAgdGFyZ2V0T2JqZWN0RXhwcmVzc2lvbk5vZGU6IEVTVHJlZS5PYmplY3RFeHByZXNzaW9ufG51bGwgPSBudWxsO1xuXG4gICAgZXN0cmF2ZXJzZS50cmF2ZXJzZShhc3RUcmVlLCB7XG4gICAgICAgIGVudGVyOiAobm9kZTogRVNUcmVlLk5vZGUpOiBhbnkgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIE5vZGUuaXNWYXJpYWJsZURlY2xhcmF0b3JOb2RlKG5vZGUpICYmXG4gICAgICAgICAgICAgICAgTm9kZS5pc0lkZW50aWZpZXJOb2RlKG5vZGUuaWQpICYmXG4gICAgICAgICAgICAgICAgbm9kZS5pbml0ICYmXG4gICAgICAgICAgICAgICAgTm9kZS5pc09iamVjdEV4cHJlc3Npb25Ob2RlKG5vZGUuaW5pdCkgJiZcbiAgICAgICAgICAgICAgICBub2RlLmlkLm5hbWUgPT09IG9iamVjdE5hbWVcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRhcmdldE9iamVjdEV4cHJlc3Npb25Ob2RlID0gbm9kZS5pbml0O1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVzdHJhdmVyc2UuVmlzaXRvck9wdGlvbi5CcmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKCF0YXJnZXRPYmplY3RFeHByZXNzaW9uTm9kZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBlc3RyYXZlcnNlLnRyYXZlcnNlKHRhcmdldE9iamVjdEV4cHJlc3Npb25Ob2RlLCB7XG4gICAgICAgIGVudGVyOiAobm9kZTogRVNUcmVlLk5vZGUpOiBhbnkgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIE5vZGUuaXNQcm9wZXJ0eU5vZGUobm9kZSkgJiZcbiAgICAgICAgICAgICAgICBOb2RlLmlzRnVuY3Rpb25FeHByZXNzaW9uTm9kZShub2RlLnZhbHVlKSAmJlxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgKE5vZGUuaXNJZGVudGlmaWVyTm9kZShub2RlLmtleSkgJiYgbm9kZS5rZXkubmFtZSA9PT0gbmFtZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgKE5vZGUuaXNMaXRlcmFsTm9kZShub2RlLmtleSkgJiYgbm9kZS5rZXkudmFsdWUgPT09IG5hbWUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb25FeHByZXNzaW9uTm9kZSA9IG5vZGUudmFsdWU7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZXN0cmF2ZXJzZS5WaXNpdG9yT3B0aW9uLkJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb25FeHByZXNzaW9uTm9kZTtcbn1cblxuZGVzY3JpYmUoJ1N0YWNrVHJhY2VBbmFseXplcicsICgpID0+IHtcbiAgICBkZXNjcmliZSgnZXh0cmFjdCAoKTogSVN0YWNrVHJhY2VEYXRhW10nLCAoKSA9PiB7XG4gICAgICAgIGxldCBzdGFja1RyYWNlQW5hbHl6ZXI6IElTdGFja1RyYWNlQW5hbHl6ZXIsXG4gICAgICAgICAgICBleHBlY3RlZFN0YWNrVHJhY2VEYXRhOiBJU3RhY2tUcmFjZURhdGFbXSxcbiAgICAgICAgICAgIHN0YWNrVHJhY2VEYXRhOiBJU3RhY2tUcmFjZURhdGFbXTtcblxuICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW52ZXJzaWZ5Q29udGFpbmVyRmFjYWRlOiBJSW52ZXJzaWZ5Q29udGFpbmVyRmFjYWRlID0gbmV3IEludmVyc2lmeUNvbnRhaW5lckZhY2FkZSgpO1xuXG4gICAgICAgICAgICBpbnZlcnNpZnlDb250YWluZXJGYWNhZGUubG9hZCgnJywge30pO1xuICAgICAgICAgICAgc3RhY2tUcmFjZUFuYWx5emVyID0gaW52ZXJzaWZ5Q29udGFpbmVyRmFjYWRlXG4gICAgICAgICAgICAgICAgLmdldDxJU3RhY2tUcmFjZUFuYWx5emVyPihTZXJ2aWNlSWRlbnRpZmllcnMuSVN0YWNrVHJhY2VBbmFseXplcik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMxOiBiYXNpYy0xJywgKCkgPT4ge1xuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvYmFzaWMtMS5qcycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFzdFRyZWU6IFROb2RlV2l0aEJsb2NrU3RhdGVtZW50ID0gTm9kZXMuZ2V0UHJvZ3JhbU5vZGUoXG4gICAgICAgICAgICAgICAgICAgIE5vZGVVdGlscy5jb252ZXJ0Q29kZVRvU3RydWN0dXJlKGNvZGUpXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGV4cGVjdGVkU3RhY2tUcmFjZURhdGEgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdiYXonLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkRlY2xhcmF0aW9uPmdldEZ1bmN0aW9uRGVjbGFyYXRpb25CeU5hbWUoYXN0VHJlZSwgJ2JheicpKS5ib2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tUcmFjZTogW11cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2ZvbycsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnZm9vJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYmFyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlZTogKDxFU1RyZWUuRnVuY3Rpb25EZWNsYXJhdGlvbj5nZXRGdW5jdGlvbkRlY2xhcmF0aW9uQnlOYW1lKGFzdFRyZWUsICdiYXInKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdpbm5lcjInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnaW5uZXIyJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnaW5uZXIzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRXhwcmVzc2lvbj5nZXRGdW5jdGlvbkV4cHJlc3Npb25CeU5hbWUoYXN0VHJlZSwgJ2lubmVyMycpKS5ib2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdpbm5lcjEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnaW5uZXIxJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgICAgICBzdGFja1RyYWNlRGF0YSA9IHN0YWNrVHJhY2VBbmFseXplci5hbmFseXplKGFzdFRyZWUuYm9keSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBzdGFjayB0cmFjZSBkYXRhJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoc3RhY2tUcmFjZURhdGEsIGV4cGVjdGVkU3RhY2tUcmFjZURhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMyOiBiYXNpYy0yJywgKCkgPT4ge1xuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvYmFzaWMtMi5qcycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFzdFRyZWU6IFROb2RlV2l0aEJsb2NrU3RhdGVtZW50ID0gTm9kZXMuZ2V0UHJvZ3JhbU5vZGUoXG4gICAgICAgICAgICAgICAgICAgIE5vZGVVdGlscy5jb252ZXJ0Q29kZVRvU3RydWN0dXJlKGNvZGUpXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGV4cGVjdGVkU3RhY2tUcmFjZURhdGEgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdiYXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkRlY2xhcmF0aW9uPmdldEZ1bmN0aW9uRGVjbGFyYXRpb25CeU5hbWUoYXN0VHJlZSwgJ2JhcicpKS5ib2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tUcmFjZTogW11cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2JheicsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnYmF6JykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnaW5uZXIxJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkRlY2xhcmF0aW9uPmdldEZ1bmN0aW9uRGVjbGFyYXRpb25CeU5hbWUoYXN0VHJlZSwgJ2lubmVyMScpKS5ib2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdmb28nLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkRlY2xhcmF0aW9uPmdldEZ1bmN0aW9uRGVjbGFyYXRpb25CeU5hbWUoYXN0VHJlZSwgJ2ZvbycpKS5ib2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tUcmFjZTogW11cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgICAgICBzdGFja1RyYWNlRGF0YSA9IHN0YWNrVHJhY2VBbmFseXplci5hbmFseXplKGFzdFRyZWUuYm9keSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBzdGFjayB0cmFjZSBkYXRhJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoc3RhY2tUcmFjZURhdGEsIGV4cGVjdGVkU3RhY2tUcmFjZURhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMzOiBkZWVwIGNvbmRpdGlvbnMgbmVzdGluZycsICgpID0+IHtcbiAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29kZTogc3RyaW5nID0gcmVhZEZpbGVBc1N0cmluZyhfX2Rpcm5hbWUgKyAnL2ZpeHR1cmVzL2RlZXAtY29uZGl0aW9ucy1uZXN0aW5nLmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgYXN0VHJlZTogVE5vZGVXaXRoQmxvY2tTdGF0ZW1lbnQgPSBOb2Rlcy5nZXRQcm9ncmFtTm9kZShcbiAgICAgICAgICAgICAgICAgICAgTm9kZVV0aWxzLmNvbnZlcnRDb2RlVG9TdHJ1Y3R1cmUoY29kZSlcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2JhcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnYmFyJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYmF6JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlZTogKDxFU1RyZWUuRnVuY3Rpb25EZWNsYXJhdGlvbj5nZXRGdW5jdGlvbkRlY2xhcmF0aW9uQnlOYW1lKGFzdFRyZWUsICdiYXonKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdpbm5lcjEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnaW5uZXIxJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2ZvbycsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnZm9vJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgIHN0YWNrVHJhY2VEYXRhID0gc3RhY2tUcmFjZUFuYWx5emVyLmFuYWx5emUoYXN0VHJlZS5ib2R5KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHN0YWNrIHRyYWNlIGRhdGEnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChzdGFja1RyYWNlRGF0YSwgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzQ6IGNhbGwgYmVmb3JlIGRlY2xhcmF0aW9uJywgKCkgPT4ge1xuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvY2FsbC1iZWZvcmUtZGVjbGFyYXRpb24uanMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhc3RUcmVlOiBUTm9kZVdpdGhCbG9ja1N0YXRlbWVudCA9IE5vZGVzLmdldFByb2dyYW1Ob2RlKFxuICAgICAgICAgICAgICAgICAgICBOb2RlVXRpbHMuY29udmVydENvZGVUb1N0cnVjdHVyZShjb2RlKVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBleHBlY3RlZFN0YWNrVHJhY2VEYXRhID0gW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYmFyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlZTogKDxFU1RyZWUuRnVuY3Rpb25EZWNsYXJhdGlvbj5nZXRGdW5jdGlvbkRlY2xhcmF0aW9uQnlOYW1lKGFzdFRyZWUsICdiYXInKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgc3RhY2tUcmFjZURhdGEgPSBzdGFja1RyYWNlQW5hbHl6ZXIuYW5hbHl6ZShhc3RUcmVlLmJvZHkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3Qgc3RhY2sgdHJhY2UgZGF0YScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKHN0YWNrVHJhY2VEYXRhLCBleHBlY3RlZFN0YWNrVHJhY2VEYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjNTogY2FsbCBleHByZXNzaW9uIG9mIG9iamVjdCBtZW1iZXIgIzEnLCAoKSA9PiB7XG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9jYWxsLWV4cHJlc3Npb24tb2Ytb2JqZWN0LW1lbWJlci0xLmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgYXN0VHJlZTogVE5vZGVXaXRoQmxvY2tTdGF0ZW1lbnQgPSBOb2Rlcy5nZXRQcm9ncmFtTm9kZShcbiAgICAgICAgICAgICAgICAgICAgTm9kZVV0aWxzLmNvbnZlcnRDb2RlVG9TdHJ1Y3R1cmUoY29kZSlcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2JheicsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRXhwcmVzc2lvbj5nZXRPYmplY3RGdW5jdGlvbkV4cHJlc3Npb25CeU5hbWUoYXN0VHJlZSwgJ29iamVjdDEnLCAnYmF6JykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYmF6JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlZTogKDxFU1RyZWUuRnVuY3Rpb25FeHByZXNzaW9uPmdldE9iamVjdEZ1bmN0aW9uRXhwcmVzc2lvbkJ5TmFtZShhc3RUcmVlLCAnb2JqZWN0MScsICdiYXonKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdmdW5jJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlZTogKDxFU1RyZWUuRnVuY3Rpb25FeHByZXNzaW9uPmdldE9iamVjdEZ1bmN0aW9uRXhwcmVzc2lvbkJ5TmFtZShhc3RUcmVlLCAnb2JqZWN0MScsICdmdW5jJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnYmFyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlZTogKDxFU1RyZWUuRnVuY3Rpb25FeHByZXNzaW9uPmdldE9iamVjdEZ1bmN0aW9uRXhwcmVzc2lvbkJ5TmFtZShhc3RUcmVlLCAnb2JqZWN0MScsICdiYXInKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdpbm5lcjEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRGVjbGFyYXRpb24+Z2V0RnVuY3Rpb25EZWNsYXJhdGlvbkJ5TmFtZShhc3RUcmVlLCAnaW5uZXIxJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2JhcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRXhwcmVzc2lvbj5nZXRPYmplY3RGdW5jdGlvbkV4cHJlc3Npb25CeU5hbWUoYXN0VHJlZSwgJ29iamVjdCcsICdiYXInKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdpbm5lcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlZTogKDxFU1RyZWUuRnVuY3Rpb25EZWNsYXJhdGlvbj5nZXRGdW5jdGlvbkRlY2xhcmF0aW9uQnlOYW1lKGFzdFRyZWUsICdpbm5lcicpKS5ib2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgc3RhY2tUcmFjZURhdGEgPSBzdGFja1RyYWNlQW5hbHl6ZXIuYW5hbHl6ZShhc3RUcmVlLmJvZHkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3Qgc3RhY2sgdHJhY2UgZGF0YScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKHN0YWNrVHJhY2VEYXRhLCBleHBlY3RlZFN0YWNrVHJhY2VEYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjNTogY2FsbCBleHByZXNzaW9uIG9mIG9iamVjdCBtZW1iZXIgIzInLCAoKSA9PiB7XG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9jYWxsLWV4cHJlc3Npb24tb2Ytb2JqZWN0LW1lbWJlci0yLmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgYXN0VHJlZTogVE5vZGVXaXRoQmxvY2tTdGF0ZW1lbnQgPSBOb2Rlcy5nZXRQcm9ncmFtTm9kZShcbiAgICAgICAgICAgICAgICAgICAgTm9kZVV0aWxzLmNvbnZlcnRDb2RlVG9TdHJ1Y3R1cmUoY29kZSlcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2JheicsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRXhwcmVzc2lvbj5nZXRPYmplY3RGdW5jdGlvbkV4cHJlc3Npb25CeU5hbWUoYXN0VHJlZSwgJ29iamVjdCcsICdiYXonKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWU6ICg8RVNUcmVlLkZ1bmN0aW9uRXhwcmVzc2lvbj5nZXRPYmplY3RGdW5jdGlvbkV4cHJlc3Npb25CeU5hbWUoYXN0VHJlZSwgJ29iamVjdDEnLCAxKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgIHN0YWNrVHJhY2VEYXRhID0gc3RhY2tUcmFjZUFuYWx5emVyLmFuYWx5emUoYXN0VHJlZS5ib2R5KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHN0YWNrIHRyYWNlIGRhdGEnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChzdGFja1RyYWNlRGF0YSwgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzY6IG5vIGNhbGwgZXhwcmVzc2lvbnMnLCAoKSA9PiB7XG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9uby1jYWxsLWV4cHJlc3Npb25zLmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgYXN0VHJlZTogVE5vZGVXaXRoQmxvY2tTdGF0ZW1lbnQgPSBOb2Rlcy5nZXRQcm9ncmFtTm9kZShcbiAgICAgICAgICAgICAgICAgICAgTm9kZVV0aWxzLmNvbnZlcnRDb2RlVG9TdHJ1Y3R1cmUoY29kZSlcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgc3RhY2tUcmFjZURhdGEgPSBzdGFja1RyYWNlQW5hbHl6ZXIuYW5hbHl6ZShhc3RUcmVlLmJvZHkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3Qgc3RhY2sgdHJhY2UgZGF0YScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKHN0YWNrVHJhY2VEYXRhLCBleHBlY3RlZFN0YWNrVHJhY2VEYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjNzogb25seSBjYWxsIGV4cHJlc3Npb24nLCAoKSA9PiB7XG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9vbmx5LWNhbGwtZXhwcmVzc2lvbi5qcycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFzdFRyZWU6IFROb2RlV2l0aEJsb2NrU3RhdGVtZW50ID0gTm9kZXMuZ2V0UHJvZ3JhbU5vZGUoXG4gICAgICAgICAgICAgICAgICAgIE5vZGVVdGlscy5jb252ZXJ0Q29kZVRvU3RydWN0dXJlKGNvZGUpXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGV4cGVjdGVkU3RhY2tUcmFjZURhdGEgPSBbXTtcblxuICAgICAgICAgICAgICAgIHN0YWNrVHJhY2VEYXRhID0gc3RhY2tUcmFjZUFuYWx5emVyLmFuYWx5emUoYXN0VHJlZS5ib2R5KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHN0YWNrIHRyYWNlIGRhdGEnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChzdGFja1RyYWNlRGF0YSwgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzg6IHNlbGYtaW52b2tpbmcgZnVuY3Rpb25zJywgKCkgPT4ge1xuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvc2VsZi1pbnZva2luZy1mdW5jdGlvbnMuanMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhc3RUcmVlOiBUTm9kZVdpdGhCbG9ja1N0YXRlbWVudCA9IE5vZGVzLmdldFByb2dyYW1Ob2RlKFxuICAgICAgICAgICAgICAgICAgICBOb2RlVXRpbHMuY29udmVydENvZGVUb1N0cnVjdHVyZShjb2RlKVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBleHBlY3RlZFN0YWNrVHJhY2VEYXRhID0gW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb24+Z2V0RnVuY3Rpb25FeHByZXNzaW9uQnlJZChhc3RUcmVlLCAnZm9vJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb24+Z2V0RnVuY3Rpb25FeHByZXNzaW9uQnlJZChhc3RUcmVlLCAnYmFyJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tUcmFjZTogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb24+Z2V0RnVuY3Rpb25FeHByZXNzaW9uQnlJZChhc3RUcmVlLCAnYmF6JykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnaW5uZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkRlY2xhcmF0aW9uPmdldEZ1bmN0aW9uRGVjbGFyYXRpb25CeU5hbWUoYXN0VHJlZSwgJ2lubmVyJykpLmJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja1RyYWNlOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgIHN0YWNrVHJhY2VEYXRhID0gc3RhY2tUcmFjZUFuYWx5emVyLmFuYWx5emUoYXN0VHJlZS5ib2R5KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHN0YWNrIHRyYWNlIGRhdGEnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChzdGFja1RyYWNlRGF0YSwgZXhwZWN0ZWRTdGFja1RyYWNlRGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzk6IG5vIHJlY3Vyc2lvbicsICgpID0+IHtcbiAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29kZTogc3RyaW5nID0gcmVhZEZpbGVBc1N0cmluZyhfX2Rpcm5hbWUgKyAnL2ZpeHR1cmVzL25vLXJlY3Vyc2lvbi5qcycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFzdFRyZWU6IFROb2RlV2l0aEJsb2NrU3RhdGVtZW50ID0gTm9kZXMuZ2V0UHJvZ3JhbU5vZGUoXG4gICAgICAgICAgICAgICAgICAgIE5vZGVVdGlscy5jb252ZXJ0Q29kZVRvU3RydWN0dXJlKGNvZGUpXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGV4cGVjdGVkU3RhY2tUcmFjZURhdGEgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdiYXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVlOiAoPEVTVHJlZS5GdW5jdGlvbkV4cHJlc3Npb24+Z2V0RnVuY3Rpb25FeHByZXNzaW9uQnlOYW1lKGFzdFRyZWUsICdiYXInKSkuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrVHJhY2U6IFtdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgc3RhY2tUcmFjZURhdGEgPSBzdGFja1RyYWNlQW5hbHl6ZXIuYW5hbHl6ZShhc3RUcmVlLmJvZHkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3Qgc3RhY2sgdHJhY2UgZGF0YScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKHN0YWNrVHJhY2VEYXRhLCBleHBlY3RlZFN0YWNrVHJhY2VEYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl19