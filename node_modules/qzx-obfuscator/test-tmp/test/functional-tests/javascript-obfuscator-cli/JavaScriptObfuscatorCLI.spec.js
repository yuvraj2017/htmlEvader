"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var fs = require("fs");
var mkdirp = require("mkdirp");
var sinon = require("sinon");
var chai_1 = require("chai");
var StdoutWriteMock_1 = require("../../mocks/StdoutWriteMock");
var JavaScriptObfuscator_1 = require("../../../src/JavaScriptObfuscator");
describe('JavaScriptObfuscatorCLI', function () {
    this.timeout(100000);
    var fixturesDirName = 'test/fixtures';
    var fixtureFileName = 'sample.js';
    var fixtureFilePath = fixturesDirName + "/" + fixtureFileName;
    var outputDirName = 'test/tmp';
    var outputFileName = 'sample-obfuscated.js';
    var outputFilePath = outputDirName + "/" + outputFileName;
    describe('run (): void', function () {
        before(function () {
            mkdirp.sync(outputDirName);
        });
        describe('`--output` option is set', function () {
            var isFileExist = void 0;
            before(function () {
                JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', fixtureFilePath, '--output', outputFilePath, '--compact', 'true', '--selfDefending', '0']);
                isFileExist = fs.existsSync(outputFilePath);
            });
            it('should create file with obfuscated code in `--output` directory', function () {
                chai_1.assert.equal(isFileExist, true);
            });
            after(function () {
                fs.unlinkSync(outputFilePath);
            });
        });
        describe('`--output` option isn\'t set', function () {
            describe('variant #1: default behaviour', function () {
                var outputFixturesFilePath = void 0,
                    isFileExist = void 0;
                before(function () {
                    outputFixturesFilePath = fixturesDirName + "/" + outputFileName;
                    JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', fixtureFilePath]);
                    isFileExist = fs.existsSync(outputFixturesFilePath);
                });
                it("should create file `" + outputFileName + "` with obfuscated code in `" + fixturesDirName + "` directory", function () {
                    chai_1.assert.equal(isFileExist, true);
                });
                after(function () {
                    fs.unlinkSync(outputFixturesFilePath);
                });
            });
            describe('variant #2: invalid input file path', function () {
                var expectedError = ReferenceError;
                var testFunc = void 0;
                before(function () {
                    testFunc = function testFunc() {
                        return JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', 'wrong/file/path']);
                    };
                });
                it("should throw an error", function () {
                    chai_1.assert.throws(testFunc, expectedError);
                });
            });
            describe('variant #3: input file extension isn\'t `.js`', function () {
                var expectedError = ReferenceError;
                var outputFileName = 'sample-obfuscated.ts';
                var outputFilePath = outputDirName + "/" + outputFileName;
                var testFunc = void 0;
                before(function () {
                    fs.writeFileSync(outputFilePath, 'data');
                    testFunc = function testFunc() {
                        return JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', outputFilePath]);
                    };
                });
                it("should throw an error", function () {
                    chai_1.assert.throws(testFunc, expectedError);
                });
                after(function () {
                    fs.unlinkSync(outputFilePath);
                });
            });
        });
        describe('`--sourceMap` option is set', function () {
            var outputSourceMapPath = outputFilePath + ".map";
            describe('variant #1: `--sourceMapMode` option value is `separate`', function () {
                describe('variant #1: default behaviour', function () {
                    var isFileExist = void 0,
                        sourceMapObject = void 0;
                    before(function () {
                        JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', fixtureFilePath, '--output', outputFilePath, '--compact', 'true', '--selfDefending', '0', '--sourceMap', 'true']);
                        try {
                            var content = fs.readFileSync(outputSourceMapPath, { encoding: 'utf8' });
                            isFileExist = true;
                            sourceMapObject = JSON.parse(content);
                        } catch (e) {
                            isFileExist = false;
                        }
                    });
                    it('should create file with source map in the same directory as output file', function () {
                        chai_1.assert.equal(isFileExist, true);
                    });
                    it('source map from created file should contains property `version`', function () {
                        chai_1.assert.property(sourceMapObject, 'version');
                    });
                    it('source map from created file should contains property `sources`', function () {
                        chai_1.assert.property(sourceMapObject, 'sources');
                    });
                    it('source map from created file should contains property `names`', function () {
                        chai_1.assert.property(sourceMapObject, 'names');
                    });
                    after(function () {
                        fs.unlinkSync(outputFilePath);
                        fs.unlinkSync(outputSourceMapPath);
                    });
                });
                describe('variant #2: `sourceMapBaseUrl` option is set', function () {
                    var isFileExist = void 0,
                        sourceMapObject = void 0;
                    before(function () {
                        JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', fixtureFilePath, '--output', outputFilePath, '--compact', 'true', '--selfDefending', '0', '--sourceMap', 'true', '--sourceMapBaseUrl', 'http://localhost:9000/']);
                        try {
                            var content = fs.readFileSync(outputSourceMapPath, { encoding: 'utf8' });
                            isFileExist = true;
                            sourceMapObject = JSON.parse(content);
                        } catch (e) {
                            isFileExist = false;
                        }
                    });
                    it('should create file with source map in the same directory as output file', function () {
                        chai_1.assert.equal(isFileExist, true);
                    });
                    it('source map from created file should contains property `version`', function () {
                        chai_1.assert.property(sourceMapObject, 'version');
                    });
                    it('source map from created file should contains property `sources`', function () {
                        chai_1.assert.property(sourceMapObject, 'sources');
                    });
                    it('source map from created file should contains property `names`', function () {
                        chai_1.assert.property(sourceMapObject, 'names');
                    });
                    after(function () {
                        fs.unlinkSync(outputFilePath);
                        fs.unlinkSync(outputSourceMapPath);
                    });
                });
                describe('variant #3: `--sourceMapFileName` option is set', function () {
                    var sourceMapFileName = 'test';
                    var sourceMapFilePath = sourceMapFileName + ".js.map";
                    var outputSourceMapFilePath = outputDirName + "/" + sourceMapFilePath;
                    var isFileExist = void 0,
                        sourceMapObject = void 0;
                    before(function () {
                        JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', fixtureFilePath, '--output', outputFilePath, '--compact', 'true', '--selfDefending', '0', '--sourceMap', 'true', '--sourceMapFileName', sourceMapFileName]);
                        try {
                            var content = fs.readFileSync(outputSourceMapFilePath, { encoding: 'utf8' });
                            isFileExist = true;
                            sourceMapObject = JSON.parse(content);
                        } catch (e) {
                            isFileExist = false;
                        }
                    });
                    it('should create source map file with given name in the same directory as output file', function () {
                        chai_1.assert.equal(isFileExist, true);
                    });
                    it('source map from created file should contains property `version`', function () {
                        chai_1.assert.property(sourceMapObject, 'version');
                    });
                    it('source map from created file should contains property `sources`', function () {
                        chai_1.assert.property(sourceMapObject, 'sources');
                    });
                    it('source map from created file should contains property `names`', function () {
                        chai_1.assert.property(sourceMapObject, 'names');
                    });
                    after(function () {
                        fs.unlinkSync(outputFilePath);
                        fs.unlinkSync(outputSourceMapFilePath);
                    });
                });
            });
            describe('variant #2: `--sourceMapMode` option is `inline`', function () {
                var isFileExist = void 0;
                before(function () {
                    JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', fixtureFilePath, '--output', outputFilePath, '--compact', 'true', '--selfDefending', '0', '--sourceMap', 'true', '--sourceMapMode', 'inline']);
                    isFileExist = fs.existsSync(outputSourceMapPath);
                });
                it('shouldn\'t create file with source map', function () {
                    chai_1.assert.equal(isFileExist, false);
                });
                after(function () {
                    fs.unlinkSync(outputFilePath);
                });
            });
        });
        describe('help output', function () {
            var callback = void 0,
                stdoutWriteMock = void 0;
            beforeEach(function () {
                callback = sinon.spy(console, 'log');
                stdoutWriteMock = new StdoutWriteMock_1.StdoutWriteMock(process.stdout.write);
            });
            describe('`--help` option is set', function () {
                var isConsoleLogCalled = void 0;
                beforeEach(function () {
                    stdoutWriteMock.mute();
                    JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator', fixtureFilePath, '--help']);
                    stdoutWriteMock.restore();
                    isConsoleLogCalled = callback.called;
                });
                it('should print `console.log` help', function () {
                    chai_1.assert.equal(isConsoleLogCalled, true);
                });
            });
            describe('no arguments passed', function () {
                var isConsoleLogCalled = void 0;
                beforeEach(function () {
                    stdoutWriteMock.mute();
                    JavaScriptObfuscator_1.JavaScriptObfuscator.runCLI(['node', 'javascript-obfuscator']);
                    stdoutWriteMock.restore();
                    isConsoleLogCalled = callback.called;
                });
                it('should print `console.log` help', function () {
                    chai_1.assert.equal(isConsoleLogCalled, true);
                });
            });
            afterEach(function () {
                callback.restore();
            });
        });
        after(function () {
            fs.rmdirSync(outputDirName);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSmF2YVNjcmlwdE9iZnVzY2F0b3JDTEkuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvZnVuY3Rpb25hbC10ZXN0cy9qYXZhc2NyaXB0LW9iZnVzY2F0b3ItY2xpL0phdmFTY3JpcHRPYmZ1c2NhdG9yQ0xJLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsaUJBQXlCO0FBQ3pCLHFCQUFpQztBQUNqQyxvQkFBK0I7QUFFL0IscUJBQThCO0FBRTlCLGdDQUE4RDtBQUU5RCxxQ0FBeUU7QUFFekUsQUFBUSxTQUFDLEFBQXlCLDJCQUFFO0FBQ2hDLEFBQUksU0FBQyxBQUFPLFFBQUMsQUFBTSxBQUFDLEFBQUM7QUFFckIsUUFBTSxBQUFlLGtCQUFXLEFBQWUsQUFBQztBQUNoRCxRQUFNLEFBQWUsa0JBQVcsQUFBVyxBQUFDO0FBQzVDLFFBQU0sQUFBZSxBQUFXLGtCQUFHLEFBQWUsd0JBQUksQUFBZSxBQUFFLEFBQUM7QUFDeEUsUUFBTSxBQUFhLGdCQUFXLEFBQVUsQUFBQztBQUN6QyxRQUFNLEFBQWMsaUJBQVcsQUFBc0IsQUFBQztBQUN0RCxRQUFNLEFBQWMsQUFBVyxpQkFBRyxBQUFhLHNCQUFJLEFBQWMsQUFBRSxBQUFDO0FBRXBFLEFBQVEsYUFBQyxBQUFjLGdCQUFFO0FBQ3JCLEFBQU0sZUFBQztBQUNILEFBQU0sbUJBQUMsQUFBSSxLQUFDLEFBQWEsQUFBQyxBQUFDLEFBQy9CO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBUSxpQkFBQyxBQUEwQiw0QkFBRTtBQUNqQyxnQkFBSSxBQUFvQixBQUFDO0FBRXpCLEFBQU0sbUJBQUM7QUFDSCx1Q0FBb0IscUJBQUMsQUFBTSxPQUFDLENBQ3hCLEFBQU0sUUFDTixBQUF1Qix5QkFDdkIsQUFBZSxpQkFDZixBQUFVLFlBQ1YsQUFBYyxnQkFDZCxBQUFXLGFBQ1gsQUFBTSxRQUNOLEFBQWlCLG1CQUNqQixBQUFHLEFBQ04sQUFBQyxBQUFDO0FB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QyxBQUN6QztBQUFDLEFBQUMsQUFBQztBQUVILEFBQUUsbUJBQUMsQUFBaUMsbUNBQUU7QUFDbEMsMkJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBa0Isb0JBQUUsQUFBSSxBQUFDLEFBQUMsQUFDM0M7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEscUJBQUMsQUFBcUIsdUJBQUU7QUFDNUIsb0JBQUksQUFBMkIsQUFBQztBQUVoQyxBQUFVLDJCQUFDO0FBQ1AsQUFBZSxvQ0FBQyxBQUFJLEFBQUUsQUFBQztBQUV2QiwyQ0FBb0IscUJBQUMsQUFBTSxPQUFDLENBQ3hCLEFBQU0sUUFDTixBQUF1QixBQUMxQixBQUFDLEFBQUM7QUFFSCxBQUFlLG9DQUFDLEFBQU8sQUFBRSxBQUFDO0FBQzFCLEFBQWtCLHlDQUFHLEFBQVEsU0FBQyxBQUFNLEFBQUMsQUFDekM7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLG1CQUFDLEFBQWlDLG1DQUFFO0FBQ2xDLDJCQUFNLE9BQUMsQUFBSyxNQUFDLEFBQWtCLG9CQUFFLEFBQUksQUFBQyxBQUFDLEFBQzNDO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFTLHNCQUFDO0FBQ04sQUFBUSx5QkFBQyxBQUFPLEFBQUUsQUFBQyxBQUN2QjtBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBSyxjQUFDO0FBQ0YsQUFBRSxlQUFDLEFBQVMsVUFBQyxBQUFhLEFBQUMsQUFBQyxBQUNoQztBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBta2RpcnAgZnJvbSAnbWtkaXJwJztcbmltcG9ydCAqIGFzIHNpbm9uIGZyb20gJ3Npbm9uJztcblxuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSAnY2hhaSc7XG5cbmltcG9ydCB7IFN0ZG91dFdyaXRlTW9jayB9IGZyb20gJy4uLy4uL21vY2tzL1N0ZG91dFdyaXRlTW9jayc7XG5cbmltcG9ydCB7IEphdmFTY3JpcHRPYmZ1c2NhdG9yIH0gZnJvbSAnLi4vLi4vLi4vc3JjL0phdmFTY3JpcHRPYmZ1c2NhdG9yJztcblxuZGVzY3JpYmUoJ0phdmFTY3JpcHRPYmZ1c2NhdG9yQ0xJJywgZnVuY3Rpb24gKCk6IHZvaWQge1xuICAgIHRoaXMudGltZW91dCgxMDAwMDApO1xuXG4gICAgY29uc3QgZml4dHVyZXNEaXJOYW1lOiBzdHJpbmcgPSAndGVzdC9maXh0dXJlcyc7XG4gICAgY29uc3QgZml4dHVyZUZpbGVOYW1lOiBzdHJpbmcgPSAnc2FtcGxlLmpzJztcbiAgICBjb25zdCBmaXh0dXJlRmlsZVBhdGg6IHN0cmluZyA9IGAke2ZpeHR1cmVzRGlyTmFtZX0vJHtmaXh0dXJlRmlsZU5hbWV9YDtcbiAgICBjb25zdCBvdXRwdXREaXJOYW1lOiBzdHJpbmcgPSAndGVzdC90bXAnO1xuICAgIGNvbnN0IG91dHB1dEZpbGVOYW1lOiBzdHJpbmcgPSAnc2FtcGxlLW9iZnVzY2F0ZWQuanMnO1xuICAgIGNvbnN0IG91dHB1dEZpbGVQYXRoOiBzdHJpbmcgPSBgJHtvdXRwdXREaXJOYW1lfS8ke291dHB1dEZpbGVOYW1lfWA7XG5cbiAgICBkZXNjcmliZSgncnVuICgpOiB2b2lkJywgKCkgPT4ge1xuICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgbWtkaXJwLnN5bmMob3V0cHV0RGlyTmFtZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCdgLS1vdXRwdXRgIG9wdGlvbiBpcyBzZXQnLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgaXNGaWxlRXhpc3Q6IGJvb2xlYW47XG5cbiAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgSmF2YVNjcmlwdE9iZnVzY2F0b3IucnVuQ0xJKFtcbiAgICAgICAgICAgICAgICAgICAgJ25vZGUnLFxuICAgICAgICAgICAgICAgICAgICAnamF2YXNjcmlwdC1vYmZ1c2NhdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgZml4dHVyZUZpbGVQYXRoLFxuICAgICAgICAgICAgICAgICAgICAnLS1vdXRwdXQnLFxuICAgICAgICAgICAgICAgICAgICBvdXRwdXRGaWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgJy0tY29tcGFjdCcsXG4gICAgICAgICAgICAgICAgICAgICd0cnVlJyxcbiAgICAgICAgICAgICAgICAgICAgJy0tc2VsZkRlZmVuZGluZycsXG4gICAgICAgICAgICAgICAgICAgICcwJ1xuICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAgICAgaXNGaWxlRXhpc3QgPSBmcy5leGlzdHNTeW5jKG91dHB1dEZpbGVQYXRoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBmaWxlIHdpdGggb2JmdXNjYXRlZCBjb2RlIGluIGAtLW91dHB1dGAgZGlyZWN0b3J5JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChpc0ZpbGVFeGlzdCwgdHJ1ZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYWZ0ZXIoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMob3V0cHV0RmlsZVBhdGgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCdgLS1vdXRwdXRgIG9wdGlvbiBpc25cXCd0IHNldCcsICgpID0+IHtcbiAgICAgICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMxOiBkZWZhdWx0IGJlaGF2aW91cicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgb3V0cHV0Rml4dHVyZXNGaWxlUGF0aDogc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICBpc0ZpbGVFeGlzdDogYm9vbGVhbjtcblxuICAgICAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dEZpeHR1cmVzRmlsZVBhdGggPSBgJHtmaXh0dXJlc0Rpck5hbWV9LyR7b3V0cHV0RmlsZU5hbWV9YDtcblxuICAgICAgICAgICAgICAgICAgICBKYXZhU2NyaXB0T2JmdXNjYXRvci5ydW5DTEkoW1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25vZGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2phdmFzY3JpcHQtb2JmdXNjYXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXh0dXJlRmlsZVBhdGhcbiAgICAgICAgICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaXNGaWxlRXhpc3QgPSBmcy5leGlzdHNTeW5jKG91dHB1dEZpeHR1cmVzRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaXQoYHNob3VsZCBjcmVhdGUgZmlsZSBcXGAke291dHB1dEZpbGVOYW1lfVxcYCB3aXRoIG9iZnVzY2F0ZWQgY29kZSBpbiBcXGAke2ZpeHR1cmVzRGlyTmFtZX1cXGAgZGlyZWN0b3J5YCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwoaXNGaWxlRXhpc3QsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgYWZ0ZXIoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKG91dHB1dEZpeHR1cmVzRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMyOiBpbnZhbGlkIGlucHV0IGZpbGUgcGF0aCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBleHBlY3RlZEVycm9yOiBSZWZlcmVuY2VFcnJvckNvbnN0cnVjdG9yID0gUmVmZXJlbmNlRXJyb3I7XG5cbiAgICAgICAgICAgICAgICBsZXQgdGVzdEZ1bmM6ICgpID0+IHZvaWQ7XG5cbiAgICAgICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0ZXN0RnVuYyA9ICgpID0+IEphdmFTY3JpcHRPYmZ1c2NhdG9yLnJ1bkNMSShbXG4gICAgICAgICAgICAgICAgICAgICAgICAnbm9kZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnamF2YXNjcmlwdC1vYmZ1c2NhdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICd3cm9uZy9maWxlL3BhdGgnXG4gICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaXQoYHNob3VsZCB0aHJvdyBhbiBlcnJvcmAsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LnRocm93cyh0ZXN0RnVuYywgZXhwZWN0ZWRFcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzM6IGlucHV0IGZpbGUgZXh0ZW5zaW9uIGlzblxcJ3QgYC5qc2AnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRFcnJvcjogUmVmZXJlbmNlRXJyb3JDb25zdHJ1Y3RvciA9IFJlZmVyZW5jZUVycm9yO1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dEZpbGVOYW1lOiBzdHJpbmcgPSAnc2FtcGxlLW9iZnVzY2F0ZWQudHMnO1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dEZpbGVQYXRoOiBzdHJpbmcgPSBgJHtvdXRwdXREaXJOYW1lfS8ke291dHB1dEZpbGVOYW1lfWA7XG5cbiAgICAgICAgICAgICAgICBsZXQgdGVzdEZ1bmM6ICgpID0+IHZvaWQ7XG5cbiAgICAgICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKG91dHB1dEZpbGVQYXRoLCAnZGF0YScpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRlc3RGdW5jID0gKCkgPT4gSmF2YVNjcmlwdE9iZnVzY2F0b3IucnVuQ0xJKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICdub2RlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdqYXZhc2NyaXB0LW9iZnVzY2F0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0RmlsZVBhdGhcbiAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpdChgc2hvdWxkIHRocm93IGFuIGVycm9yYCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQudGhyb3dzKHRlc3RGdW5jLCBleHBlY3RlZEVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGFmdGVyKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhvdXRwdXRGaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ2AtLXNvdXJjZU1hcGAgb3B0aW9uIGlzIHNldCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG91dHB1dFNvdXJjZU1hcFBhdGg6IHN0cmluZyA9IGAke291dHB1dEZpbGVQYXRofS5tYXBgO1xuXG4gICAgICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjMTogYC0tc291cmNlTWFwTW9kZWAgb3B0aW9uIHZhbHVlIGlzIGBzZXBhcmF0ZWAnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzE6IGRlZmF1bHQgYmVoYXZpb3VyJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXNGaWxlRXhpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VNYXBPYmplY3Q6IGFueTtcblxuICAgICAgICAgICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgSmF2YVNjcmlwdE9iZnVzY2F0b3IucnVuQ0xJKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbm9kZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2phdmFzY3JpcHQtb2JmdXNjYXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZml4dHVyZUZpbGVQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctLW91dHB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0RmlsZVBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy0tY29tcGFjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RydWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctLXNlbGZEZWZlbmRpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLS1zb3VyY2VNYXAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cnVlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudDogc3RyaW5nID0gZnMucmVhZEZpbGVTeW5jKG91dHB1dFNvdXJjZU1hcFBhdGgsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlsZUV4aXN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VNYXBPYmplY3QgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlsZUV4aXN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGZpbGUgd2l0aCBzb3VyY2UgbWFwIGluIHRoZSBzYW1lIGRpcmVjdG9yeSBhcyBvdXRwdXQgZmlsZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChpc0ZpbGVFeGlzdCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGl0KCdzb3VyY2UgbWFwIGZyb20gY3JlYXRlZCBmaWxlIHNob3VsZCBjb250YWlucyBwcm9wZXJ0eSBgdmVyc2lvbmAnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQucHJvcGVydHkoc291cmNlTWFwT2JqZWN0LCAndmVyc2lvbicpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpdCgnc291cmNlIG1hcCBmcm9tIGNyZWF0ZWQgZmlsZSBzaG91bGQgY29udGFpbnMgcHJvcGVydHkgYHNvdXJjZXNgJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LnByb3BlcnR5KHNvdXJjZU1hcE9iamVjdCwgJ3NvdXJjZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaXQoJ3NvdXJjZSBtYXAgZnJvbSBjcmVhdGVkIGZpbGUgc2hvdWxkIGNvbnRhaW5zIHByb3BlcnR5IGBuYW1lc2AnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQucHJvcGVydHkoc291cmNlTWFwT2JqZWN0LCAnbmFtZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgYWZ0ZXIoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhvdXRwdXRGaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKG91dHB1dFNvdXJjZU1hcFBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMyOiBgc291cmNlTWFwQmFzZVVybGAgb3B0aW9uIGlzIHNldCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlzRmlsZUV4aXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlTWFwT2JqZWN0OiBhbnk7XG5cbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEphdmFTY3JpcHRPYmZ1c2NhdG9yLnJ1bkNMSShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25vZGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdqYXZhc2NyaXB0LW9iZnVzY2F0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpeHR1cmVGaWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLS1vdXRwdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dEZpbGVQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctLWNvbXBhY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cnVlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLS1zZWxmRGVmZW5kaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy0tc291cmNlTWFwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJ1ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy0tc291cmNlTWFwQmFzZVVybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMC8nXG4gICAgICAgICAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50OiBzdHJpbmcgPSBmcy5yZWFkRmlsZVN5bmMob3V0cHV0U291cmNlTWFwUGF0aCwgeyBlbmNvZGluZzogJ3V0ZjgnIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNGaWxlRXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZU1hcE9iamVjdCA9IEpTT04ucGFyc2UoY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNGaWxlRXhpc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgZmlsZSB3aXRoIHNvdXJjZSBtYXAgaW4gdGhlIHNhbWUgZGlyZWN0b3J5IGFzIG91dHB1dCBmaWxlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGlzRmlsZUV4aXN0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaXQoJ3NvdXJjZSBtYXAgZnJvbSBjcmVhdGVkIGZpbGUgc2hvdWxkIGNvbnRhaW5zIHByb3BlcnR5IGB2ZXJzaW9uYCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydC5wcm9wZXJ0eShzb3VyY2VNYXBPYmplY3QsICd2ZXJzaW9uJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGl0KCdzb3VyY2UgbWFwIGZyb20gY3JlYXRlZCBmaWxlIHNob3VsZCBjb250YWlucyBwcm9wZXJ0eSBgc291cmNlc2AnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQucHJvcGVydHkoc291cmNlTWFwT2JqZWN0LCAnc291cmNlcycpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpdCgnc291cmNlIG1hcCBmcm9tIGNyZWF0ZWQgZmlsZSBzaG91bGQgY29udGFpbnMgcHJvcGVydHkgYG5hbWVzYCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydC5wcm9wZXJ0eShzb3VyY2VNYXBPYmplY3QsICduYW1lcycpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBhZnRlcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKG91dHB1dEZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMob3V0cHV0U291cmNlTWFwUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzM6IGAtLXNvdXJjZU1hcEZpbGVOYW1lYCBvcHRpb24gaXMgc2V0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VNYXBGaWxlTmFtZTogc3RyaW5nID0gJ3Rlc3QnO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VNYXBGaWxlUGF0aDogc3RyaW5nID0gYCR7c291cmNlTWFwRmlsZU5hbWV9LmpzLm1hcGA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dFNvdXJjZU1hcEZpbGVQYXRoOiBzdHJpbmcgPSBgJHtvdXRwdXREaXJOYW1lfS8ke3NvdXJjZU1hcEZpbGVQYXRofWA7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGlzRmlsZUV4aXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlTWFwT2JqZWN0OiBhbnk7XG5cbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEphdmFTY3JpcHRPYmZ1c2NhdG9yLnJ1bkNMSShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25vZGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdqYXZhc2NyaXB0LW9iZnVzY2F0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpeHR1cmVGaWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLS1vdXRwdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dEZpbGVQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctLWNvbXBhY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cnVlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLS1zZWxmRGVmZW5kaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy0tc291cmNlTWFwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJ1ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy0tc291cmNlTWFwRmlsZU5hbWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZU1hcEZpbGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50OiBzdHJpbmcgPSBmcy5yZWFkRmlsZVN5bmMob3V0cHV0U291cmNlTWFwRmlsZVBhdGgsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlsZUV4aXN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VNYXBPYmplY3QgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlsZUV4aXN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIHNvdXJjZSBtYXAgZmlsZSB3aXRoIGdpdmVuIG5hbWUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5IGFzIG91dHB1dCBmaWxlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGlzRmlsZUV4aXN0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaXQoJ3NvdXJjZSBtYXAgZnJvbSBjcmVhdGVkIGZpbGUgc2hvdWxkIGNvbnRhaW5zIHByb3BlcnR5IGB2ZXJzaW9uYCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydC5wcm9wZXJ0eShzb3VyY2VNYXBPYmplY3QsICd2ZXJzaW9uJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGl0KCdzb3VyY2UgbWFwIGZyb20gY3JlYXRlZCBmaWxlIHNob3VsZCBjb250YWlucyBwcm9wZXJ0eSBgc291cmNlc2AnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQucHJvcGVydHkoc291cmNlTWFwT2JqZWN0LCAnc291cmNlcycpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpdCgnc291cmNlIG1hcCBmcm9tIGNyZWF0ZWQgZmlsZSBzaG91bGQgY29udGFpbnMgcHJvcGVydHkgYG5hbWVzYCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydC5wcm9wZXJ0eShzb3VyY2VNYXBPYmplY3QsICduYW1lcycpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBhZnRlcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKG91dHB1dEZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMob3V0cHV0U291cmNlTWFwRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjMjogYC0tc291cmNlTWFwTW9kZWAgb3B0aW9uIGlzIGBpbmxpbmVgJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpc0ZpbGVFeGlzdDogYm9vbGVhbjtcblxuICAgICAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIEphdmFTY3JpcHRPYmZ1c2NhdG9yLnJ1bkNMSShbXG4gICAgICAgICAgICAgICAgICAgICAgICAnbm9kZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnamF2YXNjcmlwdC1vYmZ1c2NhdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpeHR1cmVGaWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICctLW91dHB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRGaWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICctLWNvbXBhY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RydWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJy0tc2VsZkRlZmVuZGluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAnMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnLS1zb3VyY2VNYXAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RydWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJy0tc291cmNlTWFwTW9kZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaW5saW5lJ1xuICAgICAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgICAgICBpc0ZpbGVFeGlzdCA9IGZzLmV4aXN0c1N5bmMob3V0cHV0U291cmNlTWFwUGF0aCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpdCgnc2hvdWxkblxcJ3QgY3JlYXRlIGZpbGUgd2l0aCBzb3VyY2UgbWFwJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwoaXNGaWxlRXhpc3QsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGFmdGVyKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhvdXRwdXRGaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ2hlbHAgb3V0cHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGNhbGxiYWNrOiBzaW5vbi5TaW5vblNweSxcbiAgICAgICAgICAgICAgICBzdGRvdXRXcml0ZU1vY2s6IFN0ZG91dFdyaXRlTW9jaztcblxuICAgICAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBzaW5vbi5zcHkoY29uc29sZSwgJ2xvZycpO1xuICAgICAgICAgICAgICAgIHN0ZG91dFdyaXRlTW9jayA9IG5ldyBTdGRvdXRXcml0ZU1vY2socHJvY2Vzcy5zdGRvdXQud3JpdGUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGRlc2NyaWJlKCdgLS1oZWxwYCBvcHRpb24gaXMgc2V0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpc0NvbnNvbGVMb2dDYWxsZWQ6IGJvb2xlYW47XG5cbiAgICAgICAgICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc3Rkb3V0V3JpdGVNb2NrLm11dGUoKTtcblxuICAgICAgICAgICAgICAgICAgICBKYXZhU2NyaXB0T2JmdXNjYXRvci5ydW5DTEkoW1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25vZGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2phdmFzY3JpcHQtb2JmdXNjYXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXh0dXJlRmlsZVBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAnLS1oZWxwJ1xuICAgICAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgICAgICBzdGRvdXRXcml0ZU1vY2sucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgICAgICBpc0NvbnNvbGVMb2dDYWxsZWQgPSBjYWxsYmFjay5jYWxsZWQ7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpdCgnc2hvdWxkIHByaW50IGBjb25zb2xlLmxvZ2AgaGVscCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGlzQ29uc29sZUxvZ0NhbGxlZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZGVzY3JpYmUoJ25vIGFyZ3VtZW50cyBwYXNzZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGlzQ29uc29sZUxvZ0NhbGxlZDogYm9vbGVhbjtcblxuICAgICAgICAgICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdGRvdXRXcml0ZU1vY2subXV0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIEphdmFTY3JpcHRPYmZ1c2NhdG9yLnJ1bkNMSShbXG4gICAgICAgICAgICAgICAgICAgICAgICAnbm9kZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnamF2YXNjcmlwdC1vYmZ1c2NhdG9yJ1xuICAgICAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgICAgICBzdGRvdXRXcml0ZU1vY2sucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgICAgICBpc0NvbnNvbGVMb2dDYWxsZWQgPSBjYWxsYmFjay5jYWxsZWQ7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpdCgnc2hvdWxkIHByaW50IGBjb25zb2xlLmxvZ2AgaGVscCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGlzQ29uc29sZUxvZ0NhbGxlZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5yZXN0b3JlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYWZ0ZXIoKCkgPT4ge1xuICAgICAgICAgICAgZnMucm1kaXJTeW5jKG91dHB1dERpck5hbWUpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl19