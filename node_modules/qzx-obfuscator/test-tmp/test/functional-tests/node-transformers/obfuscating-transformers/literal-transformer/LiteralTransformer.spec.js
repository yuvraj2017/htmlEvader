"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var chai_1 = require("chai");
var NoCustomNodes_1 = require("../../../../../src/options/presets/NoCustomNodes");
var readFileAsString_1 = require("../../../../helpers/readFileAsString");
var JavaScriptObfuscator_1 = require("../../../../../src/JavaScriptObfuscator");
describe('LiteralTransformer', function () {
    describe('transformation of literal node with string value', function () {
        describe('variant #1: default behaviour', function () {
            var stringArrayRegExp = /^var *_0x([a-f0-9]){4} *= *\['test'\];/;
            var stringArrayCallRegExp = /var *test *= *_0x([a-f0-9]){4}\('0x0'\);/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1 }));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('match #1: should replace literal node value with value from string array', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayRegExp);
            });
            it('match #2: should replace literal node value with value from string array', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayCallRegExp);
            });
        });
        describe('variant #2: `stringArray` option is disabled', function () {
            var regExp = /^var *test *= *'test';/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('shouldn\'t replace literal node value with value from string array', function () {
                chai_1.assert.match(obfuscatedCode, regExp);
            });
        });
        describe('variant #3: string contains non-latin and non-digit characters and `unicodeEscapeSequence` is disabled', function () {
            var testFunc = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/error-when-non-latin.js');
                testFunc = function testFunc() {
                    return JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1 }));
                };
            });
            it('should\'t throw an error', function () {
                chai_1.assert.doesNotThrow(testFunc);
            });
        });
        describe('variant #4: same literal node values', function () {
            var stringArrayRegExp = /^var *_0x([a-f0-9]){4} *= *\['test'\];/;
            var stringArrayCallRegExp = /var *test *= *_0x([a-f0-9]){4}\('0x0'\);/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/same-literal-values.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1 }));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('match #1: should create only one item in string array for same literal node values', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayRegExp);
            });
            it('match #2: should create only one item in string array for same literal node values', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayCallRegExp);
            });
        });
        describe('variant #5: `unicodeEscapeSequence` option is enabled', function () {
            var regExp = /^var *test *= *'\\x74\\x65\\x73\\x74';$/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { unicodeEscapeSequence: true }));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('should replace literal node value with unicode escape sequence', function () {
                chai_1.assert.match(obfuscatedCode, regExp);
            });
        });
        describe('variant #6: `unicodeEscapeSequence` and `stringArray` options are enabled', function () {
            var stringArrayRegExp = /^var *_0x([a-f0-9]){4} *= *\['\\x74\\x65\\x73\\x74'\];/;
            var stringArrayCallRegExp = /var *test *= *_0x([a-f0-9]){4}\('0x0'\);/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1, unicodeEscapeSequence: true }));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('match #1: should replace literal node value with unicode escape sequence from string array', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayRegExp);
            });
            it('match #1: should replace literal node value with unicode escape sequence from string array', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayCallRegExp);
            });
        });
        describe('variant #7: short literal node value', function () {
            var regExp = /var *test *= *'te';/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/short-literal-value.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1 }));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('shouldn\'t replace short literal node value with value from string array', function () {
                chai_1.assert.match(obfuscatedCode, regExp);
            });
        });
        describe('variant #8: base64 encoding', function () {
            var stringArrayRegExp = /^var *_0x([a-f0-9]){4} *= *\['dGVzdA=='\];/;
            var stringArrayCallRegExp = /var *test *= *_0x([a-f0-9]){4}\('0x0'\);/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayEncoding: 'base64', stringArrayThreshold: 1 }));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('match #1: should replace literal node value with value from string array encoded using base64', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayRegExp);
            });
            it('match #2: should replace literal node value with value from string array encoded using base64', function () {
                chai_1.assert.match(obfuscatedCode, stringArrayCallRegExp);
            });
        });
        describe('variant #9: rc4 encoding', function () {
            var regExp = /var *test *= *_0x([a-f0-9]){4}\('0x0', *'.{4}'\);/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayEncoding: 'rc4', stringArrayThreshold: 1 }));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('should replace literal node value with value from string array encoded using rc4', function () {
                chai_1.assert.match(obfuscatedCode, regExp);
            });
        });
        describe('variant #10: `stringArrayThreshold` option value', function () {
            var samples = 1000;
            var stringArrayThreshold = 0.5;
            var delta = 0.1;
            var regExp1 = /var *test *= *_0x([a-f0-9]){4}\('0x0'\);/g;
            var regExp2 = /var *test *= *'test';/g;
            var stringArrayProbability = void 0,
                noStringArrayProbability = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate((code + "\n").repeat(samples), Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: stringArrayThreshold }));
                var stringArrayMatchesLength = obfuscationResult.getObfuscatedCode().match(regExp1).length;
                var noStringArrayMatchesLength = obfuscationResult.getObfuscatedCode().match(regExp2).length;
                stringArrayProbability = stringArrayMatchesLength / samples;
                noStringArrayProbability = noStringArrayMatchesLength / samples;
            });
            it('variant #1: should replace literal node value with value from string array with `stringArrayThreshold` chance', function () {
                chai_1.assert.closeTo(stringArrayProbability, stringArrayThreshold, delta);
            });
            it('variant #2: shouldn\'t replace literal node value with value from string array with `(1 - stringArrayThreshold)` chance', function () {
                chai_1.assert.closeTo(noStringArrayProbability, stringArrayThreshold, delta);
            });
        });
    });
    describe('transformation of literal node with boolean value', function () {
        var regExp = /^var *test *= *!!\[\];$/;
        var obfuscatedCode = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/boolean-value.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1 }));
            obfuscatedCode = obfuscationResult.getObfuscatedCode();
        });
        it('should transform literal node', function () {
            chai_1.assert.match(obfuscatedCode, regExp);
        });
    });
    describe('transformation of literal node with number value', function () {
        var regExp = /^var *test *= *0x0;$/;
        var obfuscatedCode = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/number-value.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1 }));
            obfuscatedCode = obfuscationResult.getObfuscatedCode();
        });
        it('should transform literal node', function () {
            chai_1.assert.match(obfuscatedCode, regExp);
        });
    });
    describe('RegExp literal', function () {
        var regExp = /^var *regExp *= *\/\(\\d\+\)\/;$/;
        var obfuscatedCode = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/regexp-literal.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { stringArray: true, stringArrayThreshold: 1 }));
            obfuscatedCode = obfuscationResult.getObfuscatedCode();
        });
        it('should keep safe value of RegExp literal', function () {
            chai_1.assert.match(obfuscatedCode, regExp);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTGl0ZXJhbFRyYW5zZm9ybWVyLnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi90ZXN0L2Z1bmN0aW9uYWwtdGVzdHMvbm9kZS10cmFuc2Zvcm1lcnMvb2JmdXNjYXRpbmctdHJhbnNmb3JtZXJzL2xpdGVyYWwtdHJhbnNmb3JtZXIvTGl0ZXJhbFRyYW5zZm9ybWVyLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEscUJBQThCO0FBSTlCLDhCQUEwRjtBQUUxRixpQ0FBd0U7QUFFeEUscUNBQStFO0FBRS9FLEFBQVEsU0FBQyxBQUFvQixzQkFBRTtBQUMzQixBQUFRLGFBQUMsQUFBa0Qsb0RBQUU7QUFDekQsQUFBUSxpQkFBQyxBQUErQixpQ0FBRTtBQUN0QyxnQkFBTSxBQUFpQixvQkFBVyxBQUF3QyxBQUFDO0FBQzNFLGdCQUFNLEFBQXFCLHdCQUFXLEFBQTBDLEFBQUM7QUFFakYsZ0JBQUksQUFBc0IsQUFBQztBQUUzQixBQUFNLG1CQUFDO0FBQ0gsb0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBMkIsQUFBQyxBQUFDO0FBQy9FLG9CQUFNLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN4RSxBQUFJLHdCQUVHLGdCQUFzQiwwQkFDekIsQUFBVyxhQUFFLEFBQUksTUFDakIsQUFBb0Isc0JBQUUsQUFBQyxBQUU5QixBQUFDO0FBRUYsQUFBYyxpQ0FBRyxBQUFpQixrQkFBQyxBQUFpQixBQUFFLEFBQUMsQUFDM0Q7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLGVBQUMsQUFBMEUsNEVBQUU7QUFDM0UsdUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBYyxnQkFBRSxBQUFpQixBQUFDLEFBQUMsQUFDcEQ7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLGVBQUMsQUFBMEUsNEVBQUU7QUFDM0UsdUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBYyxnQkFBRSxBQUFxQixBQUFDLEFBQUMsQUFDeEQ7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsaUJBQUMsQUFBOEMsZ0RBQUU7QUFDckQsZ0JBQU0sQUFBTSxTQUFXLEFBQXdCLEFBQUM7QUFFaEQsZ0JBQUksQUFBc0IsQUFBQztBQUUzQixBQUFNLG1CQUFDO0FBQ0gsb0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBMkIsQUFBQyxBQUFDO0FBQy9FLG9CQUFNLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN4RSxBQUFJLHdCQUVHLGdCQUFzQixBQUVoQyxBQUFDO0FBRUYsQUFBYyxpQ0FBRyxBQUFpQixrQkFBQyxBQUFpQixBQUFFLEFBQUMsQUFDM0Q7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLGVBQUMsQUFBb0Usc0VBQUU7QUFDckUsdUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBYyxnQkFBRSxBQUFNLEFBQUMsQUFBQyxBQUN6QztBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBUSxpQkFBQyxBQUF3RywwR0FBRTtBQUMvRyxnQkFBSSxBQUFvQixBQUFDO0FBRXpCLEFBQU0sbUJBQUM7QUFDSCxvQkFBTSxBQUFJLE9BQVcsbUJBQWdCLGlCQUFDLEFBQVMsWUFBRyxBQUFtQyxBQUFDLEFBQUM7QUFFdkYsQUFBUTtBQUFHLDJCQUFNLHVCQUFvQixxQkFBQyxBQUFTLFVBQzNDLEFBQUksd0JBRUcsZ0JBQXNCLDBCQUN6QixBQUFXLGFBQUUsQUFBSSxNQUNqQixBQUFvQixzQkFBRSxBQUFDLEFBRTlCLEFBQUMsQUFDTjs7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLGVBQUMsQUFBMEIsNEJBQUU7QUFDM0IsdUJBQU0sT0FBQyxBQUFZLGFBQUMsQUFBUSxBQUFDLEFBQUMsQUFDbEM7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsaUJBQUMsQUFBc0Msd0NBQUU7QUFDN0MsZ0JBQU0sQUFBaUIsb0JBQVcsQUFBd0MsQUFBQztBQUMzRSxnQkFBTSxBQUFxQix3QkFBVyxBQUEwQyxBQUFDO0FBRWpGLGdCQUFJLEFBQXNCLEFBQUM7QUFFM0IsQUFBTSxtQkFBQztBQUNILG9CQUFNLEFBQUksT0FBVyxtQkFBZ0IsaUJBQUMsQUFBUyxZQUFHLEFBQWtDLEFBQUMsQUFBQztBQUN0RixvQkFBTSxBQUFpQixvQkFBdUIsdUJBQW9CLHFCQUFDLEFBQVMsVUFDeEUsQUFBSSx3QkFFRyxnQkFBc0IsMEJBQ3pCLEFBQVcsYUFBRSxBQUFJLE1BQ2pCLEFBQW9CLHNCQUFFLEFBQUMsQUFFOUIsQUFBQztBQUVGLEFBQWMsaUNBQUcsQUFBaUIsa0JBQUMsQUFBaUIsQUFBRSxBQUFDLEFBQzNEO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxlQUFDLEFBQW9GLHNGQUFFO0FBQ3JGLHVCQUFNLE9BQUMsQUFBSyxNQUFDLEFBQWMsZ0JBQUUsQUFBaUIsQUFBQyxBQUFDLEFBQ3BEO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxlQUFDLEFBQW9GLHNGQUFFO0FBQ3JGLHVCQUFNLE9BQUMsQUFBSyxNQUFDLEFBQWMsZ0JBQUUsQUFBcUIsQUFBQyxBQUFDLEFBQ3hEO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFRLGlCQUFDLEFBQXVELHlEQUFFO0FBQzlELGdCQUFNLEFBQU0sU0FBVyxBQUF5QyxBQUFDO0FBRWpFLGdCQUFJLEFBQXNCLEFBQUM7QUFFM0IsQUFBTSxtQkFBQztBQUNILG9CQUFNLEFBQUksT0FBVyxtQkFBZ0IsaUJBQUMsQUFBUyxZQUFHLEFBQTJCLEFBQUMsQUFBQztBQUMvRSxvQkFBTSxBQUFpQixvQkFBdUIsdUJBQW9CLHFCQUFDLEFBQVMsVUFDeEUsQUFBSSx3QkFFRyxnQkFBc0IsMEJBQ3pCLEFBQXFCLHVCQUFFLEFBQUksQUFHbEMsQUFBQztBQUVGLEFBQWMsaUNBQUcsQUFBaUIsa0JBQUMsQUFBaUIsQUFBRSxBQUFDLEFBQzNEO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxlQUFDLEFBQWdFLGtFQUFFO0FBQ2pFLHVCQUFNLE9BQUMsQUFBSyxNQUFDLEFBQWMsZ0JBQUUsQUFBTSxBQUFDLEFBQUMsQUFDekM7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsaUJBQUMsQUFBMkUsNkVBQUU7QUFDbEYsZ0JBQU0sQUFBaUIsb0JBQVcsQUFBd0QsQUFBQztBQUMzRixnQkFBTSxBQUFxQix3QkFBVyxBQUEwQyxBQUFDO0FBRWpGLGdCQUFJLEFBQXNCLEFBQUM7QUFFM0IsQUFBTSxtQkFBQztBQUNILG9CQUFNLEFBQUksT0FBVyxtQkFBZ0IsaUJBQUMsQUFBUyxZQUFHLEFBQTJCLEFBQUMsQUFBQztBQUMvRSxvQkFBTSxBQUFpQixvQkFBdUIsdUJBQW9CLHFCQUFDLEFBQVMsVUFDeEUsQUFBSSx3QkFFRyxnQkFBc0IsMEJBQ3pCLEFBQVcsYUFBRSxBQUFJLE1BQ2pCLEFBQW9CLHNCQUFFLEFBQUMsR0FDdkIsQUFBcUIsdUJBQUUsQUFBSSxBQUVsQyxBQUFDO0FBRUYsQUFBYyxpQ0FBRyxBQUFpQixrQkFBQyxBQUFpQixBQUFFLEFBQUMsQUFDM0Q7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLGVBQUMsQUFBNEYsOEZBQUU7QUFDN0YsdUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBYyxnQkFBRSxBQUFpQixBQUFDLEFBQUMsQUFDcEQ7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLGVBQUMsQUFBNEYsOEZBQUU7QUFDN0YsdUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBYyxnQkFBRSxBQUFxQixBQUFDLEFBQUMsQUFDeEQ7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsaUJBQUMsQUFBc0Msd0NBQUU7QUFDN0MsZ0JBQU0sQUFBTSxTQUFXLEFBQXFCLEFBQUM7QUFFN0MsZ0JBQUksQUFBc0IsQUFBQztBQUUzQixBQUFNLG1CQUFDO0FBQ0gsb0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBa0MsQUFBQyxBQUFDO0FBQ3RGLG9CQUFNLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN4RSxBQUFJLHdCQUVHLGdCQUFzQiwwQkFDekIsQUFBVyxhQUFFLEFBQUksTUFDakIsQUFBb0Isc0JBQUUsQUFBQyxBQUU5QixBQUFDO0FBRUYsQUFBYyxpQ0FBRyxBQUFpQixrQkFBQyxBQUFpQixBQUFFLEFBQUMsQUFDM0Q7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLGVBQUMsQUFBMEUsNEVBQUU7QUFDM0UsdUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBYyxnQkFBRSxBQUFNLEFBQUMsQUFBQyxBQUN6QztBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBUSxpQkFBQyxBQUE2QiwrQkFBRTtBQUNwQyxnQkFBTSxBQUFpQixvQkFBVyxBQUE0QyxBQUFDO0FBQy9FLGdCQUFNLEFBQXFCLHdCQUFXLEFBQTBDLEFBQUM7QUFFakYsZ0JBQUksQUFBc0IsQUFBQztBQUUzQixBQUFNLG1CQUFDO0FBQ0gsb0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBMkIsQUFBQyxBQUFDO0FBQy9FLG9CQUFNLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN4RSxBQUFJLHdCQUVHLGdCQUFzQiwwQkFDekIsQUFBVyxhQUFFLEFBQUksTUFDakIsQUFBbUIscUJBQUUsQUFBUSxVQUM3QixBQUFvQixzQkFBRSxBQUFDLEFBRTlCLEFBQUM7QUFFRixBQUFjLGlDQUFHLEFBQWlCLGtCQUFDLEFBQWlCLEFBQUUsQUFBQyxBQUMzRDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQUUsZUFBQyxBQUErRixpR0FBRTtBQUNoRyx1QkFBTSxPQUFDLEFBQUssTUFBQyxBQUFjLGdCQUFFLEFBQWlCLEFBQUMsQUFBQyxBQUNwRDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQUUsZUFBQyxBQUErRixpR0FBRTtBQUNoRyx1QkFBTSxPQUFDLEFBQUssTUFBQyxBQUFjLGdCQUFFLEFBQXFCLEFBQUMsQUFBQyxBQUN4RDtBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBUSxpQkFBQyxBQUEwQiw0QkFBRTtBQUNqQyxnQkFBTSxBQUFNLFNBQVcsQUFBbUQsQUFBQztBQUUzRSxnQkFBSSxBQUFzQixBQUFDO0FBRTNCLEFBQU0sbUJBQUM7QUFDSCxvQkFBTSxBQUFJLE9BQVcsbUJBQWdCLGlCQUFDLEFBQVMsWUFBRyxBQUEyQixBQUFDLEFBQUM7QUFDL0Usb0JBQU0sQUFBaUIsb0JBQXVCLHVCQUFvQixxQkFBQyxBQUFTLFVBQ3hFLEFBQUksd0JBRUcsZ0JBQXNCLDBCQUN6QixBQUFXLGFBQUUsQUFBSSxNQUNqQixBQUFtQixxQkFBRSxBQUFLLE9BQzFCLEFBQW9CLHNCQUFFLEFBQUMsQUFFOUIsQUFBQztBQUVGLEFBQWMsaUNBQUcsQUFBaUIsa0JBQUMsQUFBaUIsQUFBRSxBQUFDLEFBQzNEO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxlQUFDLEFBQWtGLG9GQUFFO0FBQ25GLHVCQUFNLE9BQUMsQUFBSyxNQUFDLEFBQWMsZ0JBQUUsQUFBTSxBQUFDLEFBQUMsQUFDekM7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsaUJBQUMsQUFBa0Qsb0RBQUU7QUFDekQsZ0JBQU0sQUFBTyxVQUFXLEFBQUksQUFBQztBQUM3QixnQkFBTSxBQUFvQix1QkFBVyxBQUFHLEFBQUM7QUFDekMsZ0JBQU0sQUFBSyxRQUFXLEFBQUcsQUFBQztBQUUxQixnQkFBTSxBQUFPLFVBQVcsQUFBMkMsQUFBQztBQUNwRSxnQkFBTSxBQUFPLFVBQVcsQUFBd0IsQUFBQztBQUVqRCxnQkFBSSxBQUE4QjtnQkFDOUIsQUFBZ0MsQUFBQztBQUVyQyxBQUFNLG1CQUFDO0FBQ0gsb0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBMkIsQUFBQyxBQUFDO0FBQy9FLG9CQUFNLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN4RSxDQUFHLEFBQUksQUFBSSxhQUFDLEFBQU0sT0FBQyxBQUFPLEFBQUMsNEJBRXBCLGdCQUFzQiwwQkFDekIsQUFBVyxhQUFFLEFBQUksTUFDakIsQUFBb0Isc0JBQUUsQUFBb0IsQUFFakQsQUFBQztBQUVGLG9CQUFNLEFBQXdCLDJCQUFXLEFBQWlCLGtCQUNyRCxBQUFpQixBQUFFLG9CQUNuQixBQUFLLE1BQUMsQUFBTyxBQUFFLFNBQ2YsQUFBTSxBQUFDO0FBQ1osb0JBQU0sQUFBMEIsNkJBQVcsQUFBaUIsa0JBQ3ZELEFBQWlCLEFBQUUsb0JBQ25CLEFBQUssTUFBQyxBQUFPLEFBQUUsU0FDZixBQUFNLEFBQUM7QUFFWixBQUFzQix5Q0FBRyxBQUF3QiwyQkFBRyxBQUFPLEFBQUM7QUFDNUQsQUFBd0IsMkNBQUcsQUFBMEIsNkJBQUcsQUFBTyxBQUFDLEFBQ3BFO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxlQUFDLEFBQStHLGlIQUFFO0FBQ2hILHVCQUFNLE9BQUMsQUFBTyxRQUFDLEFBQXNCLHdCQUFFLEFBQW9CLHNCQUFFLEFBQUssQUFBQyxBQUFDLEFBQ3hFO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxlQUFDLEFBQXlILDJIQUFFO0FBQzFILHVCQUFNLE9BQUMsQUFBTyxRQUFDLEFBQXdCLDBCQUFFLEFBQW9CLHNCQUFFLEFBQUssQUFBQyxBQUFDLEFBQzFFO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQVEsYUFBQyxBQUFtRCxxREFBRTtBQUMxRCxZQUFNLEFBQU0sU0FBVyxBQUF5QixBQUFDO0FBRWpELFlBQUksQUFBc0IsQUFBQztBQUUzQixBQUFNLGVBQUM7QUFDSCxnQkFBTSxBQUFJLE9BQVcsbUJBQWdCLGlCQUFDLEFBQVMsWUFBRyxBQUE0QixBQUFDLEFBQUM7QUFDaEYsZ0JBQU0sQUFBaUIsb0JBQXVCLHVCQUFvQixxQkFBQyxBQUFTLFVBQ3hFLEFBQUksd0JBRUcsZ0JBQXNCLDBCQUN6QixBQUFXLGFBQUUsQUFBSSxNQUNqQixBQUFvQixzQkFBRSxBQUFDLEFBRTlCLEFBQUM7QUFFRixBQUFjLDZCQUFHLEFBQWlCLGtCQUFDLEFBQWlCLEFBQUUsQUFBQyxBQUMzRDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQUUsV0FBQyxBQUErQixpQ0FBRTtBQUNoQyxtQkFBTSxPQUFDLEFBQUssTUFBQyxBQUFjLGdCQUFFLEFBQU0sQUFBQyxBQUFDLEFBQ3pDO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFRLGFBQUMsQUFBa0Qsb0RBQUU7QUFDekQsWUFBTSxBQUFNLFNBQVcsQUFBc0IsQUFBQztBQUU5QyxZQUFJLEFBQXNCLEFBQUM7QUFFM0IsQUFBTSxlQUFDO0FBQ0gsZ0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBMkIsQUFBQyxBQUFDO0FBQy9FLGdCQUFNLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN4RSxBQUFJLHdCQUVHLGdCQUFzQiwwQkFDekIsQUFBVyxhQUFFLEFBQUksTUFDakIsQUFBb0Isc0JBQUUsQUFBQyxBQUU5QixBQUFDO0FBRUYsQUFBYyw2QkFBRyxBQUFpQixrQkFBQyxBQUFpQixBQUFFLEFBQUMsQUFDM0Q7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLFdBQUMsQUFBK0IsaUNBQUU7QUFDaEMsbUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBYyxnQkFBRSxBQUFNLEFBQUMsQUFBQyxBQUN6QztBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBUSxhQUFDLEFBQWdCLGtCQUFFO0FBQ3ZCLFlBQU0sQUFBTSxTQUFXLEFBQWtDLEFBQUM7QUFFMUQsWUFBSSxBQUFzQixBQUFDO0FBRTNCLEFBQU0sZUFBQztBQUNILGdCQUFNLEFBQUksT0FBVyxtQkFBZ0IsaUJBQUMsQUFBUyxZQUFHLEFBQTZCLEFBQUMsQUFBQztBQUNqRixnQkFBTSxBQUFpQixvQkFBdUIsdUJBQW9CLHFCQUFDLEFBQVMsVUFDeEUsQUFBSSx3QkFFRyxnQkFBc0IsMEJBQ3pCLEFBQVcsYUFBRSxBQUFJLE1BQ2pCLEFBQW9CLHNCQUFFLEFBQUMsQUFFOUIsQUFBQztBQUVGLEFBQWMsNkJBQUcsQUFBaUIsa0JBQUMsQUFBaUIsQUFBRSxBQUFDLEFBQzNEO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxXQUFDLEFBQTBDLDRDQUFFO0FBQzNDLG1CQUFNLE9BQUMsQUFBSyxNQUFDLEFBQWMsZ0JBQUUsQUFBTSxBQUFDLEFBQUMsQUFDekM7QUFBQyxBQUFDLEFBQUMsQUFDUDtBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSAnY2hhaSc7XG5cbmltcG9ydCB7IElPYmZ1c2NhdGlvblJlc3VsdCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3NyYy9pbnRlcmZhY2VzL0lPYmZ1c2NhdGlvblJlc3VsdCc7XG5cbmltcG9ydCB7IE5PX0NVU1RPTV9OT0RFU19QUkVTRVQgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zcmMvb3B0aW9ucy9wcmVzZXRzL05vQ3VzdG9tTm9kZXMnO1xuXG5pbXBvcnQgeyByZWFkRmlsZUFzU3RyaW5nIH0gZnJvbSAnLi4vLi4vLi4vLi4vaGVscGVycy9yZWFkRmlsZUFzU3RyaW5nJztcblxuaW1wb3J0IHsgSmF2YVNjcmlwdE9iZnVzY2F0b3IgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zcmMvSmF2YVNjcmlwdE9iZnVzY2F0b3InO1xuXG5kZXNjcmliZSgnTGl0ZXJhbFRyYW5zZm9ybWVyJywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCd0cmFuc2Zvcm1hdGlvbiBvZiBsaXRlcmFsIG5vZGUgd2l0aCBzdHJpbmcgdmFsdWUnLCAoKSA9PiB7XG4gICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMxOiBkZWZhdWx0IGJlaGF2aW91cicsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0cmluZ0FycmF5UmVnRXhwOiBSZWdFeHAgPSAvXnZhciAqXzB4KFthLWYwLTldKXs0fSAqPSAqXFxbJ3Rlc3QnXFxdOy87XG4gICAgICAgICAgICBjb25zdCBzdHJpbmdBcnJheUNhbGxSZWdFeHA6IFJlZ0V4cCA9IC92YXIgKnRlc3QgKj0gKl8weChbYS1mMC05XSl7NH1cXCgnMHgwJ1xcKTsvO1xuXG4gICAgICAgICAgICBsZXQgb2JmdXNjYXRlZENvZGU6IHN0cmluZztcblxuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvc2ltcGxlLWlucHV0LmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JmdXNjYXRpb25SZXN1bHQ6IElPYmZ1c2NhdGlvblJlc3VsdCA9IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXlUaHJlc2hvbGQ6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ21hdGNoICMxOiBzaG91bGQgcmVwbGFjZSBsaXRlcmFsIG5vZGUgdmFsdWUgd2l0aCB2YWx1ZSBmcm9tIHN0cmluZyBhcnJheScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIHN0cmluZ0FycmF5UmVnRXhwKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnbWF0Y2ggIzI6IHNob3VsZCByZXBsYWNlIGxpdGVyYWwgbm9kZSB2YWx1ZSB3aXRoIHZhbHVlIGZyb20gc3RyaW5nIGFycmF5JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgc3RyaW5nQXJyYXlDYWxsUmVnRXhwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjMjogYHN0cmluZ0FycmF5YCBvcHRpb24gaXMgZGlzYWJsZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWdFeHA6IFJlZ0V4cCA9IC9edmFyICp0ZXN0ICo9ICondGVzdCc7LztcblxuICAgICAgICAgICAgbGV0IG9iZnVzY2F0ZWRDb2RlOiBzdHJpbmc7XG5cbiAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29kZTogc3RyaW5nID0gcmVhZEZpbGVBc1N0cmluZyhfX2Rpcm5hbWUgKyAnL2ZpeHR1cmVzL3NpbXBsZS1pbnB1dC5qcycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9iZnVzY2F0aW9uUmVzdWx0OiBJT2JmdXNjYXRpb25SZXN1bHQgPSBKYXZhU2NyaXB0T2JmdXNjYXRvci5vYmZ1c2NhdGUoXG4gICAgICAgICAgICAgICAgICAgIGNvZGUsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLk5PX0NVU1RPTV9OT0RFU19QUkVTRVRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZG5cXCd0IHJlcGxhY2UgbGl0ZXJhbCBub2RlIHZhbHVlIHdpdGggdmFsdWUgZnJvbSBzdHJpbmcgYXJyYXknLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCByZWdFeHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMzOiBzdHJpbmcgY29udGFpbnMgbm9uLWxhdGluIGFuZCBub24tZGlnaXQgY2hhcmFjdGVycyBhbmQgYHVuaWNvZGVFc2NhcGVTZXF1ZW5jZWAgaXMgZGlzYWJsZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgdGVzdEZ1bmM6ICgpID0+IHZvaWQ7XG5cbiAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29kZTogc3RyaW5nID0gcmVhZEZpbGVBc1N0cmluZyhfX2Rpcm5hbWUgKyAnL2ZpeHR1cmVzL2Vycm9yLXdoZW4tbm9uLWxhdGluLmpzJyk7XG5cbiAgICAgICAgICAgICAgICB0ZXN0RnVuYyA9ICgpID0+IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXlUaHJlc2hvbGQ6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZFxcJ3QgdGhyb3cgYW4gZXJyb3InLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmRvZXNOb3RUaHJvdyh0ZXN0RnVuYyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzQ6IHNhbWUgbGl0ZXJhbCBub2RlIHZhbHVlcycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0cmluZ0FycmF5UmVnRXhwOiBSZWdFeHAgPSAvXnZhciAqXzB4KFthLWYwLTldKXs0fSAqPSAqXFxbJ3Rlc3QnXFxdOy87XG4gICAgICAgICAgICBjb25zdCBzdHJpbmdBcnJheUNhbGxSZWdFeHA6IFJlZ0V4cCA9IC92YXIgKnRlc3QgKj0gKl8weChbYS1mMC05XSl7NH1cXCgnMHgwJ1xcKTsvO1xuXG4gICAgICAgICAgICBsZXQgb2JmdXNjYXRlZENvZGU6IHN0cmluZztcblxuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvc2FtZS1saXRlcmFsLXZhbHVlcy5qcycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9iZnVzY2F0aW9uUmVzdWx0OiBJT2JmdXNjYXRpb25SZXN1bHQgPSBKYXZhU2NyaXB0T2JmdXNjYXRvci5vYmZ1c2NhdGUoXG4gICAgICAgICAgICAgICAgICAgIGNvZGUsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLk5PX0NVU1RPTV9OT0RFU19QUkVTRVQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5VGhyZXNob2xkOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgb2JmdXNjYXRlZENvZGUgPSBvYmZ1c2NhdGlvblJlc3VsdC5nZXRPYmZ1c2NhdGVkQ29kZSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdtYXRjaCAjMTogc2hvdWxkIGNyZWF0ZSBvbmx5IG9uZSBpdGVtIGluIHN0cmluZyBhcnJheSBmb3Igc2FtZSBsaXRlcmFsIG5vZGUgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgc3RyaW5nQXJyYXlSZWdFeHApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdtYXRjaCAjMjogc2hvdWxkIGNyZWF0ZSBvbmx5IG9uZSBpdGVtIGluIHN0cmluZyBhcnJheSBmb3Igc2FtZSBsaXRlcmFsIG5vZGUgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgc3RyaW5nQXJyYXlDYWxsUmVnRXhwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjNTogYHVuaWNvZGVFc2NhcGVTZXF1ZW5jZWAgb3B0aW9uIGlzIGVuYWJsZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWdFeHA6IFJlZ0V4cCA9IC9edmFyICp0ZXN0ICo9IConXFxcXHg3NFxcXFx4NjVcXFxceDczXFxcXHg3NCc7JC87XG5cbiAgICAgICAgICAgIGxldCBvYmZ1c2NhdGVkQ29kZTogc3RyaW5nO1xuXG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9zaW1wbGUtaW5wdXQuanMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBvYmZ1c2NhdGlvblJlc3VsdDogSU9iZnVzY2F0aW9uUmVzdWx0ID0gSmF2YVNjcmlwdE9iZnVzY2F0b3Iub2JmdXNjYXRlKFxuICAgICAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5OT19DVVNUT01fTk9ERVNfUFJFU0VULFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pY29kZUVzY2FwZVNlcXVlbmNlOiB0cnVlXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZCByZXBsYWNlIGxpdGVyYWwgbm9kZSB2YWx1ZSB3aXRoIHVuaWNvZGUgZXNjYXBlIHNlcXVlbmNlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgcmVnRXhwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjNjogYHVuaWNvZGVFc2NhcGVTZXF1ZW5jZWAgYW5kIGBzdHJpbmdBcnJheWAgb3B0aW9ucyBhcmUgZW5hYmxlZCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0cmluZ0FycmF5UmVnRXhwOiBSZWdFeHAgPSAvXnZhciAqXzB4KFthLWYwLTldKXs0fSAqPSAqXFxbJ1xcXFx4NzRcXFxceDY1XFxcXHg3M1xcXFx4NzQnXFxdOy87XG4gICAgICAgICAgICBjb25zdCBzdHJpbmdBcnJheUNhbGxSZWdFeHA6IFJlZ0V4cCA9IC92YXIgKnRlc3QgKj0gKl8weChbYS1mMC05XSl7NH1cXCgnMHgwJ1xcKTsvO1xuXG4gICAgICAgICAgICBsZXQgb2JmdXNjYXRlZENvZGU6IHN0cmluZztcblxuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvc2ltcGxlLWlucHV0LmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JmdXNjYXRpb25SZXN1bHQ6IElPYmZ1c2NhdGlvblJlc3VsdCA9IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXlUaHJlc2hvbGQ6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bmljb2RlRXNjYXBlU2VxdWVuY2U6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ21hdGNoICMxOiBzaG91bGQgcmVwbGFjZSBsaXRlcmFsIG5vZGUgdmFsdWUgd2l0aCB1bmljb2RlIGVzY2FwZSBzZXF1ZW5jZSBmcm9tIHN0cmluZyBhcnJheScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIHN0cmluZ0FycmF5UmVnRXhwKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnbWF0Y2ggIzE6IHNob3VsZCByZXBsYWNlIGxpdGVyYWwgbm9kZSB2YWx1ZSB3aXRoIHVuaWNvZGUgZXNjYXBlIHNlcXVlbmNlIGZyb20gc3RyaW5nIGFycmF5JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgc3RyaW5nQXJyYXlDYWxsUmVnRXhwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjNzogc2hvcnQgbGl0ZXJhbCBub2RlIHZhbHVlJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVnRXhwOiBSZWdFeHAgPSAvdmFyICp0ZXN0ICo9ICondGUnOy87XG5cbiAgICAgICAgICAgIGxldCBvYmZ1c2NhdGVkQ29kZTogc3RyaW5nO1xuXG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9zaG9ydC1saXRlcmFsLXZhbHVlLmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JmdXNjYXRpb25SZXN1bHQ6IElPYmZ1c2NhdGlvblJlc3VsdCA9IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXlUaHJlc2hvbGQ6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZG5cXCd0IHJlcGxhY2Ugc2hvcnQgbGl0ZXJhbCBub2RlIHZhbHVlIHdpdGggdmFsdWUgZnJvbSBzdHJpbmcgYXJyYXknLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCByZWdFeHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICM4OiBiYXNlNjQgZW5jb2RpbmcnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdHJpbmdBcnJheVJlZ0V4cDogUmVnRXhwID0gL152YXIgKl8weChbYS1mMC05XSl7NH0gKj0gKlxcWydkR1Z6ZEE9PSdcXF07LztcbiAgICAgICAgICAgIGNvbnN0IHN0cmluZ0FycmF5Q2FsbFJlZ0V4cDogUmVnRXhwID0gL3ZhciAqdGVzdCAqPSAqXzB4KFthLWYwLTldKXs0fVxcKCcweDAnXFwpOy87XG5cbiAgICAgICAgICAgIGxldCBvYmZ1c2NhdGVkQ29kZTogc3RyaW5nO1xuXG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9zaW1wbGUtaW5wdXQuanMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBvYmZ1c2NhdGlvblJlc3VsdDogSU9iZnVzY2F0aW9uUmVzdWx0ID0gSmF2YVNjcmlwdE9iZnVzY2F0b3Iub2JmdXNjYXRlKFxuICAgICAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5OT19DVVNUT01fTk9ERVNfUFJFU0VULFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheUVuY29kaW5nOiAnYmFzZTY0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5VGhyZXNob2xkOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgb2JmdXNjYXRlZENvZGUgPSBvYmZ1c2NhdGlvblJlc3VsdC5nZXRPYmZ1c2NhdGVkQ29kZSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdtYXRjaCAjMTogc2hvdWxkIHJlcGxhY2UgbGl0ZXJhbCBub2RlIHZhbHVlIHdpdGggdmFsdWUgZnJvbSBzdHJpbmcgYXJyYXkgZW5jb2RlZCB1c2luZyBiYXNlNjQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBzdHJpbmdBcnJheVJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ21hdGNoICMyOiBzaG91bGQgcmVwbGFjZSBsaXRlcmFsIG5vZGUgdmFsdWUgd2l0aCB2YWx1ZSBmcm9tIHN0cmluZyBhcnJheSBlbmNvZGVkIHVzaW5nIGJhc2U2NCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIHN0cmluZ0FycmF5Q2FsbFJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzk6IHJjNCBlbmNvZGluZycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ0V4cDogUmVnRXhwID0gL3ZhciAqdGVzdCAqPSAqXzB4KFthLWYwLTldKXs0fVxcKCcweDAnLCAqJy57NH0nXFwpOy87XG5cbiAgICAgICAgICAgIGxldCBvYmZ1c2NhdGVkQ29kZTogc3RyaW5nO1xuXG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9zaW1wbGUtaW5wdXQuanMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBvYmZ1c2NhdGlvblJlc3VsdDogSU9iZnVzY2F0aW9uUmVzdWx0ID0gSmF2YVNjcmlwdE9iZnVzY2F0b3Iub2JmdXNjYXRlKFxuICAgICAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5OT19DVVNUT01fTk9ERVNfUFJFU0VULFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheUVuY29kaW5nOiAncmM0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5VGhyZXNob2xkOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgb2JmdXNjYXRlZENvZGUgPSBvYmZ1c2NhdGlvblJlc3VsdC5nZXRPYmZ1c2NhdGVkQ29kZSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQgcmVwbGFjZSBsaXRlcmFsIG5vZGUgdmFsdWUgd2l0aCB2YWx1ZSBmcm9tIHN0cmluZyBhcnJheSBlbmNvZGVkIHVzaW5nIHJjNCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIHJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ3ZhcmlhbnQgIzEwOiBgc3RyaW5nQXJyYXlUaHJlc2hvbGRgIG9wdGlvbiB2YWx1ZScsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNhbXBsZXM6IG51bWJlciA9IDEwMDA7XG4gICAgICAgICAgICBjb25zdCBzdHJpbmdBcnJheVRocmVzaG9sZDogbnVtYmVyID0gMC41O1xuICAgICAgICAgICAgY29uc3QgZGVsdGE6IG51bWJlciA9IDAuMTtcblxuICAgICAgICAgICAgY29uc3QgcmVnRXhwMTogUmVnRXhwID0gL3ZhciAqdGVzdCAqPSAqXzB4KFthLWYwLTldKXs0fVxcKCcweDAnXFwpOy9nO1xuICAgICAgICAgICAgY29uc3QgcmVnRXhwMjogUmVnRXhwID0gL3ZhciAqdGVzdCAqPSAqJ3Rlc3QnOy9nO1xuXG4gICAgICAgICAgICBsZXQgc3RyaW5nQXJyYXlQcm9iYWJpbGl0eTogbnVtYmVyLFxuICAgICAgICAgICAgICAgIG5vU3RyaW5nQXJyYXlQcm9iYWJpbGl0eTogbnVtYmVyO1xuXG4gICAgICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9zaW1wbGUtaW5wdXQuanMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBvYmZ1c2NhdGlvblJlc3VsdDogSU9iZnVzY2F0aW9uUmVzdWx0ID0gSmF2YVNjcmlwdE9iZnVzY2F0b3Iub2JmdXNjYXRlKFxuICAgICAgICAgICAgICAgICAgICBgJHtjb2RlfVxcbmAucmVwZWF0KHNhbXBsZXMpLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5OT19DVVNUT01fTk9ERVNfUFJFU0VULFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheVRocmVzaG9sZDogc3RyaW5nQXJyYXlUaHJlc2hvbGRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBzdHJpbmdBcnJheU1hdGNoZXNMZW5ndGg6IG51bWJlciA9IG9iZnVzY2F0aW9uUmVzdWx0XG4gICAgICAgICAgICAgICAgICAgIC5nZXRPYmZ1c2NhdGVkQ29kZSgpXG4gICAgICAgICAgICAgICAgICAgIC5tYXRjaChyZWdFeHAxKSFcbiAgICAgICAgICAgICAgICAgICAgLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCBub1N0cmluZ0FycmF5TWF0Y2hlc0xlbmd0aDogbnVtYmVyID0gb2JmdXNjYXRpb25SZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgLmdldE9iZnVzY2F0ZWRDb2RlKClcbiAgICAgICAgICAgICAgICAgICAgLm1hdGNoKHJlZ0V4cDIpIVxuICAgICAgICAgICAgICAgICAgICAubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgc3RyaW5nQXJyYXlQcm9iYWJpbGl0eSA9IHN0cmluZ0FycmF5TWF0Y2hlc0xlbmd0aCAvIHNhbXBsZXM7XG4gICAgICAgICAgICAgICAgbm9TdHJpbmdBcnJheVByb2JhYmlsaXR5ID0gbm9TdHJpbmdBcnJheU1hdGNoZXNMZW5ndGggLyBzYW1wbGVzO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCd2YXJpYW50ICMxOiBzaG91bGQgcmVwbGFjZSBsaXRlcmFsIG5vZGUgdmFsdWUgd2l0aCB2YWx1ZSBmcm9tIHN0cmluZyBhcnJheSB3aXRoIGBzdHJpbmdBcnJheVRocmVzaG9sZGAgY2hhbmNlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5jbG9zZVRvKHN0cmluZ0FycmF5UHJvYmFiaWxpdHksIHN0cmluZ0FycmF5VGhyZXNob2xkLCBkZWx0YSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3ZhcmlhbnQgIzI6IHNob3VsZG5cXCd0IHJlcGxhY2UgbGl0ZXJhbCBub2RlIHZhbHVlIHdpdGggdmFsdWUgZnJvbSBzdHJpbmcgYXJyYXkgd2l0aCBgKDEgLSBzdHJpbmdBcnJheVRocmVzaG9sZClgIGNoYW5jZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQuY2xvc2VUbyhub1N0cmluZ0FycmF5UHJvYmFiaWxpdHksIHN0cmluZ0FycmF5VGhyZXNob2xkLCBkZWx0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndHJhbnNmb3JtYXRpb24gb2YgbGl0ZXJhbCBub2RlIHdpdGggYm9vbGVhbiB2YWx1ZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVnRXhwOiBSZWdFeHAgPSAvXnZhciAqdGVzdCAqPSAqISFcXFtcXF07JC87XG5cbiAgICAgICAgbGV0IG9iZnVzY2F0ZWRDb2RlOiBzdHJpbmc7XG5cbiAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9ib29sZWFuLXZhbHVlLmpzJyk7XG4gICAgICAgICAgICBjb25zdCBvYmZ1c2NhdGlvblJlc3VsdDogSU9iZnVzY2F0aW9uUmVzdWx0ID0gSmF2YVNjcmlwdE9iZnVzY2F0b3Iub2JmdXNjYXRlKFxuICAgICAgICAgICAgICAgIGNvZGUsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAuLi5OT19DVVNUT01fTk9ERVNfUFJFU0VULFxuICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXlUaHJlc2hvbGQ6IDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgdHJhbnNmb3JtIGxpdGVyYWwgbm9kZScsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgcmVnRXhwKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndHJhbnNmb3JtYXRpb24gb2YgbGl0ZXJhbCBub2RlIHdpdGggbnVtYmVyIHZhbHVlJywgKCkgPT4ge1xuICAgICAgICBjb25zdCByZWdFeHA6IFJlZ0V4cCA9IC9edmFyICp0ZXN0ICo9ICoweDA7JC87XG5cbiAgICAgICAgbGV0IG9iZnVzY2F0ZWRDb2RlOiBzdHJpbmc7XG5cbiAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9udW1iZXItdmFsdWUuanMnKTtcbiAgICAgICAgICAgIGNvbnN0IG9iZnVzY2F0aW9uUmVzdWx0OiBJT2JmdXNjYXRpb25SZXN1bHQgPSBKYXZhU2NyaXB0T2JmdXNjYXRvci5vYmZ1c2NhdGUoXG4gICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC4uLk5PX0NVU1RPTV9OT0RFU19QUkVTRVQsXG4gICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheVRocmVzaG9sZDogMVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIG9iZnVzY2F0ZWRDb2RlID0gb2JmdXNjYXRpb25SZXN1bHQuZ2V0T2JmdXNjYXRlZENvZGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCB0cmFuc2Zvcm0gbGl0ZXJhbCBub2RlJywgKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCByZWdFeHApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdSZWdFeHAgbGl0ZXJhbCcsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVnRXhwOiBSZWdFeHAgPSAvXnZhciAqcmVnRXhwICo9ICpcXC9cXChcXFxcZFxcK1xcKVxcLzskLztcblxuICAgICAgICBsZXQgb2JmdXNjYXRlZENvZGU6IHN0cmluZztcblxuICAgICAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29kZTogc3RyaW5nID0gcmVhZEZpbGVBc1N0cmluZyhfX2Rpcm5hbWUgKyAnL2ZpeHR1cmVzL3JlZ2V4cC1saXRlcmFsLmpzJyk7XG4gICAgICAgICAgICBjb25zdCBvYmZ1c2NhdGlvblJlc3VsdDogSU9iZnVzY2F0aW9uUmVzdWx0ID0gSmF2YVNjcmlwdE9iZnVzY2F0b3Iub2JmdXNjYXRlKFxuICAgICAgICAgICAgICAgIGNvZGUsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAuLi5OT19DVVNUT01fTk9ERVNfUFJFU0VULFxuICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXlUaHJlc2hvbGQ6IDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQga2VlcCBzYWZlIHZhbHVlIG9mIFJlZ0V4cCBsaXRlcmFsJywgKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCByZWdFeHApO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl19