"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var chai_1 = require("chai");
var NoCustomNodes_1 = require("../../../../../src/options/presets/NoCustomNodes");
var readFileAsString_1 = require("../../../../helpers/readFileAsString");
var JavaScriptObfuscator_1 = require("../../../../../src/JavaScriptObfuscator");
var getRegExpMatch_1 = require("../../../../helpers/getRegExpMatch");
describe('FunctionTransformer', function () {
    describe('identifiers transformation inside `FunctionDeclaration` and `FunctionExpression` node body', function () {
        var functionParamIdentifierRegExp = /var _0x[a-f0-9]{4,6} *= *function *\((_0x[a-f0-9]{4,6})\) *\{/;
        var functionBodyIdentifierRegExp = /console\['log'\]\((_0x[a-f0-9]{4,6})\)/;
        var variableRegExp = /variable *= *0x6;/;
        var obfuscatedCode = void 0,
            functionParamIdentifierName = void 0,
            functionBodyIdentifierName = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/input.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET));
            obfuscatedCode = obfuscationResult.getObfuscatedCode();
            var functionParamIdentifierMatch = obfuscatedCode.match(functionParamIdentifierRegExp);
            var functionBodyIdentifierMatch = obfuscatedCode.match(functionBodyIdentifierRegExp);
            functionParamIdentifierName = functionParamIdentifierMatch[1];
            functionBodyIdentifierName = functionBodyIdentifierMatch[1];
        });
        it('should correctly transform both function parameter identifier and function body identifier with same name', function () {
            chai_1.assert.equal(functionParamIdentifierName, functionBodyIdentifierName);
        });
        it('shouldn\'t transform other variables in function body', function () {
            chai_1.assert.match(obfuscatedCode, variableRegExp);
        });
    });
    describe('object pattern as parameter', function () {
        var functionParameterRegExp = /function *\(\{ *bar *\}\) *\{/;
        var functionBodyRegExp = /return *bar;/;
        var obfuscatedCode = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/object-pattern-as-parameter.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET));
            obfuscatedCode = obfuscationResult.getObfuscatedCode();
        });
        it('match #1: shouldn\'t transform function parameter object pattern identifier', function () {
            chai_1.assert.match(obfuscatedCode, functionParameterRegExp);
        });
        it('match #2: shouldn\'t transform function parameter object pattern identifier', function () {
            chai_1.assert.match(obfuscatedCode, functionBodyRegExp);
        });
    });
    describe('assignment pattern as parameter', function () {
        describe('variant #1: literal as right value', function () {
            var functionParameterRegExp = /function *\(_0x[a-f0-9]{4,6} *= *0x1\) *\{/;
            var functionBodyRegExp = /return *_0x[a-f0-9]{4,6};/;
            var obfuscatedCode = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/assignment-pattern-as-parameter-1.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
            });
            it('match #1: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, functionParameterRegExp);
            });
            it('match #2: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, functionBodyRegExp);
            });
        });
        describe('variant #2: identifier as right value', function () {
            var variableDeclarationRegExp = /var *(_0x[a-f0-9]{4,6}) *= *0x1;/;
            var functionParameterRegExp = /function *\((_0x[a-f0-9]{4,6}) *= *(_0x[a-f0-9]{4,6})\) *\{/;
            var functionBodyRegExp = /return *(_0x[a-f0-9]{4,6});/;
            var obfuscatedCode = void 0,
                variableDeclarationIdentifierName = void 0,
                functionParameterIdentifierName = void 0,
                functionDefaultParameterIdentifierName = void 0,
                functionBodyIdentifierName = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/assignment-pattern-as-parameter-2.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
                variableDeclarationIdentifierName = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, variableDeclarationRegExp);
                functionParameterIdentifierName = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionParameterRegExp);
                functionDefaultParameterIdentifierName = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionParameterRegExp, 1);
                functionBodyIdentifierName = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionBodyRegExp);
            });
            it('match #1: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, variableDeclarationRegExp);
            });
            it('match #2: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, functionParameterRegExp);
            });
            it('match #3: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, functionBodyRegExp);
            });
            it('should keep same names for identifier in variable declaration and default value identifier of function parameter', function () {
                chai_1.assert.equal(variableDeclarationIdentifierName, functionDefaultParameterIdentifierName);
            });
            it('should keep same names for identifiers in function params and function body', function () {
                chai_1.assert.equal(functionParameterIdentifierName, functionBodyIdentifierName);
            });
        });
        describe('variant #3: identifier as right value', function () {
            var variableDeclarationRegExp = /var *(_0x[a-f0-9]{4,6}) *= *0x1;/;
            var functionParameterRegExp = /function *\((_0x[a-f0-9]{4,6}), *(_0x[a-f0-9]{4,6}) *= *(_0x[a-f0-9]{4,6})\) *\{/;
            var functionBodyRegExp = /return *(_0x[a-f0-9]{4,6}) *\+ *(_0x[a-f0-9]{4,6});/;
            var obfuscatedCode = void 0,
                variableDeclarationIdentifierName = void 0,
                functionParameterIdentifierName = void 0,
                functionDefaultParameterIdentifierName1 = void 0,
                functionDefaultParameterIdentifierName2 = void 0,
                functionBodyIdentifierName1 = void 0,
                functionBodyIdentifierName2 = void 0;
            before(function () {
                var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/assignment-pattern-as-parameter-3.js');
                var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET));
                obfuscatedCode = obfuscationResult.getObfuscatedCode();
                variableDeclarationIdentifierName = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, variableDeclarationRegExp);
                functionParameterIdentifierName = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionParameterRegExp);
                functionDefaultParameterIdentifierName1 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionParameterRegExp, 1);
                functionDefaultParameterIdentifierName2 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionParameterRegExp, 2);
                functionBodyIdentifierName1 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionBodyRegExp);
                functionBodyIdentifierName2 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionBodyRegExp, 1);
            });
            it('match #1: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, variableDeclarationRegExp);
            });
            it('match #2: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, functionParameterRegExp);
            });
            it('match #3: should transform function parameter assignment pattern identifier', function () {
                chai_1.assert.match(obfuscatedCode, functionBodyRegExp);
            });
            it('equal #1: shouldn\'t keep same names variable declaration identifier and function parameters identifiers', function () {
                chai_1.assert.notEqual(variableDeclarationIdentifierName, functionParameterIdentifierName);
            });
            it('equal #2: shouldn\'t keep same names variable declaration identifier and function parameters identifiers', function () {
                chai_1.assert.notEqual(variableDeclarationIdentifierName, functionDefaultParameterIdentifierName1);
            });
            it('equal #3: shouldn\'t keep same names variable declaration identifier and function parameters identifiers', function () {
                chai_1.assert.notEqual(variableDeclarationIdentifierName, functionDefaultParameterIdentifierName2);
            });
            it('should keep same names for identifier in first function parameter and default value identifier of second function parameter', function () {
                chai_1.assert.equal(functionParameterIdentifierName, functionDefaultParameterIdentifierName2);
            });
            it('equal #1: should keep same names for identifiers in function params and function body', function () {
                chai_1.assert.equal(functionParameterIdentifierName, functionBodyIdentifierName1);
            });
            it('equal #2: should keep same names for identifiers in function params and function body', function () {
                chai_1.assert.equal(functionDefaultParameterIdentifierName1, functionBodyIdentifierName2);
            });
        });
    });
    describe('array pattern as parameter', function () {
        var functionParameterRegExp = /function *\(\[(_0x[a-f0-9]{4,6}), *(_0x[a-f0-9]{4,6})\]\) *\{/;
        var functionBodyRegExp = /return *(_0x[a-f0-9]{4,6}) *\+ *(_0x[a-f0-9]{4,6});/;
        var arrayPatternIdentifierName1 = void 0,
            arrayPatternIdentifierName2 = void 0,
            functionBodyIdentifierName1 = void 0,
            functionBodyIdentifierName2 = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/array-pattern-as-parameter.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET));
            var obfuscatedCode = obfuscationResult.getObfuscatedCode();
            arrayPatternIdentifierName1 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionParameterRegExp);
            arrayPatternIdentifierName2 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionParameterRegExp, 1);
            functionBodyIdentifierName1 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionBodyRegExp);
            functionBodyIdentifierName2 = getRegExpMatch_1.getRegExpMatch(obfuscatedCode, functionBodyRegExp, 1);
        });
        it('equal #1: should keep same names for identifiers in function parameter array pattern and function body', function () {
            chai_1.assert.equal(arrayPatternIdentifierName1, functionBodyIdentifierName1);
        });
        it('equal #2: should keep same names for identifiers in function parameter array pattern and function body', function () {
            chai_1.assert.equal(arrayPatternIdentifierName2, functionBodyIdentifierName2);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRnVuY3Rpb25UcmFuc2Zvcm1lci5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vdGVzdC9mdW5jdGlvbmFsLXRlc3RzL25vZGUtdHJhbnNmb3JtZXJzL29iZnVzY2F0aW5nLXRyYW5zZm9ybWVycy9mdW5jdGlvbi10cmFuc2Zvcm1lci9GdW5jdGlvblRyYW5zZm9ybWVyLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEscUJBQThCO0FBSTlCLDhCQUEwRjtBQUUxRixpQ0FBd0U7QUFFeEUscUNBQStFO0FBQy9FLCtCQUFvRTtBQUVwRSxBQUFRLFNBQUMsQUFBcUIsdUJBQUU7QUFDNUIsQUFBUSxhQUFDLEFBQTRGLDhGQUFFO0FBQ25HLFlBQU0sQUFBNkIsZ0NBQVcsQUFBK0QsQUFBQztBQUM5RyxZQUFNLEFBQTRCLCtCQUFXLEFBQXdDLEFBQUM7QUFDdEYsWUFBTSxBQUFjLGlCQUFXLEFBQW1CLEFBQUM7QUFFbkQsWUFBSSxBQUFzQjtZQUN0QixBQUFtQztZQUNuQyxBQUFrQyxBQUFDO0FBRXZDLEFBQU0sZUFBQztBQUNILGdCQUFNLEFBQUksT0FBVyxtQkFBZ0IsaUJBQUMsQUFBUyxZQUFHLEFBQW9CLEFBQUMsQUFBQztBQUN4RSxnQkFBTSxBQUFpQixvQkFBdUIsdUJBQW9CLHFCQUFDLEFBQVMsVUFDeEUsQUFBSSx3QkFFRyxnQkFBc0IsQUFFaEMsQUFBQztBQUVGLEFBQWMsNkJBQUcsQUFBaUIsa0JBQUMsQUFBaUIsQUFBRSxBQUFDO0FBRXZELGdCQUFNLEFBQTRCLCtCQUEwQixBQUFjLGVBQ3JFLEFBQUssTUFBQyxBQUE2QixBQUFDLEFBQUM7QUFDMUMsZ0JBQU0sQUFBMkIsOEJBQTBCLEFBQWMsZUFDcEUsQUFBSyxNQUFDLEFBQTRCLEFBQUMsQUFBQztBQUV6QyxBQUEyQiwwQ0FBc0IsQUFBNkIsNkJBQUMsQUFBQyxBQUFDLEFBQUM7QUFDbEYsQUFBMEIseUNBQXNCLEFBQTRCLDRC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QUFJLEFBQW1DO1lBQ25DLEFBQW1DO1lBQ25DLEFBQW1DO1lBQ25DLEFBQW1DLEFBQUM7QUFFeEMsQUFBTSxlQUFDO0FBQ0gsZ0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBeUMsQUFBQyxBQUFDO0FBQzdGLGdCQUFNLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN4RSxBQUFJLHdCQUVHLGdCQUFzQixBQUVoQyxBQUFDO0FBQ0YsZ0JBQU0sQUFBYyxpQkFBVyxBQUFpQixrQkFBQyxBQUFpQixBQUFFLEFBQUM7QUFFckUsQUFBMkIsMENBQUcsaUJBQWMsZUFBQyxBQUFjLGdCQUFFLEFBQXVCLEFBQUMsQUFBQztBQUN0RixBQUEyQiwwQ0FBRyxpQkFBYyxlQUFDLEFBQWMsZ0JBQUUsQUFBdUIseUJBQUUsQUFBQyxBQUFDLEFBQUM7QUFDekYsQUFBMkIsMENBQUcsaUJBQWMsZUFBQyxBQUFjLGdCQUFFLEFBQWtCLEFBQUMsQUFBQztBQUNqRixBQUEyQiwwQ0FBRyxpQkFBYyxlQUFDLEFBQWMsZ0JBQUUsQUFBa0Isb0JBQUUsQUFBQyxBQUFDLEFBQUMsQUFDeEY7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLFdBQUMsQUFBd0csMEdBQUU7QUFDekcsbUJBQU0sT0FBQyxBQUFLLE1BQUMsQUFBMkIsNkJBQUUsQUFBMkIsQUFBQyxBQUFDLEFBQzNFO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBRSxXQUFDLEFBQXdHLDBHQUFFO0FBQ3pHLG1CQUFNLE9BQUMsQUFBSyxNQUFDLEFBQTJCLDZCQUFFLEFBQTJCLEFBQUMsQUFBQyxBQUMzRTtBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhc3NlcnQgfSBmcm9tICdjaGFpJztcblxuaW1wb3J0IHsgSU9iZnVzY2F0aW9uUmVzdWx0IH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vc3JjL2ludGVyZmFjZXMvSU9iZnVzY2F0aW9uUmVzdWx0JztcblxuaW1wb3J0IHsgTk9fQ1VTVE9NX05PREVTX1BSRVNFVCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3NyYy9vcHRpb25zL3ByZXNldHMvTm9DdXN0b21Ob2Rlcyc7XG5cbmltcG9ydCB7IHJlYWRGaWxlQXNTdHJpbmcgfSBmcm9tICcuLi8uLi8uLi8uLi9oZWxwZXJzL3JlYWRGaWxlQXNTdHJpbmcnO1xuXG5pbXBvcnQgeyBKYXZhU2NyaXB0T2JmdXNjYXRvciB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3NyYy9KYXZhU2NyaXB0T2JmdXNjYXRvcic7XG5pbXBvcnQgeyBnZXRSZWdFeHBNYXRjaCB9IGZyb20gJy4uLy4uLy4uLy4uL2hlbHBlcnMvZ2V0UmVnRXhwTWF0Y2gnO1xuXG5kZXNjcmliZSgnRnVuY3Rpb25UcmFuc2Zvcm1lcicsICgpID0+IHtcbiAgICBkZXNjcmliZSgnaWRlbnRpZmllcnMgdHJhbnNmb3JtYXRpb24gaW5zaWRlIGBGdW5jdGlvbkRlY2xhcmF0aW9uYCBhbmQgYEZ1bmN0aW9uRXhwcmVzc2lvbmAgbm9kZSBib2R5JywgKCkgPT4ge1xuICAgICAgICBjb25zdCBmdW5jdGlvblBhcmFtSWRlbnRpZmllclJlZ0V4cDogUmVnRXhwID0gL3ZhciBfMHhbYS1mMC05XXs0LDZ9ICo9ICpmdW5jdGlvbiAqXFwoKF8weFthLWYwLTldezQsNn0pXFwpICpcXHsvO1xuICAgICAgICBjb25zdCBmdW5jdGlvbkJvZHlJZGVudGlmaWVyUmVnRXhwOiBSZWdFeHAgPSAvY29uc29sZVxcWydsb2cnXFxdXFwoKF8weFthLWYwLTldezQsNn0pXFwpLztcbiAgICAgICAgY29uc3QgdmFyaWFibGVSZWdFeHA6IFJlZ0V4cCA9IC92YXJpYWJsZSAqPSAqMHg2Oy87XG5cbiAgICAgICAgbGV0IG9iZnVzY2F0ZWRDb2RlOiBzdHJpbmcsXG4gICAgICAgICAgICBmdW5jdGlvblBhcmFtSWRlbnRpZmllck5hbWU6IHN0cmluZyxcbiAgICAgICAgICAgIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lOiBzdHJpbmc7XG5cbiAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9pbnB1dC5qcycpO1xuICAgICAgICAgICAgY29uc3Qgb2JmdXNjYXRpb25SZXN1bHQ6IElPYmZ1c2NhdGlvblJlc3VsdCA9IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIG9iZnVzY2F0ZWRDb2RlID0gb2JmdXNjYXRpb25SZXN1bHQuZ2V0T2JmdXNjYXRlZENvZGUoKTtcblxuICAgICAgICAgICAgY29uc3QgZnVuY3Rpb25QYXJhbUlkZW50aWZpZXJNYXRjaDogUmVnRXhwTWF0Y2hBcnJheXxudWxsID0gb2JmdXNjYXRlZENvZGVcbiAgICAgICAgICAgICAgICAubWF0Y2goZnVuY3Rpb25QYXJhbUlkZW50aWZpZXJSZWdFeHApO1xuICAgICAgICAgICAgY29uc3QgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck1hdGNoOiBSZWdFeHBNYXRjaEFycmF5fG51bGwgPSBvYmZ1c2NhdGVkQ29kZVxuICAgICAgICAgICAgICAgIC5tYXRjaChmdW5jdGlvbkJvZHlJZGVudGlmaWVyUmVnRXhwKTtcblxuICAgICAgICAgICAgZnVuY3Rpb25QYXJhbUlkZW50aWZpZXJOYW1lID0gKDxSZWdFeHBNYXRjaEFycmF5PmZ1bmN0aW9uUGFyYW1JZGVudGlmaWVyTWF0Y2gpWzFdO1xuICAgICAgICAgICAgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUgPSAoPFJlZ0V4cE1hdGNoQXJyYXk+ZnVuY3Rpb25Cb2R5SWRlbnRpZmllck1hdGNoKVsxXTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBjb3JyZWN0bHkgdHJhbnNmb3JtIGJvdGggZnVuY3Rpb24gcGFyYW1ldGVyIGlkZW50aWZpZXIgYW5kIGZ1bmN0aW9uIGJvZHkgaWRlbnRpZmllciB3aXRoIHNhbWUgbmFtZScsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChmdW5jdGlvblBhcmFtSWRlbnRpZmllck5hbWUsIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZG5cXCd0IHRyYW5zZm9ybSBvdGhlciB2YXJpYWJsZXMgaW4gZnVuY3Rpb24gYm9keScsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgdmFyaWFibGVSZWdFeHApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdvYmplY3QgcGF0dGVybiBhcyBwYXJhbWV0ZXInLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZ1bmN0aW9uUGFyYW1ldGVyUmVnRXhwOiBSZWdFeHAgPSAvZnVuY3Rpb24gKlxcKFxceyAqYmFyICpcXH1cXCkgKlxcey87XG4gICAgICAgIGNvbnN0IGZ1bmN0aW9uQm9keVJlZ0V4cDogUmVnRXhwID0gL3JldHVybiAqYmFyOy87XG5cbiAgICAgICAgbGV0IG9iZnVzY2F0ZWRDb2RlOiBzdHJpbmc7XG5cbiAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9vYmplY3QtcGF0dGVybi1hcy1wYXJhbWV0ZXIuanMnKTtcbiAgICAgICAgICAgIGNvbnN0IG9iZnVzY2F0aW9uUmVzdWx0OiBJT2JmdXNjYXRpb25SZXN1bHQgPSBKYXZhU2NyaXB0T2JmdXNjYXRvci5vYmZ1c2NhdGUoXG4gICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC4uLk5PX0NVU1RPTV9OT0RFU19QUkVTRVRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdtYXRjaCAjMTogc2hvdWxkblxcJ3QgdHJhbnNmb3JtIGZ1bmN0aW9uIHBhcmFtZXRlciBvYmplY3QgcGF0dGVybiBpZGVudGlmaWVyJywgKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvblBhcmFtZXRlclJlZ0V4cCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdtYXRjaCAjMjogc2hvdWxkblxcJ3QgdHJhbnNmb3JtIGZ1bmN0aW9uIHBhcmFtZXRlciBvYmplY3QgcGF0dGVybiBpZGVudGlmaWVyJywgKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvbkJvZHlSZWdFeHApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdhc3NpZ25tZW50IHBhdHRlcm4gYXMgcGFyYW1ldGVyJywgKCkgPT4ge1xuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjMTogbGl0ZXJhbCBhcyByaWdodCB2YWx1ZScsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uUGFyYW1ldGVyUmVnRXhwOiBSZWdFeHAgPSAvZnVuY3Rpb24gKlxcKF8weFthLWYwLTldezQsNn0gKj0gKjB4MVxcKSAqXFx7LztcbiAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uQm9keVJlZ0V4cDogUmVnRXhwID0gL3JldHVybiAqXzB4W2EtZjAtOV17NCw2fTsvO1xuXG4gICAgICAgICAgICBsZXQgb2JmdXNjYXRlZENvZGU6IHN0cmluZztcblxuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvYXNzaWdubWVudC1wYXR0ZXJuLWFzLXBhcmFtZXRlci0xLmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JmdXNjYXRpb25SZXN1bHQ6IElPYmZ1c2NhdGlvblJlc3VsdCA9IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIG9iZnVzY2F0ZWRDb2RlID0gb2JmdXNjYXRpb25SZXN1bHQuZ2V0T2JmdXNjYXRlZENvZGUoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnbWF0Y2ggIzE6IHNob3VsZCB0cmFuc2Zvcm0gZnVuY3Rpb24gcGFyYW1ldGVyIGFzc2lnbm1lbnQgcGF0dGVybiBpZGVudGlmaWVyJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5tYXRjaChvYmZ1c2NhdGVkQ29kZSwgZnVuY3Rpb25QYXJhbWV0ZXJSZWdFeHApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdtYXRjaCAjMjogc2hvdWxkIHRyYW5zZm9ybSBmdW5jdGlvbiBwYXJhbWV0ZXIgYXNzaWdubWVudCBwYXR0ZXJuIGlkZW50aWZpZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvbkJvZHlSZWdFeHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKCd2YXJpYW50ICMyOiBpZGVudGlmaWVyIGFzIHJpZ2h0IHZhbHVlJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFyaWFibGVEZWNsYXJhdGlvblJlZ0V4cDogUmVnRXhwID0gL3ZhciAqKF8weFthLWYwLTldezQsNn0pICo9ICoweDE7LztcbiAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uUGFyYW1ldGVyUmVnRXhwOiBSZWdFeHAgPSAvZnVuY3Rpb24gKlxcKChfMHhbYS1mMC05XXs0LDZ9KSAqPSAqKF8weFthLWYwLTldezQsNn0pXFwpICpcXHsvO1xuICAgICAgICAgICAgY29uc3QgZnVuY3Rpb25Cb2R5UmVnRXhwOiBSZWdFeHAgPSAvcmV0dXJuICooXzB4W2EtZjAtOV17NCw2fSk7LztcblxuICAgICAgICAgICAgbGV0IG9iZnVzY2F0ZWRDb2RlOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgdmFyaWFibGVEZWNsYXJhdGlvbklkZW50aWZpZXJOYW1lOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25QYXJhbWV0ZXJJZGVudGlmaWVyTmFtZTogc3RyaW5nLFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uRGVmYXVsdFBhcmFtZXRlcklkZW50aWZpZXJOYW1lOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWU6IHN0cmluZztcblxuICAgICAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvYXNzaWdubWVudC1wYXR0ZXJuLWFzLXBhcmFtZXRlci0yLmpzJyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JmdXNjYXRpb25SZXN1bHQ6IElPYmZ1c2NhdGlvblJlc3VsdCA9IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIG9iZnVzY2F0ZWRDb2RlID0gb2JmdXNjYXRpb25SZXN1bHQuZ2V0T2JmdXNjYXRlZENvZGUoKTtcbiAgICAgICAgICAgICAgICB2YXJpYWJsZURlY2xhcmF0aW9uSWRlbnRpZmllck5hbWUgPSBnZXRSZWdFeHBNYXRjaChvYmZ1c2NhdGVkQ29kZSwgdmFyaWFibGVEZWNsYXJhdGlvblJlZ0V4cCk7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb25QYXJhbWV0ZXJJZGVudGlmaWVyTmFtZSA9IGdldFJlZ0V4cE1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvblBhcmFtZXRlclJlZ0V4cCk7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb25EZWZhdWx0UGFyYW1ldGVySWRlbnRpZmllck5hbWUgPSBnZXRSZWdFeHBNYXRjaChvYmZ1c2NhdGVkQ29kZSwgZnVuY3Rpb25QYXJhbWV0ZXJSZWdFeHAsIDEpO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lID0gZ2V0UmVnRXhwTWF0Y2gob2JmdXNjYXRlZENvZGUsIGZ1bmN0aW9uQm9keVJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ21hdGNoICMxOiBzaG91bGQgdHJhbnNmb3JtIGZ1bmN0aW9uIHBhcmFtZXRlciBhc3NpZ25tZW50IHBhdHRlcm4gaWRlbnRpZmllcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIHZhcmlhYmxlRGVjbGFyYXRpb25SZWdFeHApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdtYXRjaCAjMjogc2hvdWxkIHRyYW5zZm9ybSBmdW5jdGlvbiBwYXJhbWV0ZXIgYXNzaWdubWVudCBwYXR0ZXJuIGlkZW50aWZpZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvblBhcmFtZXRlclJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ21hdGNoICMzOiBzaG91bGQgdHJhbnNmb3JtIGZ1bmN0aW9uIHBhcmFtZXRlciBhc3NpZ25tZW50IHBhdHRlcm4gaWRlbnRpZmllcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIGZ1bmN0aW9uQm9keVJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ3Nob3VsZCBrZWVwIHNhbWUgbmFtZXMgZm9yIGlkZW50aWZpZXIgaW4gdmFyaWFibGUgZGVjbGFyYXRpb24gYW5kIGRlZmF1bHQgdmFsdWUgaWRlbnRpZmllciBvZiBmdW5jdGlvbiBwYXJhbWV0ZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKHZhcmlhYmxlRGVjbGFyYXRpb25JZGVudGlmaWVyTmFtZSwgZnVuY3Rpb25EZWZhdWx0UGFyYW1ldGVySWRlbnRpZmllck5hbWUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQga2VlcCBzYW1lIG5hbWVzIGZvciBpZGVudGlmaWVycyBpbiBmdW5jdGlvbiBwYXJhbXMgYW5kIGZ1bmN0aW9uIGJvZHknLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGZ1bmN0aW9uUGFyYW1ldGVySWRlbnRpZmllck5hbWUsIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZXNjcmliZSgndmFyaWFudCAjMzogaWRlbnRpZmllciBhcyByaWdodCB2YWx1ZScsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhcmlhYmxlRGVjbGFyYXRpb25SZWdFeHA6IFJlZ0V4cCA9IC92YXIgKihfMHhbYS1mMC05XXs0LDZ9KSAqPSAqMHgxOy87XG4gICAgICAgICAgICBjb25zdCBmdW5jdGlvblBhcmFtZXRlclJlZ0V4cDogUmVnRXhwID0gL2Z1bmN0aW9uICpcXCgoXzB4W2EtZjAtOV17NCw2fSksICooXzB4W2EtZjAtOV17NCw2fSkgKj0gKihfMHhbYS1mMC05XXs0LDZ9KVxcKSAqXFx7LztcbiAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uQm9keVJlZ0V4cDogUmVnRXhwID0gL3JldHVybiAqKF8weFthLWYwLTldezQsNn0pICpcXCsgKihfMHhbYS1mMC05XXs0LDZ9KTsvO1xuXG4gICAgICAgICAgICBsZXQgb2JmdXNjYXRlZENvZGU6IHN0cmluZyxcbiAgICAgICAgICAgICAgICB2YXJpYWJsZURlY2xhcmF0aW9uSWRlbnRpZmllck5hbWU6IHN0cmluZyxcbiAgICAgICAgICAgICAgICBmdW5jdGlvblBhcmFtZXRlcklkZW50aWZpZXJOYW1lOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25EZWZhdWx0UGFyYW1ldGVySWRlbnRpZmllck5hbWUxOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25EZWZhdWx0UGFyYW1ldGVySWRlbnRpZmllck5hbWUyOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUxOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUyOiBzdHJpbmc7XG5cbiAgICAgICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29kZTogc3RyaW5nID0gcmVhZEZpbGVBc1N0cmluZyhfX2Rpcm5hbWUgKyAnL2ZpeHR1cmVzL2Fzc2lnbm1lbnQtcGF0dGVybi1hcy1wYXJhbWV0ZXItMy5qcycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9iZnVzY2F0aW9uUmVzdWx0OiBJT2JmdXNjYXRpb25SZXN1bHQgPSBKYXZhU2NyaXB0T2JmdXNjYXRvci5vYmZ1c2NhdGUoXG4gICAgICAgICAgICAgICAgICAgIGNvZGUsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLk5PX0NVU1RPTV9OT0RFU19QUkVTRVRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBvYmZ1c2NhdGVkQ29kZSA9IG9iZnVzY2F0aW9uUmVzdWx0LmdldE9iZnVzY2F0ZWRDb2RlKCk7XG5cbiAgICAgICAgICAgICAgICB2YXJpYWJsZURlY2xhcmF0aW9uSWRlbnRpZmllck5hbWUgPSBnZXRSZWdFeHBNYXRjaChvYmZ1c2NhdGVkQ29kZSwgdmFyaWFibGVEZWNsYXJhdGlvblJlZ0V4cCk7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb25QYXJhbWV0ZXJJZGVudGlmaWVyTmFtZSA9IGdldFJlZ0V4cE1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvblBhcmFtZXRlclJlZ0V4cCk7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb25EZWZhdWx0UGFyYW1ldGVySWRlbnRpZmllck5hbWUxID0gZ2V0UmVnRXhwTWF0Y2gob2JmdXNjYXRlZENvZGUsIGZ1bmN0aW9uUGFyYW1ldGVyUmVnRXhwLCAxKTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbkRlZmF1bHRQYXJhbWV0ZXJJZGVudGlmaWVyTmFtZTIgPSBnZXRSZWdFeHBNYXRjaChvYmZ1c2NhdGVkQ29kZSwgZnVuY3Rpb25QYXJhbWV0ZXJSZWdFeHAsIDIpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUxID0gZ2V0UmVnRXhwTWF0Y2gob2JmdXNjYXRlZENvZGUsIGZ1bmN0aW9uQm9keVJlZ0V4cCk7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUyID0gZ2V0UmVnRXhwTWF0Y2gob2JmdXNjYXRlZENvZGUsIGZ1bmN0aW9uQm9keVJlZ0V4cCwgMSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ21hdGNoICMxOiBzaG91bGQgdHJhbnNmb3JtIGZ1bmN0aW9uIHBhcmFtZXRlciBhc3NpZ25tZW50IHBhdHRlcm4gaWRlbnRpZmllcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIHZhcmlhYmxlRGVjbGFyYXRpb25SZWdFeHApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdtYXRjaCAjMjogc2hvdWxkIHRyYW5zZm9ybSBmdW5jdGlvbiBwYXJhbWV0ZXIgYXNzaWdubWVudCBwYXR0ZXJuIGlkZW50aWZpZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvblBhcmFtZXRlclJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ21hdGNoICMzOiBzaG91bGQgdHJhbnNmb3JtIGZ1bmN0aW9uIHBhcmFtZXRlciBhc3NpZ25tZW50IHBhdHRlcm4gaWRlbnRpZmllcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubWF0Y2gob2JmdXNjYXRlZENvZGUsIGZ1bmN0aW9uQm9keVJlZ0V4cCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ2VxdWFsICMxOiBzaG91bGRuXFwndCBrZWVwIHNhbWUgbmFtZXMgdmFyaWFibGUgZGVjbGFyYXRpb24gaWRlbnRpZmllciBhbmQgZnVuY3Rpb24gcGFyYW1ldGVycyBpZGVudGlmaWVycycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubm90RXF1YWwodmFyaWFibGVEZWNsYXJhdGlvbklkZW50aWZpZXJOYW1lLCBmdW5jdGlvblBhcmFtZXRlcklkZW50aWZpZXJOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdCgnZXF1YWwgIzI6IHNob3VsZG5cXCd0IGtlZXAgc2FtZSBuYW1lcyB2YXJpYWJsZSBkZWNsYXJhdGlvbiBpZGVudGlmaWVyIGFuZCBmdW5jdGlvbiBwYXJhbWV0ZXJzIGlkZW50aWZpZXJzJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzc2VydC5ub3RFcXVhbCh2YXJpYWJsZURlY2xhcmF0aW9uSWRlbnRpZmllck5hbWUsIGZ1bmN0aW9uRGVmYXVsdFBhcmFtZXRlcklkZW50aWZpZXJOYW1lMSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ2VxdWFsICMzOiBzaG91bGRuXFwndCBrZWVwIHNhbWUgbmFtZXMgdmFyaWFibGUgZGVjbGFyYXRpb24gaWRlbnRpZmllciBhbmQgZnVuY3Rpb24gcGFyYW1ldGVycyBpZGVudGlmaWVycycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3NlcnQubm90RXF1YWwodmFyaWFibGVEZWNsYXJhdGlvbklkZW50aWZpZXJOYW1lLCBmdW5jdGlvbkRlZmF1bHRQYXJhbWV0ZXJJZGVudGlmaWVyTmFtZTIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KCdzaG91bGQga2VlcCBzYW1lIG5hbWVzIGZvciBpZGVudGlmaWVyIGluIGZpcnN0IGZ1bmN0aW9uIHBhcmFtZXRlciBhbmQgZGVmYXVsdCB2YWx1ZSBpZGVudGlmaWVyIG9mIHNlY29uZCBmdW5jdGlvbiBwYXJhbWV0ZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGZ1bmN0aW9uUGFyYW1ldGVySWRlbnRpZmllck5hbWUsIGZ1bmN0aW9uRGVmYXVsdFBhcmFtZXRlcklkZW50aWZpZXJOYW1lMik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ2VxdWFsICMxOiBzaG91bGQga2VlcCBzYW1lIG5hbWVzIGZvciBpZGVudGlmaWVycyBpbiBmdW5jdGlvbiBwYXJhbXMgYW5kIGZ1bmN0aW9uIGJvZHknLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGZ1bmN0aW9uUGFyYW1ldGVySWRlbnRpZmllck5hbWUsIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lMSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaXQoJ2VxdWFsICMyOiBzaG91bGQga2VlcCBzYW1lIG5hbWVzIGZvciBpZGVudGlmaWVycyBpbiBmdW5jdGlvbiBwYXJhbXMgYW5kIGZ1bmN0aW9uIGJvZHknLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGZ1bmN0aW9uRGVmYXVsdFBhcmFtZXRlcklkZW50aWZpZXJOYW1lMSwgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdhcnJheSBwYXR0ZXJuIGFzIHBhcmFtZXRlcicsICgpID0+IHtcbiAgICAgICAgY29uc3QgZnVuY3Rpb25QYXJhbWV0ZXJSZWdFeHA6IFJlZ0V4cCA9IC9mdW5jdGlvbiAqXFwoXFxbKF8weFthLWYwLTldezQsNn0pLCAqKF8weFthLWYwLTldezQsNn0pXFxdXFwpICpcXHsvO1xuICAgICAgICBjb25zdCBmdW5jdGlvbkJvZHlSZWdFeHA6IFJlZ0V4cCA9IC9yZXR1cm4gKihfMHhbYS1mMC05XXs0LDZ9KSAqXFwrICooXzB4W2EtZjAtOV17NCw2fSk7LztcblxuICAgICAgICBsZXQgYXJyYXlQYXR0ZXJuSWRlbnRpZmllck5hbWUxOiBzdHJpbmcsXG4gICAgICAgICAgICBhcnJheVBhdHRlcm5JZGVudGlmaWVyTmFtZTI6IHN0cmluZyxcbiAgICAgICAgICAgIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lMTogc3RyaW5nLFxuICAgICAgICAgICAgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUyOiBzdHJpbmc7XG5cbiAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9hcnJheS1wYXR0ZXJuLWFzLXBhcmFtZXRlci5qcycpO1xuICAgICAgICAgICAgY29uc3Qgb2JmdXNjYXRpb25SZXN1bHQ6IElPYmZ1c2NhdGlvblJlc3VsdCA9IEphdmFTY3JpcHRPYmZ1c2NhdG9yLm9iZnVzY2F0ZShcbiAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLi4uTk9fQ1VTVE9NX05PREVTX1BSRVNFVFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBvYmZ1c2NhdGVkQ29kZTogc3RyaW5nID0gb2JmdXNjYXRpb25SZXN1bHQuZ2V0T2JmdXNjYXRlZENvZGUoKTtcblxuICAgICAgICAgICAgYXJyYXlQYXR0ZXJuSWRlbnRpZmllck5hbWUxID0gZ2V0UmVnRXhwTWF0Y2gob2JmdXNjYXRlZENvZGUsIGZ1bmN0aW9uUGFyYW1ldGVyUmVnRXhwKTtcbiAgICAgICAgICAgIGFycmF5UGF0dGVybklkZW50aWZpZXJOYW1lMiA9IGdldFJlZ0V4cE1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvblBhcmFtZXRlclJlZ0V4cCwgMSk7XG4gICAgICAgICAgICBmdW5jdGlvbkJvZHlJZGVudGlmaWVyTmFtZTEgPSBnZXRSZWdFeHBNYXRjaChvYmZ1c2NhdGVkQ29kZSwgZnVuY3Rpb25Cb2R5UmVnRXhwKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lMiA9IGdldFJlZ0V4cE1hdGNoKG9iZnVzY2F0ZWRDb2RlLCBmdW5jdGlvbkJvZHlSZWdFeHAsIDEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnZXF1YWwgIzE6IHNob3VsZCBrZWVwIHNhbWUgbmFtZXMgZm9yIGlkZW50aWZpZXJzIGluIGZ1bmN0aW9uIHBhcmFtZXRlciBhcnJheSBwYXR0ZXJuIGFuZCBmdW5jdGlvbiBib2R5JywgKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGFycmF5UGF0dGVybklkZW50aWZpZXJOYW1lMSwgZnVuY3Rpb25Cb2R5SWRlbnRpZmllck5hbWUxKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ2VxdWFsICMyOiBzaG91bGQga2VlcCBzYW1lIG5hbWVzIGZvciBpZGVudGlmaWVycyBpbiBmdW5jdGlvbiBwYXJhbWV0ZXIgYXJyYXkgcGF0dGVybiBhbmQgZnVuY3Rpb24gYm9keScsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChhcnJheVBhdHRlcm5JZGVudGlmaWVyTmFtZTIsIGZ1bmN0aW9uQm9keUlkZW50aWZpZXJOYW1lMik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4iXX0=