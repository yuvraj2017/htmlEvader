"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var chai_1 = require("chai");
var NoCustomNodes_1 = require("../../../../src/options/presets/NoCustomNodes");
var readFileAsString_1 = require("../../../helpers/readFileAsString");
var JavaScriptObfuscator_1 = require("../../../../src/JavaScriptObfuscator");
describe('StringArrayRotateFunctionNode', function () {
    var regExp = /while *\(-- *_0x([a-f0-9]){4,6}\) *\{/;
    describe('`stringArray` option is set', function () {
        var obfuscatedCode = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { rotateStringArray: true, stringArray: true, stringArrayThreshold: 1 }));
            obfuscatedCode = obfuscationResult.getObfuscatedCode();
        });
        it('should correctly append custom node into the obfuscated code', function () {
            chai_1.assert.match(obfuscatedCode, regExp);
        });
    });
    describe('`stringArray` option isn\'t set', function () {
        var obfuscatedCode = void 0;
        before(function () {
            var code = readFileAsString_1.readFileAsString(__dirname + '/fixtures/simple-input.js');
            var obfuscationResult = JavaScriptObfuscator_1.JavaScriptObfuscator.obfuscate(code, Object.assign({}, NoCustomNodes_1.NO_CUSTOM_NODES_PRESET, { rotateStringArray: false, stringArray: true, stringArrayThreshold: 1 }));
            obfuscatedCode = obfuscationResult.getObfuscatedCode();
        });
        it('shouldn\'t append custom node into the obfuscated code', function () {
            chai_1.assert.notMatch(obfuscatedCode, regExp);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RyaW5nQXJyYXlSb3RhdGVGdW5jdGlvbk5vZGUuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Rlc3QvZnVuY3Rpb25hbC10ZXN0cy9jdXN0b20tbm9kZXMvc3RyaW5nLWFycmF5LW5vZGVzL1N0cmluZ0FycmF5Um90YXRlRnVuY3Rpb25Ob2RlLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEscUJBQThCO0FBSTlCLDhCQUF1RjtBQUV2RixpQ0FBcUU7QUFFckUscUNBQTRFO0FBRTVFLEFBQVEsU0FBQyxBQUErQixpQ0FBRTtBQUN0QyxRQUFNLEFBQU0sU0FBVyxBQUF1QyxBQUFDO0FBRS9ELEFBQVEsYUFBQyxBQUE2QiwrQkFBRTtBQUNwQyxZQUFJLEFBQXNCLEFBQUM7QUFFM0IsQUFBTSxlQUFDO0FBQ0gsZ0JBQU0sQUFBSSxPQUFXLG1CQUFnQixpQkFBQyxBQUFTLFlBQUcsQUFBMkIsQUFBQyxBQUFDO0FBRS9FLGdCQUFJLEFBQWlCLG9CQUF1Qix1QkFBb0IscUJBQUMsQUFBUyxVQUN0RSxBQUFJLHdCQUVHLGdCQUFzQiwwQkFDekIsQUFBaUIsbUJBQUUsQUFBSSxNQUN2QixBQUFXLGFBQUUsQUFBSSxNQUNqQixBQUFvQixzQkFBRSxBQUFDLEFBRTlCLEFBQUM7QUFFRixBQUFjLDZCQUFHLEFBQWlCLGtCQUFDLEFBQWlCLEFBQUUsQUFBQyxBQUMzRDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQUUsV0FBQyxBQUE4RCxnRUFBRTtBQUMvRCxtQkFBTSxPQUFDLEFBQUssTUFBQyxBQUFjLGdCQUFFLEFBQU0sQUFBQyxBQUFDLEFBQ3pDO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFRLGFBQUMsQUFBaUMsbUNBQUU7QUFDeEMsWUFBSSxBQUFzQixBQUFDO0FBRTNCLEFBQU0sZUFBQztBQUNILGdCQUFNLEFBQUksT0FBVyxtQkFBZ0IsaUJBQUMsQUFBUyxZQUFHLEFBQTJCLEFBQUMsQUFBQztBQUUvRSxnQkFBSSxBQUFpQixvQkFBdUIsdUJBQW9CLHFCQUFDLEFBQVMsVUFDdEUsQUFBSSx3QkFFRyxnQkFBc0IsMEJBQ3pCLEFBQWlCLG1CQUFFLEFBQUssT0FDeEIsQUFBVyxhQUFFLEFBQUksTUFDakIsQUFBb0Isc0JBQUUsQUFBQyxBQUU5QixBQUFDO0FBRUYsQUFBYyw2QkFBRyxBQUFpQixrQkFBQyxBQUFpQixBQUFFLEFBQUMsQUFDM0Q7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFFLFdBQUMsQUFBd0QsMERBQUU7QUFDekQsbUJBQU0sT0FBQyxBQUFRLFNBQUMsQUFBYyxnQkFBRSxBQUFNLEFBQUMsQUFBQyxBQUM1QztBQUFDLEFBQUMsQUFBQyxBQUNQO0FBQUMsQUFBQyxBQUFDLEFBQ1A7QUFBQyxBQUFDLEFBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhc3NlcnQgfSBmcm9tICdjaGFpJztcblxuaW1wb3J0IHsgSU9iZnVzY2F0aW9uUmVzdWx0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL2ludGVyZmFjZXMvSU9iZnVzY2F0aW9uUmVzdWx0JztcblxuaW1wb3J0IHsgTk9fQ1VTVE9NX05PREVTX1BSRVNFVCB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9vcHRpb25zL3ByZXNldHMvTm9DdXN0b21Ob2Rlcyc7XG5cbmltcG9ydCB7IHJlYWRGaWxlQXNTdHJpbmcgfSBmcm9tICcuLi8uLi8uLi9oZWxwZXJzL3JlYWRGaWxlQXNTdHJpbmcnO1xuXG5pbXBvcnQgeyBKYXZhU2NyaXB0T2JmdXNjYXRvciB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9KYXZhU2NyaXB0T2JmdXNjYXRvcic7XG5cbmRlc2NyaWJlKCdTdHJpbmdBcnJheVJvdGF0ZUZ1bmN0aW9uTm9kZScsICgpID0+IHtcbiAgICBjb25zdCByZWdFeHA6IFJlZ0V4cCA9IC93aGlsZSAqXFwoLS0gKl8weChbYS1mMC05XSl7NCw2fVxcKSAqXFx7LztcblxuICAgIGRlc2NyaWJlKCdgc3RyaW5nQXJyYXlgIG9wdGlvbiBpcyBzZXQnLCAoKSA9PiB7XG4gICAgICAgIGxldCBvYmZ1c2NhdGVkQ29kZTogc3RyaW5nO1xuXG4gICAgICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb2RlOiBzdHJpbmcgPSByZWFkRmlsZUFzU3RyaW5nKF9fZGlybmFtZSArICcvZml4dHVyZXMvc2ltcGxlLWlucHV0LmpzJyk7XG5cbiAgICAgICAgICAgIGxldCBvYmZ1c2NhdGlvblJlc3VsdDogSU9iZnVzY2F0aW9uUmVzdWx0ID0gSmF2YVNjcmlwdE9iZnVzY2F0b3Iub2JmdXNjYXRlKFxuICAgICAgICAgICAgICAgIGNvZGUsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAuLi5OT19DVVNUT01fTk9ERVNfUFJFU0VULFxuICAgICAgICAgICAgICAgICAgICByb3RhdGVTdHJpbmdBcnJheTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5VGhyZXNob2xkOiAxXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgb2JmdXNjYXRlZENvZGUgPSBvYmZ1c2NhdGlvblJlc3VsdC5nZXRPYmZ1c2NhdGVkQ29kZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGNvcnJlY3RseSBhcHBlbmQgY3VzdG9tIG5vZGUgaW50byB0aGUgb2JmdXNjYXRlZCBjb2RlJywgKCkgPT4ge1xuICAgICAgICAgICAgYXNzZXJ0Lm1hdGNoKG9iZnVzY2F0ZWRDb2RlLCByZWdFeHApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdgc3RyaW5nQXJyYXlgIG9wdGlvbiBpc25cXCd0IHNldCcsICgpID0+IHtcbiAgICAgICAgbGV0IG9iZnVzY2F0ZWRDb2RlOiBzdHJpbmc7XG5cbiAgICAgICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvZGU6IHN0cmluZyA9IHJlYWRGaWxlQXNTdHJpbmcoX19kaXJuYW1lICsgJy9maXh0dXJlcy9zaW1wbGUtaW5wdXQuanMnKTtcblxuICAgICAgICAgICAgbGV0IG9iZnVzY2F0aW9uUmVzdWx0OiBJT2JmdXNjYXRpb25SZXN1bHQgPSBKYXZhU2NyaXB0T2JmdXNjYXRvci5vYmZ1c2NhdGUoXG4gICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC4uLk5PX0NVU1RPTV9OT0RFU19QUkVTRVQsXG4gICAgICAgICAgICAgICAgICAgIHJvdGF0ZVN0cmluZ0FycmF5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5VGhyZXNob2xkOiAxXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgb2JmdXNjYXRlZENvZGUgPSBvYmZ1c2NhdGlvblJlc3VsdC5nZXRPYmZ1c2NhdGVkQ29kZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkblxcJ3QgYXBwZW5kIGN1c3RvbSBub2RlIGludG8gdGhlIG9iZnVzY2F0ZWQgY29kZScsICgpID0+IHtcbiAgICAgICAgICAgIGFzc2VydC5ub3RNYXRjaChvYmZ1c2NhdGVkQ29kZSwgcmVnRXhwKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbiJdfQ==